{
  "leoHeader": {
    "fileFormat": 2
  },
  "vnodes": [
    {
      "gnx": "felix.20251102225128.1",
      "vh": "@clean README.md"
    },
    {
      "gnx": "felix.20251103000914.1",
      "vh": "@clean package.json"
    },
    {
      "gnx": "felix.20251103000934.1",
      "vh": "@clean src/index.html"
    },
    {
      "gnx": "felix.20251103001111.1",
      "vh": "@clean src/style.css"
    },
    {
      "gnx": "felix.20251210234420.1",
      "vh": "@clean src/constants.ts",
      "children": [
        {
          "gnx": "felix.20251210234420.2",
          "vh": "class Constants",
          "children": [
            {
              "gnx": "felix.20251210234420.3",
              "vh": "general constants"
            },
            {
              "gnx": "felix.20251210234420.4",
              "vh": "suported languages"
            },
            {
              "gnx": "felix.20251210234420.6",
              "vh": "user messages"
            },
            {
              "gnx": "felix.20251210234420.13",
              "vh": "context flags"
            },
            {
              "gnx": "felix.20251210234420.14",
              "vh": "vscode commands"
            },
            {
              "gnx": "felix.20251210234420.15",
              "vh": "body language code strings"
            },
            {
              "gnx": "felix.20251210234420.16",
              "vh": "commands strings"
            },
            {
              "gnx": "felix.20251210234420.17",
              "vh": "leo commands"
            },
            {
              "gnx": "felix.20251210234420.18",
              "vh": "keep-selection old position offsets"
            },
            {
              "gnx": "felix.20251210234420.19",
              "vh": "minibuffer overridden names"
            }
          ]
        }
      ]
    },
    {
      "gnx": "felix.20251210234451.1",
      "vh": "@clean src/declarations.d.ts"
    },
    {
      "gnx": "felix.20251211000427.1",
      "vh": "@clean src/utils.ts",
      "children": [
        {
          "gnx": "felix.20251211212644.1",
          "vh": "throttle"
        },
        {
          "gnx": "felix.20251211212701.1",
          "vh": "safeLocalStorageGet"
        },
        {
          "gnx": "felix.20251211212717.1",
          "vh": "safeLocalStorageSet"
        },
        {
          "gnx": "felix.20251211212732.1",
          "vh": "preventDefault"
        },
        {
          "gnx": "felix.20251211212753.1",
          "vh": "getTextNodeAtIndex"
        },
        {
          "gnx": "felix.20251211212824.1",
          "vh": "getGlobalOffset"
        },
        {
          "gnx": "felix.20251211212832.1",
          "vh": "readDirectory"
        },
        {
          "gnx": "felix.20251211000427.2",
          "vh": "performanceNow"
        },
        {
          "gnx": "felix.20251211000427.5",
          "vh": "uniqueId"
        },
        {
          "gnx": "felix.20251211000427.6",
          "vh": "getUniqueId"
        },
        {
          "gnx": "felix.20251211000427.7",
          "vh": "getOnce"
        },
        {
          "gnx": "felix.20251211000427.8",
          "vh": "padNumber2"
        },
        {
          "gnx": "felix.20251211000427.16",
          "vh": "convertLeoFiletypes"
        },
        {
          "gnx": "felix.20251211000427.17",
          "vh": "getDurationMilliseconds"
        },
        {
          "gnx": "felix.20251211000427.18",
          "vh": "getDurationSeconds"
        },
        {
          "gnx": "felix.20251211000427.19",
          "vh": "getFileFromPath"
        },
        {
          "gnx": "felix.20251211000427.20",
          "vh": "isAlphaNumeric"
        },
        {
          "gnx": "felix.20251211000427.21",
          "vh": "isIconChangedByEdit"
        },
        {
          "gnx": "felix.20251211000427.22",
          "vh": "isHexColor"
        }
      ]
    },
    {
      "gnx": "felix.20251211000618.1",
      "vh": "@clean src/types.ts",
      "children": [
        {
          "gnx": "felix.20251211213133.1",
          "vh": "TreeNode"
        },
        {
          "gnx": "felix.20251211213147.1",
          "vh": "NodeData"
        },
        {
          "gnx": "felix.20251211213151.1",
          "vh": "FlatRow"
        },
        {
          "gnx": "felix.20251211213155.1",
          "vh": "MenuEntry"
        },
        {
          "gnx": "felix.20251211213200.1",
          "vh": "FileStat"
        },
        {
          "gnx": "felix.20251211213205.1",
          "vh": "FilePath"
        },
        {
          "gnx": "felix.20251211213209.1",
          "vh": "OpenDialogOptions"
        },
        {
          "gnx": "felix.20251211213213.1",
          "vh": "SaveDialogOptions"
        },
        {
          "gnx": "felix.20251211213217.1",
          "vh": "InputDialogOptions"
        },
        {
          "gnx": "felix.20251211000618.2",
          "vh": "ConfigMembers"
        },
        {
          "gnx": "felix.20251211000618.3",
          "vh": "ConfigSetting"
        },
        {
          "gnx": "felix.20251211000618.4",
          "vh": "Focus"
        },
        {
          "gnx": "felix.20251211000618.5",
          "vh": "RevealType"
        },
        {
          "gnx": "felix.20251211000618.6",
          "vh": "ReqRefresh"
        },
        {
          "gnx": "felix.20251211000618.7",
          "vh": "CommandOptions"
        },
        {
          "gnx": "felix.20251211000618.8",
          "vh": "BodyTimeInfo"
        },
        {
          "gnx": "felix.20251211000618.9",
          "vh": "LeoPackageStates"
        },
        {
          "gnx": "felix.20251211000618.10",
          "vh": "LeoDocument"
        },
        {
          "gnx": "felix.20251211000618.11",
          "vh": "LeoButton"
        },
        {
          "gnx": "felix.20251211000618.12",
          "vh": "TGotoTypes"
        },
        {
          "gnx": "felix.20251211000618.13",
          "vh": "LeoGoto"
        },
        {
          "gnx": "felix.20251211000618.14",
          "vh": "LeoGotoNavKey"
        },
        {
          "gnx": "felix.20251211000618.15",
          "vh": "LeoSearchScope"
        },
        {
          "gnx": "felix.20251211000618.16",
          "vh": "LeoSearchSettings"
        },
        {
          "gnx": "felix.20251211000618.17",
          "vh": "LeoGuiFindTabManagerSettings"
        },
        {
          "gnx": "felix.20251211000618.19",
          "vh": "BodyTimeInfo"
        },
        {
          "gnx": "felix.20251211000618.20",
          "vh": "BodyPosition"
        },
        {
          "gnx": "felix.20251211000618.21",
          "vh": "BodySelectionInfo"
        },
        {
          "gnx": "felix.20251211000618.22",
          "vh": "showSaveAsDialogParameters"
        },
        {
          "gnx": "felix.20251211000618.23",
          "vh": "runAskYesNoDialogParameters"
        },
        {
          "gnx": "felix.20251211000618.24",
          "vh": "runWarnMessageDialogParameters"
        },
        {
          "gnx": "felix.20251211000618.25",
          "vh": "runInfoMessageDialogParameters"
        },
        {
          "gnx": "felix.20251211000618.26",
          "vh": "AskMessageItem"
        },
        {
          "gnx": "felix.20251211000618.27",
          "vh": "ChooseDocumentItem"
        },
        {
          "gnx": "felix.20251211000618.28",
          "vh": "ChooseRClickItem"
        },
        {
          "gnx": "felix.20251211000618.29",
          "vh": "MinibufferCommand"
        },
        {
          "gnx": "felix.20251211000618.30",
          "vh": "UnlType"
        }
      ]
    },
    {
      "gnx": "felix.20251207200255.1",
      "vh": "Leo",
      "children": [
        {
          "gnx": "ekr.20140902032918.18591",
          "vh": " About this file",
          "children": [
            {
              "gnx": "ekr.20140831085423.18639",
              "vh": "About widgets and wrappers"
            },
            {
              "gnx": "ekr.20140831085423.18630",
              "vh": "Terminology"
            },
            {
              "gnx": "ekr.20140831085423.18631",
              "vh": "Official ivars"
            }
          ]
        },
        {
          "gnx": "felix.20251207200355.1",
          "vh": "Core classes",
          "children": [
            {
              "gnx": "felix.20251207215313.1",
              "vh": "@file src/core/leoGlobals.ts"
            }
          ]
        },
        {
          "gnx": "felix.20251213133753.1",
          "vh": "Gui base classes",
          "children": [
            {
              "gnx": "felix.20251213133753.2",
              "vh": "@@file src/core/findTabManager.ts",
              "children": [
                {
                  "gnx": "felix.20251213133753.3",
                  "vh": "<< imports >>"
                },
                {
                  "gnx": "felix.20251213133753.4",
                  "vh": "<< types >>"
                },
                {
                  "gnx": "felix.20251213133753.5",
                  "vh": "class StringCheckBox (leoGui.py)"
                },
                {
                  "gnx": "felix.20251213133753.6",
                  "vh": "class StringRadioButton (leoGui.py)"
                },
                {
                  "gnx": "felix.20251213133753.7",
                  "vh": "class StringLineEdit (leoGui)"
                },
                {
                  "gnx": "felix.20251213133753.8",
                  "vh": "class StringFindTabManager",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.9",
                      "vh": " sftm.ctor"
                    },
                    {
                      "gnx": "felix.20251213133753.10",
                      "vh": "sftm.clear_focus & init_focus & set_entry_focus"
                    },
                    {
                      "gnx": "felix.20251213133753.11",
                      "vh": "sftm.get_settings"
                    },
                    {
                      "gnx": "felix.20251213133753.12",
                      "vh": "sftm.init_widgets"
                    },
                    {
                      "gnx": "felix.20251213133753.13",
                      "vh": "ftm.set_widgets_from_dict"
                    },
                    {
                      "gnx": "felix.20251213133753.14",
                      "vh": "sftm.set_body_and_headline_checkbox"
                    },
                    {
                      "gnx": "felix.20251213133753.15",
                      "vh": "sftm.set_radio_button"
                    },
                    {
                      "gnx": "felix.20251213133753.16",
                      "vh": "sftm.text getters/setters"
                    },
                    {
                      "gnx": "felix.20251213133753.17",
                      "vh": "sftm.toggle_checkbox"
                    }
                  ]
                }
              ]
            },
            {
              "gnx": "felix.20251213133753.18",
              "vh": "@@file src/core/leoFind.ts",
              "children": [
                {
                  "gnx": "felix.20251213133753.19",
                  "vh": "<< leoFind imports >>"
                },
                {
                  "gnx": "felix.20251213133753.20",
                  "vh": "<< Theory of operation of find/change >>"
                },
                {
                  "gnx": "felix.20251213133753.21",
                  "vh": "class LeoFind",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.22",
                      "vh": "LeoFind.birth",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.23",
                          "vh": " find.__init__"
                        },
                        {
                          "gnx": "felix.20251213133753.24",
                          "vh": "find.default_settings"
                        },
                        {
                          "gnx": "felix.20251213133753.25",
                          "vh": "find.finishCreate"
                        },
                        {
                          "gnx": "felix.20251213133753.26",
                          "vh": "find.init_ivars_from_settings"
                        },
                        {
                          "gnx": "felix.20251213133753.27",
                          "vh": "find.reload_settings"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.28",
                      "vh": "find.batch_change (script helper) & helpers",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.29",
                          "vh": "<< docstring: find.batch_change >>"
                        },
                        {
                          "gnx": "felix.20251213133753.30",
                          "vh": "find._batch_change_helper"
                        },
                        {
                          "gnx": "felix.20251213133753.31",
                          "vh": "find._init_from_dict"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.32",
                      "vh": "LeoFind.Commands (immediate execution)",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.33",
                          "vh": "show-all-tags"
                        },
                        {
                          "gnx": "felix.20251213133753.34",
                          "vh": "find.change-then-find & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.35",
                              "vh": "find.do_change_then_find"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.36",
                          "vh": "find.clone-find_marked & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.37",
                              "vh": "find.do_find_marked"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.38",
                          "vh": "find.clone-find-parents"
                        },
                        {
                          "gnx": "felix.20251213133753.39",
                          "vh": "find.find-def/var & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.40",
                              "vh": "find.do_find_def & helpers",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.41",
                                  "vh": "find._load_quicksearch_entries"
                                },
                                {
                                  "gnx": "felix.20251213133753.42",
                                  "vh": "find._compute_find_def_word"
                                },
                                {
                                  "gnx": "felix.20251213133753.43",
                                  "vh": "find._find_all_matches"
                                },
                                {
                                  "gnx": "felix.20251213133753.44",
                                  "vh": "find._make_clones"
                                },
                                {
                                  "gnx": "felix.20251213133753.45",
                                  "vh": "find._make_patterns"
                                },
                                {
                                  "gnx": "felix.20251213133753.46",
                                  "vh": "find._switch_style"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.47",
                          "vh": "find.find-next, find-prev & do_find_*",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.48",
                              "vh": "find.do_find_next & do_find_prev"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.49",
                          "vh": "find.replace"
                        },
                        {
                          "gnx": "felix.20251213133753.50",
                          "vh": "find.set-find-*"
                        },
                        {
                          "gnx": "felix.20251213133753.51",
                          "vh": "find.show-find-options",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.52",
                              "vh": "LeoFind.compute_find_options"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.53",
                          "vh": "find.toggle-find-*"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.54",
                      "vh": "LeoFind.Commands (interactive)",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.55",
                          "vh": "find.change-all & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.56",
                              "vh": "find.do_change_all & helpers",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.57",
                                  "vh": "find._change_all_helper"
                                },
                                {
                                  "gnx": "felix.20251213133753.58",
                                  "vh": "find._change_all_search_and_replace & helpers",
                                  "children": [
                                    {
                                      "gnx": "felix.20251213133753.59",
                                      "vh": "find._change_all_plain"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.60",
                                      "vh": "find._change_all_regex"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.61",
                                      "vh": "find._change_all_word"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.62",
                          "vh": "find.clone-find-all & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.63",
                              "vh": "find.do_clone_find_all"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.64",
                          "vh": "find.clone-find-all-flattened & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.65",
                              "vh": "find.do_clone_find_all_flattened"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.66",
                          "vh": "find.clone-find-tag & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.67",
                              "vh": "find.do_clone_find_tag & helper",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.68",
                                  "vh": "find._create_clone_tag_nodes"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.69",
                          "vh": "find.find-all & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.70",
                              "vh": "find.do_find_all & helpers",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.71",
                                  "vh": "find._find_all_helper & helpers",
                                  "children": [
                                    {
                                      "gnx": "felix.20251213133753.72",
                                      "vh": "find.create_find_all_node"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.73",
                                      "vh": "find.index_to_line_info"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.74",
                                      "vh": "find.make_result_from_matches"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.75",
                                      "vh": "find.put_link"
                                    },
                                    {
                                      "gnx": "felix.20251213133753.76",
                                      "vh": "find.find_all_matches_in_string & helpers",
                                      "children": [
                                        {
                                          "gnx": "felix.20251213133753.77",
                                          "vh": "find.find_all_plain"
                                        },
                                        {
                                          "gnx": "felix.20251213133753.78",
                                          "vh": "find.find_all_regex"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.79",
                          "vh": "find.re-search"
                        },
                        {
                          "gnx": "felix.20251213133753.80",
                          "vh": "find.re-search-backward"
                        },
                        {
                          "gnx": "felix.20251213133753.81",
                          "vh": "find.search_backward"
                        },
                        {
                          "gnx": "felix.20251213133753.82",
                          "vh": "find.start-search (Ctrl-F) & common states",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.83",
                              "vh": "find.start_search1"
                            },
                            {
                              "gnx": "felix.20251213133753.84",
                              "vh": "find._start_search_escape1"
                            },
                            {
                              "gnx": "felix.20251213133753.85",
                              "vh": "find._start_search_escape2"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.86",
                          "vh": "find.summarize"
                        },
                        {
                          "gnx": "felix.20251213133753.87",
                          "vh": "find.tag-node"
                        },
                        {
                          "gnx": "felix.20251213133753.88",
                          "vh": "find.remove-tag"
                        },
                        {
                          "gnx": "felix.20251213133753.89",
                          "vh": "find.remove-all-tags"
                        },
                        {
                          "gnx": "felix.20251213133753.90",
                          "vh": "find.tag-children & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.91",
                              "vh": "find.do_tag_children"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.92",
                          "vh": "find.word-search"
                        },
                        {
                          "gnx": "felix.20251213133753.93",
                          "vh": "find.word-search-backward"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.94",
                      "vh": "LeoFind.Commands: helpers",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.95",
                          "vh": "find._cf_helper & helpers",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.96",
                              "vh": "find._cfa_create_nodes"
                            },
                            {
                              "gnx": "felix.20251213133753.97",
                              "vh": "find._cfa_find_next_match (for unit tests)"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.98",
                          "vh": "find.change_selection"
                        },
                        {
                          "gnx": "felix.20251213133753.99",
                          "vh": "find.check_args"
                        },
                        {
                          "gnx": "felix.20251213133753.100",
                          "vh": "find.compile_pattern"
                        },
                        {
                          "gnx": "felix.20251213133753.101",
                          "vh": "find.find_next_match & helpers",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.102",
                              "vh": "find._fnm_next_after_fail & helper",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.103",
                                  "vh": "find._fail_outside_range"
                                }
                              ]
                            },
                            {
                              "gnx": "felix.20251213133753.104",
                              "vh": "find._fnm_first_search_pane"
                            },
                            {
                              "gnx": "felix.20251213133753.105",
                              "vh": "find._fnm_search"
                            },
                            {
                              "gnx": "felix.20251213133753.106",
                              "vh": "find._fnm_should_stay_in_node"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.107",
                          "vh": "find.inner_search_helper & helpers",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.108",
                              "vh": "find._rfind"
                            },
                            {
                              "gnx": "felix.20251213133753.109",
                              "vh": "find._inner_search_backward"
                            },
                            {
                              "gnx": "felix.20251213133753.110",
                              "vh": "find._inner_search_match_word"
                            },
                            {
                              "gnx": "felix.20251213133753.111",
                              "vh": "find._inner_search_plain"
                            },
                            {
                              "gnx": "felix.20251213133753.112",
                              "vh": "find._inner_search_regex"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.113",
                          "vh": "find.make_regex_subs"
                        },
                        {
                          "gnx": "felix.20251213133753.114",
                          "vh": "find.replace_back_slashes"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.115",
                      "vh": "LeoFind.Initing & finalizing",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.116",
                          "vh": "find.init_in_headline & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.117",
                              "vh": "find.focus_in_tree"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.118",
                          "vh": "find.restore"
                        },
                        {
                          "gnx": "felix.20251213133753.119",
                          "vh": "find.save"
                        },
                        {
                          "gnx": "felix.20251213133753.120",
                          "vh": "find.show_success"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.121",
                      "vh": "LeoFind.Utils",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.122",
                          "vh": "find.add_change_string_to_label"
                        },
                        {
                          "gnx": "felix.20251213133753.123",
                          "vh": "find.add_find_string_to_label"
                        },
                        {
                          "gnx": "felix.20251213133753.124",
                          "vh": "find.compute_result_status"
                        },
                        {
                          "gnx": "felix.20251213133753.125",
                          "vh": "find.help_for_find_commands"
                        },
                        {
                          "gnx": "felix.20251213133753.126",
                          "vh": "find.init_vim_search"
                        },
                        {
                          "gnx": "felix.20251213133753.127",
                          "vh": "find.preload_find_pattern"
                        },
                        {
                          "gnx": "felix.20251213133753.128",
                          "vh": "find.show_status"
                        },
                        {
                          "gnx": "felix.20251213133753.129",
                          "vh": "find.show_find_options_in_status_area & helper",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.130",
                              "vh": "find.compute_find_options_in_status_area"
                            }
                          ]
                        },
                        {
                          "gnx": "felix.20251213133753.131",
                          "vh": "find.start_state_machine"
                        },
                        {
                          "gnx": "felix.20251213133753.132",
                          "vh": "find.updateChange/FindList"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "gnx": "felix.20251213133753.133",
              "vh": "@@file src/core/leoFrame.ts",
              "children": [
                {
                  "gnx": "felix.20251213133753.134",
                  "vh": "<< imports >>"
                },
                {
                  "gnx": "felix.20251213133753.135",
                  "vh": "class LeoFrame",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.136",
                      "vh": "frame.ctor"
                    },
                    {
                      "gnx": "felix.20251213133753.137",
                      "vh": "createFirstTreeNode"
                    },
                    {
                      "gnx": "felix.20251213133753.138",
                      "vh": "destroySelf"
                    },
                    {
                      "gnx": "felix.20251213133753.139",
                      "vh": "finishCreate"
                    },
                    {
                      "gnx": "felix.20251213133753.140",
                      "vh": "LeoFrame.getTitle & setTitle"
                    },
                    {
                      "gnx": "felix.20251213133753.141",
                      "vh": "LeoFrame.get_window_info"
                    },
                    {
                      "gnx": "felix.20251213133753.142",
                      "vh": "LeoFrame.setTabWidth"
                    },
                    {
                      "gnx": "felix.20251213133753.143",
                      "vh": "LeoFrame.setTopGeometry"
                    },
                    {
                      "gnx": "felix.20251213133753.144",
                      "vh": "LeoFrame.resizePanesToRatio"
                    },
                    {
                      "gnx": "felix.20251213133753.145",
                      "vh": "LeoFrame.promptForSave"
                    },
                    {
                      "gnx": "felix.20251213133753.146",
                      "vh": "LeoFrame.frame.scanForTabWidth"
                    },
                    {
                      "gnx": "felix.20251213133753.147",
                      "vh": "putStatusLine"
                    },
                    {
                      "gnx": "felix.20251213133753.148",
                      "vh": "QtStatusLineClass.computeStatusUnl"
                    },
                    {
                      "gnx": "felix.20251213133753.149",
                      "vh": "QtStatsuLineClass.toggleUnlView"
                    }
                  ]
                },
                {
                  "gnx": "felix.20251213133753.150",
                  "vh": "class NullBody (LeoBody)",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.151",
                      "vh": " NullBody.__init__"
                    },
                    {
                      "gnx": "felix.20251213133753.152",
                      "vh": "NullBody: LeoBody interface"
                    },
                    {
                      "gnx": "felix.20251213133753.153",
                      "vh": "LeoBody.utils",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.154",
                          "vh": "LeoBody.computeLabel"
                        },
                        {
                          "gnx": "felix.20251213133753.155",
                          "vh": "LeoBody.createChapterIvar"
                        },
                        {
                          "gnx": "felix.20251213133753.156",
                          "vh": "LeoBody.ensurePositionExists"
                        },
                        {
                          "gnx": "felix.20251213133753.157",
                          "vh": "LeoBody.switchToChapter"
                        },
                        {
                          "gnx": "felix.20251213133753.158",
                          "vh": "LeoBody.updateInjectedIvars"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.159",
                      "vh": "LeoBody.Text",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.160",
                          "vh": "LeoBody.getInsertLines"
                        },
                        {
                          "gnx": "felix.20251213133753.161",
                          "vh": "LeoBody.getSelectionAreas"
                        },
                        {
                          "gnx": "felix.20251213133753.162",
                          "vh": "LeoBody.getSelectionLines"
                        }
                      ]
                    }
                  ]
                },
                {
                  "gnx": "felix.20251213133753.163",
                  "vh": "class nullButtonWidget"
                },
                {
                  "gnx": "felix.20251213133753.164",
                  "vh": "class NullIconBarClass",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.165",
                      "vh": " NullIconBarClass.ctor"
                    },
                    {
                      "gnx": "felix.20251213133753.166",
                      "vh": " NullIconBarClass.Do nothing"
                    },
                    {
                      "gnx": "felix.20251213133753.167",
                      "vh": "NullIconBarClass.add"
                    },
                    {
                      "gnx": "felix.20251213133753.168",
                      "vh": "NullIconBarClass.clear"
                    },
                    {
                      "gnx": "felix.20251213133753.169",
                      "vh": "NullIconBarClass.setCommandForButton"
                    }
                  ]
                },
                {
                  "gnx": "felix.20251213133753.170",
                  "vh": "class NullTree (LeoTree)",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.171",
                      "vh": " NullTree.__init__"
                    },
                    {
                      "gnx": "felix.20251213133753.172",
                      "vh": "LeoTree.endEditLabel"
                    },
                    {
                      "gnx": "felix.20251213133753.173",
                      "vh": "LeoTree.onHeadChanged",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.174",
                          "vh": "<< truncate s if it has multiple lines >>"
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.175",
                      "vh": "LeoTree.select & helpers",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.176",
                          "vh": "LeoTree.selectHelper & helpers",
                          "children": [
                            {
                              "gnx": "felix.20251213133753.177",
                              "vh": "1. LeoTree.unselect_helper"
                            },
                            {
                              "gnx": "felix.20251213133753.178",
                              "vh": "2. LeoTree.select_new_node & helper",
                              "children": [
                                {
                                  "gnx": "felix.20251213133753.179",
                                  "vh": "LeoTree.set_body_text_after_select"
                                }
                              ]
                            },
                            {
                              "gnx": "felix.20251213133753.180",
                              "vh": "3. LeoTree.change_current_position"
                            },
                            {
                              "gnx": "felix.20251213133753.181",
                              "vh": "4. LeoTree.scroll_cursor"
                            },
                            {
                              "gnx": "felix.20251213133753.182",
                              "vh": "5. LeoTree.set_status_line"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "gnx": "felix.20251213133753.183",
                      "vh": "NullTree.edit_widget"
                    },
                    {
                      "gnx": "felix.20251213133753.184",
                      "vh": "NullTree.editLabel"
                    },
                    {
                      "gnx": "felix.20251213133753.185",
                      "vh": "NullTree.printWidgets"
                    },
                    {
                      "gnx": "felix.20251213133753.186",
                      "vh": "NullTree.Drawing & scrolling"
                    },
                    {
                      "gnx": "felix.20251213133753.187",
                      "vh": "NullTree.setHeadline"
                    }
                  ]
                },
                {
                  "gnx": "felix.20251213133753.188",
                  "vh": "class StringTextWrapper",
                  "children": [
                    {
                      "gnx": "felix.20251213133753.189",
                      "vh": "stw.ctor"
                    },
                    {
                      "gnx": "felix.20251213133753.190",
                      "vh": "stw.Clipboard"
                    },
                    {
                      "gnx": "felix.20251213133753.191",
                      "vh": "stw.Do-nothings"
                    },
                    {
                      "gnx": "felix.20251213133753.192",
                      "vh": "stw.Text",
                      "children": [
                        {
                          "gnx": "felix.20251213133753.193",
                          "vh": "stw.appendText"
                        },
                        {
                          "gnx": "felix.20251213133753.194",
                          "vh": "stw.delete"
                        },
                        {
                          "gnx": "felix.20251213133753.195",
                          "vh": "stw.deleteTextSelection"
                        },
                        {
                          "gnx": "felix.20251213133753.196",
                          "vh": "stw.get"
                        },
                        {
                          "gnx": "felix.20251213133753.197",
                          "vh": "stw.getAllText"
                        },
                        {
                          "gnx": "felix.20251213133753.198",
                          "vh": "stw.getInsertPoint"
                        },
                        {
                          "gnx": "felix.20251213133753.199",
                          "vh": "stw.getLastIndex"
                        },
                        {
                          "gnx": "felix.20251213133753.200",
                          "vh": "stw.getSelectedText"
                        },
                        {
                          "gnx": "felix.20251213133753.201",
                          "vh": "stw.getSelectionRange"
                        },
                        {
                          "gnx": "felix.20251213133753.202",
                          "vh": "stw.hasSelection"
                        },
                        {
                          "gnx": "felix.20251213133753.203",
                          "vh": "stw.insert"
                        },
                        {
                          "gnx": "felix.20251213133753.204",
                          "vh": "stw.selectAllText"
                        },
                        {
                          "gnx": "felix.20251213133753.205",
                          "vh": "stw.setAllText"
                        },
                        {
                          "gnx": "felix.20251213133753.206",
                          "vh": "stw.setInsertPoint"
                        },
                        {
                          "gnx": "felix.20251213133753.207",
                          "vh": "stw.setSelectionRange"
                        },
                        {
                          "gnx": "felix.20251213133753.208",
                          "vh": "stw.toPythonIndexRowCol"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "gnx": "felix.20251213133753.209",
              "vh": "@file src/core/leoGui.ts"
            }
          ]
        }
      ]
    }
  ],
  "tnodes": {
    "felix.20251102225128.1": "# Leo Web Editor\n\nA web-based version of the Leo Editor - a structured document editor that allows you to organize your content in a hierarchical outline format.\n\n## About\n\nThis project is a TypeScript single-page application that brings the Leo Editor experience to the web. Leo Editor is known for its unique approach to organizing documents through an outline-based structure, making it perfect for complex documentation, note-taking, and content organization.\n\n## Contributing\n\n### Prerequisites\n\n- Node.js (version 14 or higher)\n- npm or yarn\n\n### Build\n\n1. Clone the repository\n2. Install dependencies:\n   ```bash\n   npm install\n   ```\n\n### Development\n\nStart the development server:\n\n```bash\nnpm run dev\n```\n\nor\n\n```bash\nnpm start\n```\n\nThis will start the webpack dev server and automatically open the application in your browser at `http://localhost:8080`.\n\n### Building for Production\n\nBuild the application for production:\n\n```bash\nnpm run build\n```\n\nThe built files will be in the `dist/` directory.\n\n### Other Scripts\n\n- `npm run type-check` - Run TypeScript type checking without building\n- `npm run clean` - Clean the dist directory\n\n## Technologies Used\n\n- **TypeScript** - Type-safe JavaScript\n- **Webpack** - Module bundling and development server\n- **HTML5 & CSS3** - Modern web standards\n- **idb** - A small wrapper that makes IndexedDB usable.\n\n## Contributing\n\nThis is the beginning of the Leo Web Editor project. Contributions, suggestions, and feedback are welcome!\n\n## License\n\nMIT License\n",
    "felix.20251103000914.1": "{\n  \"name\": \"leo-web\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Leo Editor - Web-based version of the Leo Editor, a structured document editor\",\n  \"main\": \"dist/bundle.js\",\n  \"scripts\": {\n    \"build\": \"webpack --mode=production\",\n    \"dev\": \"webpack serve --mode=development\",\n    \"start\": \"webpack serve --mode=development --open\",\n    \"clean\": \"rm -rf dist\",\n    \"type-check\": \"tsc --noEmit\"\n  },\n  \"keywords\": [\n    \"leo\",\n    \"editor\",\n    \"typescript\",\n    \"web\",\n    \"spa\"\n  ],\n  \"author\": \"Leo Editor Developer\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"@types/debounce\": \"^1.2.0\",\n    \"@types/difflib\": \"^0.2.1\",\n    \"@types/elementtree\": \"^0.1.1\",\n    \"@types/glob\": \"^7.2.0\",\n    \"@types/lodash\": \"^4.14.177\",\n    \"@types/md5\": \"^2.3.1\",\n    \"@types/node\": \"^24.7.0\",\n    \"@types/pako\": \"^2.0.0\",\n    \"@types/safe-json-stringify\": \"^1.1.2\",\n    \"@types/showdown\": \"^2.0.6\",\n    \"@types/uuid\": \"^9.0.7\",\n    \"@types/wicg-file-system-access\": \"^2023.10.7\",\n    \"copy-webpack-plugin\": \"^12.0.2\",\n    \"css-loader\": \"^7.1.2\",\n    \"html-webpack-plugin\": \"^5.6.4\",\n    \"style-loader\": \"^4.0.0\",\n    \"ts-loader\": \"^9.5.4\",\n    \"webpack\": \"^5.102.1\",\n    \"webpack-cli\": \"^6.0.1\",\n    \"webpack-dev-server\": \"^5.2.2\"\n  },\n  \"dependencies\": {\n    \"binascii\": \"^0.0.2\",\n    \"bowser\": \"^2.11.0\",\n    \"browser-process-hrtime\": \"^1.0.0\",\n    \"buffer\": \"^6.0.3\",\n    \"crypto-browserify\": \"^3.12.0\",\n    \"csvtojson\": \"^2.0.10\",\n    \"date-format-lite\": \"^17.7.0\",\n    \"dayjs\": \"^1.11.3\",\n    \"dayjs-plugin-utc\": \"^0.1.2\",\n    \"difflib\": \"^0.2.4\",\n    \"elementtree\": \"^0.1.7\",\n    \"idb\": \"^8.0.3\",\n    \"ksuid\": \"^3.0.0\",\n    \"lodash\": \"^4.17.21\",\n    \"md5\": \"^2.3.0\",\n    \"os-browserify\": \"^0.3.0\",\n    \"pako\": \"^2.1.0\",\n    \"path-browserify\": \"^1.0.1\",\n    \"process\": \"^0.11.10\",\n    \"showdown\": \"^2.1.0\",\n    \"typescript\": \"^5.9.3\"\n  }\n}\n",
    "felix.20251103000934.1": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Leo Web Editor</title>\n    <link rel=\"manifest\" href=\"/manifest.webmanifest\">\n    <link rel=\"icon\" href=\"/favicon.ico\" sizes=\"32x32\">\n    <link rel=\"icon\" href=\"/icon.svg\" type=\"image/svg+xml\">\n    <link rel=\"apple-touch-icon\" href=\"/apple-touch-icon.png\">\n</head>\n\n<body>\n    <!--\n    * Layout *\n    The main-container element is split in two (outline-find-container and body-pane) by the main-resizer.\n    The outline-find-container is split in two (outline-pane and find-pane) by the secondary-resizer.\n    So in total, there are three panes and two resizers. The rest are just floating buttons which are not part of the layout.\n    -->\n    <div id=\"top-bar\">\n        <div id=\"top-container\">\n            <div id=\"document-tabs\">\n                <div class=\"document-tab active\">Untitled<div class=\"close-btn\"></div>\n                </div>\n                <div class=\"document-tab\">Untitled2<div class=\"close-btn\"></div>\n                </div>\n            </div>\n            <div id=\"top-menu\"></div>\n        </div>\n        <!-- Top menu toggle is at the right: -->\n        <div id=\"top-menu-toggle\" aria-label=\"Hide menu\" title=\"Hide menu\">&#8801;</div>\n    </div>\n    <div id=\"main-container\">\n        <div id=\"outline-find-container\" style=\"visibility: hidden;\">\n            <div id=\"outline-pane\" tabindex=\"0\">\n                <div id=\"spacer\"></div>\n                <div id=\"collapse-all-btn\" class=\"outline-icon\" title=\"Collapse All\" role=\"button\"\n                    aria-label=\"Collapse All\">\n                    <svg width=\"16\" height=\"16\" fill=\"currentColor\">\n                        <path\n                            d=\"M 6 2 L 5 3 L 5 5 L 3 5 L 2 6 L 2 13 L 3 14 L 10 14 L 11 13 L 11 11 L 13 11 L 14 10 L 14 3 L 13 2 L 6 2 z M 6 3 L 13 3 L 13 10 L 11 10 L 11 6 L 10 5 L 6 5 L 6 3 z M 3 6 L 10 6 L 10 13 L 3 13 L 3 6 z M 4 9 L 4 10 L 9 10 L 9 9 L 4 9 z \"\n                            style=\"fill:var(--find-border-color);\" />\n                    </svg>\n                </div>\n            </div>\n            <div id=\"secondary-resizer\"></div>\n            <div id=\"log-pane\">\n                <div id=\"log-pane-tabs\">\n                    <div class=\"tab\" id=\"log-tab\" title=\"Log Pane\">Log</div>\n                    <div class=\"tab\" id=\"find-tab\" title=\"Find Pane\">Find</div>\n                    <div class=\"tab\" id=\"undo-tab\" title=\"Undo Pane\">Undo</div>\n                    <div class=\"tab\" id=\"settings-tab\" title=\"Settings Pane\">Settings</div>\n                </div>\n                <!-- Log Controls -->\n                <div id=\"log-controls\" class=\"log-pane-container\" role=\"region\" aria-label=\"Log Pane\">\n\n                </div>\n\n                <!-- Find controls -->\n                <div id=\"find-controls\" class=\"log-pane-container\" role=\"region\" aria-label=\"Find options\">\n                    <input id=\"find-input\" type=\"text\" autocomplete=\"off\" placeholder=\"&lt;find pattern here&gt;\"\n                        title=\"Ctrl+F: Search | F3/F2: Next/Prev\" aria-label=\"Find pattern\">\n                    <div class=\"find-col\" aria-label=\"Search options\">\n                        <label for=\"opt-whole\">\n                            <input id=\"opt-whole\" type=\"checkbox\" name=\"find-option\" />\n                            Whole Word\n                        </label>\n                        <label for=\"opt-ignorecase\">\n                            <input id=\"opt-ignorecase\" type=\"checkbox\" name=\"find-option\" checked />\n                            Ignore Case\n                        </label>\n                        <label for=\"opt-regexp\">\n                            <input id=\"opt-regexp\" type=\"checkbox\" name=\"find-option\" />\n                            Regexp\n                        </label>\n                        <label for=\"opt-mark\">\n                            <input id=\"opt-mark\" type=\"checkbox\" name=\"find-option\" />\n                            Mark Finds\n                        </label>\n                    </div>\n                    <div class=\"find-col\" role=\"radiogroup\" aria-label=\"Search scope\">\n                        <label for=\"scope-entire\">\n                            <input id=\"scope-entire\" type=\"radio\" name=\"find-scope\" value=\"entire\" checked />\n                            Entire Outline\n                        </label>\n                        <label for=\"scope-suboutline\">\n                            <input id=\"scope-suboutline\" type=\"radio\" name=\"find-scope\" value=\"suboutline\" />\n                            Suboutline Only\n                        </label>\n                        <label for=\"scope-node\">\n                            <input id=\"scope-node\" type=\"radio\" name=\"find-scope\" value=\"node\" />\n                            Node Only\n                        </label>\n                        <label for=\"opt-headline\">\n                            <input id=\"opt-headline\" type=\"checkbox\" name=\"find-target\" checked />\n                            Search Headline\n                        </label>\n                        <label for=\"opt-body\">\n                            <input id=\"opt-body\" type=\"checkbox\" name=\"find-target\" checked />\n                            Search Body\n                        </label>\n                    </div>\n                </div>\n                <!-- Configuration controls -->\n                <div id=\"config-controls\" class=\"log-pane-container\" role=\"region\" aria-label=\"Configuration settings\">\n                    <span class=\"sub-title\">Visible Controls</span>\n                    <div class=\"config-col\" aria-label=\"Config options\">\n                        <label for=\"show-prev-next-history\">\n                            <input id=\"show-prev-next-history\" type=\"checkbox\" name=\"config-option\" checked />\n                            Previous/Next History\n                        </label>\n                        <label for=\"show-prev-next-mark\">\n                            <input id=\"show-prev-next-mark\" type=\"checkbox\" name=\"config-option\" checked />\n                            Previous/Next Marked\n                        </label>\n                        <label for=\"show-toggle-mark\">\n                            <input id=\"show-toggle-mark\" type=\"checkbox\" name=\"config-option\" />\n                            Mark/Unmark\n                        </label>\n                        <label for=\"show-hoist-dehoist\">\n                            <input id=\"show-hoist-dehoist\" type=\"checkbox\" name=\"config-option\" />\n                            Hoist/De-hoist\n                        </label>\n                    </div>\n                    <div class=\"config-col\" aria-label=\"Config options\">\n                        <label for=\"show-layout-orientation\">\n                            <input id=\"show-layout-orientation\" type=\"checkbox\" name=\"config-option\" checked />\n                            Layout Orientation\n                        </label>\n                        <label for=\"show-theme-toggle\">\n                            <input id=\"show-theme-toggle\" type=\"checkbox\" name=\"config-option\" checked />\n                            Dark/Light Theme\n                        </label>\n                        <label for=\"show-node-icons\">\n                            <input id=\"show-node-icons\" type=\"checkbox\" name=\"config-option\" checked />\n                            Node Icons\n                        </label>\n                        <label for=\"show-collapse-all\">\n                            <input id=\"show-collapse-all\" type=\"checkbox\" name=\"config-option\" checked />\n                            Collapse All\n                        </label>\n                        <!-- Future possible options: -->\n                        <!-- <label for=\"show-chapters\">\n                        <input id=\"show-chapters\" type=\"checkbox\" name=\"config-option\" />\n                        Chapters\n                    </label> -->\n                    </div>\n                    <span class=\"sub-title\">Keyboard Shortcuts</span>\n                    <ul class=\"config-col shortcuts\">\n                        <li><span class=\"kbd-spacer\"><kbd>Arrows</kbd></span>  Navigate Outline</li>\n                        <li><span class=\"kbd-spacer\"><kbd>Alt</kbd>+<kbd>Arrows</kbd></span>  Navigate from Body Pane\n                        </li>\n                        <li><span class=\"kbd-spacer\"><kbd>Ctrl</kbd>+<kbd>F</kbd></span>  Find (Reset Scope)\n                        </li>\n                        <li><span class=\"kbd-spacer\"><kbd>F2</kbd>/<kbd>F3</kbd></span>  Previous/Next Match</li>\n                        <li><span class=\"kbd-spacer\"><kbd>Ctrl</kbd>+<kbd>M</kbd></span>  Mark Node</li>\n                        <li><span class=\"kbd-spacer\"><kbd>Alt</kbd>+<kbd>-</kbd></span>  Collapse All</li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        <div id=\"main-resizer\"></div>\n        <div id=\"cross-resizer\"></div>\n        <div id=\"body-pane\" tabindex=\"0\" contenteditable=\"plaintext-only\" spellcheck=\"false\"></div>\n    </div>\n    <div id=\"button-trigger-area\"></div>\n    <div id=\"button-container\">\n        <button tabindex=\"-1\" id=\"menu-toggle\" class=\"action-button\" aria-label=\"Show menu\" title=\"Show menu\"><span\n                id=\"menu-icon\">&#8801;</span></button>\n        <button tabindex=\"-1\" id=\"theme-toggle\" class=\"action-button\" aria-label=\"Toggle dark/light mode\"><span\n                id=\"theme-icon\"></span></button>\n        <button tabindex=\"-1\" id=\"layout-toggle\" class=\"action-button\" aria-label=\"Toggle layout orientation\"><span\n                id=\"layout-icon\"></span></button>\n        <button tabindex=\"-1\" id=\"dehoist-btn\" class=\"action-button\" aria-label=\"De-hoist\" title=\"De-hoist\" disabled>\n            <span class=\"svg-icon\" id=\"dehoist-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 17 17\">\n                    <path\n                        d=\"m 9.717,5.896 0.701,1.249 h 3.238 v 6.494 H 2.344 V 9.3649687 L 1.096,10.038969 V 14.896 h 13.808 v -9 z M 3.198,0.844 1.733,8.267 4.326,6.865 6.23,10.258 9.687,8.388 7.78,4.997 10.374,3.596 Z\"\n                        style=\"fill:var(--find-text-color);\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"hoist-btn\" class=\"action-button\" aria-label=\"Hoist\" title=\"Hoist\">\n            <span class=\"svg-icon\" id=\"hoist-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 17 17\">\n                    <path\n                        d=\"M 7.907,10.33 3.089,4.496 h 2.947 l 0.062,-3.89 3.93,0.002 -0.065,3.89 2.948,-0.001 z M 1.096,5.896 v 9 h 13.808 v -9 h -0.596094 l -1.07,1.249 H 13.656 v 6.494 H 2.344 V 7.145 h 0.4117139 l -1.031,-1.249 z\"\n                        style=\"fill:var(--find-text-color);\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"next-marked-btn\" class=\"action-button\" aria-label=\"Go to Next Marked Node\"\n            title=\"Go to Next Marked Node\" disabled>\n            <span class=\"svg-icon\" id=\"next-marked-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                    <polygon points=\"14,10 6,3 6,17\" fill=\"#cb1919\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"toggle-mark-btn\" class=\"action-button\" aria-label=\"Toggle Mark\" title=\"Toggle Mark\">\n            <span class=\"svg-icon\" id=\"toggle-mark-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"1.5 1 13 13\">\n                    <path\n                        d=\"m 5.0855,2.17 c -0.532,0 -0.73,0.196 -0.73,0.728 v 10.933 l 3.645,-2.253 3.644,2.253 V 2.898 c 0,-0.532 -0.197,-0.729 -0.463,-0.7285 z m 3.906,4.088 0.525,1.574 -0.146,0.124 -1.37,-0.976 -1.37,0.976 -0.146,-0.124 0.525,-1.574 -1.356,-0.991 0.066,-0.168 1.676,-0.022 0.51,-1.574 h 0.182 l 0.51,1.574 1.677,0.022 0.08813,0.129125 z\"\n                        style=\"fill:#cb1919;\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"prev-marked-btn\" class=\"action-button\" aria-label=\"Go to Previous Marked Node\"\n            title=\"Go to Previous Marked Node\" disabled>\n            <span class=\"svg-icon\" id=\"prev-marked-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                    <polygon points=\"6,10 14,3 14,17\" fill=\"#cb1919\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"next-btn\" class=\"action-button\" aria-label=\"Goto Next\" title=\"Goto Next\" disabled>\n            <span class=\"svg-icon\" id=\"next-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                    <polygon points=\"14,10 6,3 6,17\" fill=\"#494\" />\n                </svg>\n            </span>\n        </button>\n        <button tabindex=\"-1\" id=\"prev-btn\" class=\"action-button\" aria-label=\"Goto Previous\" title=\"Goto Previous\"\n            disabled>\n            <span class=\"svg-icon\" id=\"prev-icon\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                    <polygon points=\"6,10 14,3 14,17\" fill=\"#494\" />\n                </svg>\n            </span>\n        </button>\n    </div>\n    <div id=\"menu\" class=\"context-menu\">\n        <ul>\n            <li id=\"action-mark\">Mark</li>\n            <li id=\"action-unmark\">Unmark</li>\n            <li id=\"action-hoist\">Hoist</li>\n            <li id=\"action-dehoist\">De-Hoist</li>\n        </ul>\n    </div>\n    <div id=\"toast\" role=\"status\" aria-live=\"polite\" hidden></div>\n\n    <div id=\"file-dialog\" class=\"modal\">\n        <div class=\"modal-content\">\n            <div class=\"file-dialog-header\">\n                <span id=\"file-dialog-title\"></span>\n                <button id=\"file-dialog-close\"></button>\n            </div>\n\n            <div class=\"file-dialog-breadcrumb\">\n                <button id=\"file-dialog-up\">&#8593;</button>\n                <div id=\"file-dialog-path\"></div>\n            </div>\n\n            <ul id=\"file-dialog-list\" class=\"file-list\"></ul>\n\n            <div class=\"file-dialog-footer\">\n                <input id=\"file-dialog-filename\" />\n                <button id=\"file-dialog-confirm\"></button>\n            </div>\n        </div>\n    </div>\n\n    <div id=\"message-dialog\" class=\"modal\">\n        <div class=\"modal-content\">\n            <h2 id=\"modal-dialog-title\"></h2>\n            <p id=\"modal-dialog-description\"></p>\n            <button id=\"modal-dialog-btn\"></button>\n        </div>\n    </div>\n\n    <div id=\"input-dialog\" class=\"modal\">\n        <div class=\"modal-content\">\n            <h2 id=\"input-dialog-title\"></h2>\n            <p id=\"input-dialog-description\"></p>\n            <div class=\"input-dialog-container\">\n                <input id=\"input-dialog-input\" />\n                <button id=\"input-dialog-btn\"></button>\n            </div>\n        </div>\n    </div>\n</body>\n\n</html>\n",
    "felix.20251103001111.1": ":root {\n  /* light theme (default) */\n  --background-color: #ffffec;\n  --body-pane-color: #fff6f5;\n  --body-link-color: #5178ab;\n  --find-pane-color: #f9f9f9;\n  --resizer-color: #cae1ff;\n  --selected-bg: #cae1ff;\n  --ancestor-bg: #eef5ff;\n  --hover-bg: #dfecff;\n  --focus-outline: #0000ff;\n  --text-color: #000000;\n  --caret-dim-color: #888;\n  --find-text-color: #444;\n  --find-placeholder-color: #888;\n  --find-border-color: #a0a0a0;\n  --find-selection: #0078d7;\n  --menu-bg-color: #eee;\n  --menu-color: #000;\n  --menu-caret-color: #666;\n  --menu-border-color: #ccc;\n  --menu-box-shadow-color: rgba(0, 0, 0, 0.2);\n  /* vertical layout (default) */\n  --main-direction: row;\n  --main-resizer-width: 5px;\n  --main-resizer-height: 100%;\n  --main-resizer-cursor: ew-resize;\n  --main-resizer-extension-width: 5px;\n  --main-resizer-extension-height: 100%;\n  --main-resizer-before-top: unset;\n  --main-resizer-before-left: -5px;\n  --main-resizer-after-right: -5px;\n  --main-resizer-after-bottom: unset;\n  --cross-resizer-size: 5px;\n  --secondary-direction: column;\n  --secondary-height: 100%;\n  --secondary-resizer-width: 100%;\n  --secondary-resizer-height: 5px;\n  --secondary-resizer-cursor: ns-resize;\n  --secondary-resizer-extension-width: 100%;\n  --secondary-resizer-extension-height: 5px;\n  --secondary-resizer-before-top: -5px;\n  --secondary-resizer-before-left: unset;\n  --secondary-resizer-after-right: unset;\n  --secondary-resizer-after-bottom: -5px;\n  /* transitions */\n  --body-transition: unset;\n  --body-pane-transition: unset;\n  --find-pane-transition: unset;\n  /* Top Bar Menu */\n  --menu-font-family: sans-serif;\n  --menu-display: none;\n  --buttons-display: flex;\n  /* body pane wrap */\n  --body-pane-wrap: pre;\n  /* message dialog */\n  --message-dialog-display: none;\n  /* file dialog */\n  --file-dialog-display: none;\n  /* input-dialog */\n  --input-dialog-display: none;\n}\n\n[data-active-tab=\"log\"] {\n  --log-display: flex;\n  --log-tab-bg-color: var(--selected-bg);\n  --find-display: none;\n  --find-tab-bg-color: var(--menu-bg-color);\n  --undo-display: none;\n  --undo-tab-bg-color: var(--menu-bg-color);\n  --settings-display: none;\n  --settings-tab-bg-color: var(--menu-bg-color);\n}\n\n[data-active-tab=\"find\"] {\n  --log-display: none;\n  --log-tab-bg-color: var(--menu-bg-color);\n  --find-display: flex;\n  --find-tab-bg-color: var(--selected-bg);\n  --undo-display: none;\n  --undo-tab-bg-color: var(--menu-bg-color);\n  --settings-display: none;\n  --settings-tab-bg-color: var(--menu-bg-color);\n}\n\n[data-active-tab=\"undo\"] {\n  --log-display: none;\n  --log-tab-bg-color: var(--menu-bg-color);\n  --find-display: none;\n  --find-tab-bg-color: var(--menu-bg-color);\n  --undo-display: flex;\n  --undo-tab-bg-color: var(--selected-bg);\n  --settings-display: none;\n  --settings-tab-bg-color: var(--menu-bg-color);\n}\n\n[data-active-tab=\"settings\"] {\n  --log-display: none;\n  --log-tab-bg-color: var(--menu-bg-color);\n  --find-display: none;\n  --find-tab-bg-color: var(--menu-bg-color);\n  --undo-display: none;\n  --undo-tab-bg-color: var(--menu-bg-color);\n  --settings-display: flex;\n  --settings-tab-bg-color: var(--selected-bg);\n}\n\n[data-show-menu=\"true\"] {\n  --menu-display: flex;\n  --buttons-display: none;\n}\n\n[data-transition=\"true\"] {\n  --body-transition: color 0.15s ease, background-color 0.15s ease;\n  --body-pane-transition: color 0.3s ease, background-color 0.3s ease;\n  --find-pane-transition: color 0.15s ease, background-color 0.15s ease;\n}\n\n[data-theme=\"dark\"] {\n  --background-color: #1e1e2e;\n  --body-pane-color: #2a2536;\n  --body-link-color: #929bda;\n  --find-pane-color: #23202e;\n  --resizer-color: #454a6e;\n  --selected-bg: #454a6e;\n  --ancestor-bg: #2d3250;\n  --hover-bg: #3a3f5e;\n  --focus-outline: #7aa2f7;\n  --text-color: #cdd6f4;\n  --caret-dim-color: #999;\n  --find-text-color: #aeb6d1;\n  --find-placeholder-color: #5a699e;\n  --find-border-color: #81889e;\n  --find-selection: #3c54ce;\n  --menu-bg-color: #2d2934;\n  --menu-color: #cdd6f4;\n  --menu-caret-color: #999;\n  --menu-border-color: #5c5485;\n  --menu-box-shadow-color: rgba(246, 150, 255, 0.247);\n}\n\n[data-layout=\"horizontal\"] {\n  --main-direction: column;\n  --main-resizer-width: 100%;\n  --main-resizer-height: 5px;\n  --main-resizer-cursor: ns-resize;\n  --main-resizer-extension-width: 100%;\n  --main-resizer-extension-height: 5px;\n  --main-resizer-before-top: -5px;\n  --main-resizer-before-left: unset;\n  --main-resizer-after-right: unset;\n  --main-resizer-after-bottom: -5px;\n  --secondary-direction: row;\n  --secondary-height: 100%;\n  --secondary-resizer-width: 5px;\n  --secondary-resizer-height: 100%;\n  --secondary-resizer-cursor: ew-resize;\n  --secondary-resizer-extension-width: 5px;\n  --secondary-resizer-extension-height: 100%;\n  --secondary-resizer-before-top: unset;\n  --secondary-resizer-before-left: -5px;\n  --secondary-resizer-after-right: -5px;\n  --secondary-resizer-after-bottom: unset;\n}\n\n[data-body-wrap=\"true\"] {\n  --body-pane-wrap: pre-wrap;\n}\n\n[data-show-message-dialog=\"true\"] {\n  --message-dialog-display: flex;\n}\n\n[data-show-file-dialog=\"true\"] {\n  --file-dialog-display: flex;\n}\n\n[data-show-input-dialog=\"true\"] {\n  --input-dialog-display: flex;\n}\n\nhtml {\n  font-size: 100%; /* Default to browser's base font size, typically 16px */\n}\n\n/* Custom scrollbars */\n* {\n  /* Firefox */\n  scrollbar-color: var(--resizer-color) transparent;\n}\n\n/* Chrome, Edge, Safari */\n::-webkit-scrollbar {\n  width: 5px;\n  height: 5px;\n}\n\n::-webkit-scrollbar-track {\n  background: transparent;\n  border-radius: 5px;\n}\n\n::-webkit-scrollbar-thumb {\n  background-color: var(--resizer-color);\n  border-radius: 5px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background-color: var(--hover-bg);\n}\n\n/* Top Bar */\n#top-bar {\n  flex-shrink: 0;\n  display: var(--menu-display);\n  justify-content: space-between;\n  align-items: center;\n  background: var(--menu-bg-color);\n  border-bottom: 1px solid var(--menu-border-color);\n  padding: 0;\n  height: 52px;\n  font-family: var(--menu-font-family);\n  font-size: 0.875rem;\n  user-select: none;\n  overflow: hidden;\n}\n\n/* Top container for document tabs and menu */\n#top-container {\n  /* flex-shrink: 0; */\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n}\n\n/* Document Tabs */\n#document-tabs {\n  flex-shrink: 0;\n  display: flex;\n  gap: 2px;\n  height: 26px;\n  padding: 0;\n  border-bottom: 1px solid var(--menu-border-color);\n}\n\n.document-tab {\n  display: flex;\n  align-items: center;\n  padding: 4px 8px;\n  background: var(--menu-bg-color);\n  color: var(--menu-color);\n  border: 1px solid var(--menu-border-color);\n  border-bottom: none;\n  border-radius: 4px 4px 0 0;\n  cursor: pointer;\n}\n\n.document-tab.active {\n  background: var(--selected-bg);\n}\n\n.document-tab:hover {\n  background: var(--hover-bg);\n}\n\n.close-btn {\n  width: 12px;\n  height: 12px;\n  margin-left: 8px;\n  position: relative;\n}\n\n.close-btn::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: 12px;\n  color: var(--menu-color);\n  cursor: pointer;\n}\n\n/* Top Menu */\n#top-menu {\n  display: flex;\n  font-family: var(--menu-font-family);\n  font-size: 0.875rem;\n  height: 26px;\n  flex-shrink: 0;\n  overflow: hidden;\n}\n\n#top-menu-toggle {\n  margin-left: auto;\n  color: var(--menu-color);\n  font-size: 24px;\n  padding: 0px 16px;\n  height: 100%;\n  line-height: 54px;\n  border-left: 1px solid var(--menu-border-color);\n}\n\n#top-menu-toggle:hover {\n  background: var(--ancestor-bg);\n}\n\n.menu {\n  background: var(--menu-bg-color);\n  color: var(--menu-color);\n  /* border-bottom: 1px solid var(--menu-border-color); */\n  position: relative;\n  z-index: 10;\n  user-select: none;\n}\n\n.submenu {\n  font-family: var(--menu-font-family);\n  font-size: 0.875rem;\n  display: none;\n  flex-direction: column;\n  position: absolute;\n  background: var(--menu-bg-color);\n  color: var(--menu-color);\n  border: 1px solid var(--menu-border-color);\n  min-width: 160px;\n  box-shadow: 0 2px 6px var(--menu-box-shadow-color);\n  z-index: 1000;\n}\n\n.submenu.visible {\n  display: flex;\n}\n\n.menu-item {\n  position: relative;\n  padding: 5px 14px;\n  cursor: default;\n  white-space: nowrap;\n}\n\n.menu-item:hover {\n  background: var(--ancestor-bg);\n}\n\n.submenu .menu-item:hover {\n  background: var(--selected-bg);\n}\n\n.menu-item.active {\n  background: var(--hover-bg);\n}\n\n.menu-item.sub-active {\n  background: var(--selected-bg);\n}\n\n.menu-item.focused {\n  outline: 1px dotted var(--find-border-color);\n  background: var(--selected-bg);\n}\n\n.menu-item.has-sub::after {\n  content: \"\";\n  font-size: 0.7rem;\n  float: right;\n  margin-left: 8px;\n  color: var(--menu-caret-color);\n}\n\n.menu:not(.submenu) > .menu-item {\n  padding: 5px 12px;\n}\n\n.icon0 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/></svg>');\n}\n\n.icon1 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/></svg>');\n}\n\n.icon2 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/></svg>');\n}\n\n.icon3 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\">   <path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/></svg>');\n}\n\n.icon4 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon5 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon6 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon7 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%234d4d4d\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon8 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/></svg>');\n}\n\n.icon9 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/></svg>');\n}\n\n.icon10 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/></svg>');\n}\n\n.icon11 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/></svg>');\n}\n\n.icon12 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon13 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon14 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\n.icon15 {\n  background-image: url('data:image/svg+xml;utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path d=\"M7.074 4.5v8h1v-8z\" fill=\"%23e54a16\"/><path d=\"M0 4v9h15.15V4zm1 1h13.15v7H1z\" fill=\"%23a4a59e\"/><path d=\"M9.075 6v5h4.075V6zm1 1h2.076v3h-2.076z\" fill=\"%2342a5f5\"/><path d=\"M3.56 5.65v2h1v-.279a1.5 1.5 0 11-2.27 1.904l-.923.395A2.5 2.5 0 006.074 8.5a2.5 2.5 0 00-.824-1.85h.31v-1z\" fill=\"%23e54a16\"/></svg>');\n}\n\nbody {\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n}\n\n#main-container {\n  z-index: 0;\n  margin: 0;\n  display: flex;\n  min-height: 0;\n  flex-grow: 1;\n  overflow: hidden;\n  flex-direction: var(--main-direction);\n  background-color: var(--background-color);\n  color: var(--text-color);\n  transition: var(--body-transition);\n}\n\nbody.dragging-main {\n  cursor: var(--main-resizer-cursor) !important;\n}\n\nbody.dragging-secondary {\n  cursor: var(--secondary-resizer-cursor) !important;\n}\n\nbody.dragging-cross {\n  cursor: move !important;\n}\n\n#outline-pane {\n  position: relative;\n  white-space: nowrap;\n  padding-top: 6px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  font-family: sans-serif;\n}\n\n#spacer {\n  position: relative;\n}\n\n#collapse-all-btn {\n  position: fixed;\n  z-index: 100;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n  pointer-events: none;\n}\n\n#outline-pane:hover #collapse-all-btn {\n  opacity: 1;\n  pointer-events: auto;\n}\n\n#menu-icon {\n  font-size: 27px;\n}\n\n.outline-icon {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  width: 16px;\n  height: 16px;\n}\n\n.outline-icon:hover svg {\n  transform: scale(1.1);\n  transition: transform 0.1s ease;\n}\n\n#main-resizer {\n  position: relative;\n  width: var(--main-resizer-width);\n  height: var(--main-resizer-height);\n  cursor: var(--main-resizer-cursor);\n  background-color: var(--resizer-color);\n  flex-shrink: 0;\n}\n\n#main-resizer::before,\n#main-resizer::after {\n  content: \"\";\n  position: absolute;\n  height: var(--main-resizer-extension-height);\n  width: var(--main-resizer-extension-width);\n  cursor: var(--main-resizer-cursor);\n}\n\n#main-resizer::before {\n  top: var(--main-resizer-before-top);\n  left: var(--main-resizer-before-left);\n}\n\n#main-resizer::after {\n  right: var(--main-resizer-after-right);\n  bottom: var(--main-resizer-after-bottom);\n}\n\n#outline-find-container {\n  display: flex;\n  flex-direction: var(--secondary-direction);\n  height: var(--secondary-height);\n  overflow: hidden;\n}\n\n#secondary-resizer {\n  position: relative;\n  height: var(--secondary-resizer-height);\n  width: var(--secondary-resizer-width);\n  cursor: var(--secondary-resizer-cursor);\n  background-color: var(--resizer-color);\n  flex-shrink: 0;\n}\n\n#secondary-resizer::before,\n#secondary-resizer::after {\n  content: \"\";\n  position: absolute;\n  width: var(--secondary-resizer-extension-width);\n  height: var(--secondary-resizer-extension-height);\n  cursor: var(--secondary-resizer-cursor);\n}\n\n#secondary-resizer::before {\n  top: var(--secondary-resizer-before-top);\n  left: var(--secondary-resizer-before-left);\n}\n\n#secondary-resizer::after {\n  bottom: var(--secondary-resizer-after-bottom);\n  right: var(--secondary-resizer-after-right);\n}\n\n#cross-resizer {\n  position: absolute;\n  top: 200px;\n  left: 200px;\n  width: var(--cross-resizer-size);\n  height: var(--cross-resizer-size);\n  cursor: move;\n  background-color: transparent;\n  flex-shrink: 0;\n}\n\n#cross-resizer::after {\n  content: \"\";\n  position: absolute;\n  top: -5px;\n  left: -5px;\n  width: 15px;\n  height: 15px;\n  cursor: move;\n}\n\n#outline-pane,\n#log-pane {\n  /* overflow-y: auto; */\n  flex: 1 1 0;\n}\n\n#body-pane {\n  flex: 1;\n  padding: 1rem 0 0 1rem;\n  min-height: 0;\n  background-color: var(--body-pane-color);\n  overflow-y: auto;\n  font-family: \"Consolas\", \"Monaco\", \"Courier New\", monospace;\n  white-space: var(--body-pane-wrap);\n  transition: var(--body-pane-transition);\n}\n\n#body-pane a {\n  color: var(--body-link-color);\n}\n\n#outline-pane:focus,\n#body-pane:focus,\n#outline-pane:focus-visible,\n#body-pane:focus-visible {\n  /* \n    Note: Outline will appear under the items positioned absolutely.\n    See pseudo-elements with \"z-index: -1\" that appear below this outline.\n  */\n  outline: 3px solid var(--focus-outline);\n  outline-offset: -3px;\n}\n\n.node-text:hover::before,\n.selected > .node-text::before,\n.ancestor > .node-text::before,\n.initial-find > .node-text::before {\n  content: \"\";\n  position: absolute;\n  top: 0;\n  left: -2px;\n  right: 0;\n  bottom: 0;\n  z-index: -1;\n  border-radius: 4px;\n}\n\n.selected > .node-text::before,\n.selected > .node-text:hover::before {\n  background-color: var(--selected-bg);\n}\n\n.ancestor > .node-text::before {\n  background-color: var(--ancestor-bg);\n}\n\n.node-text:hover::before {\n  background-color: var(--hover-bg);\n}\n\n.initial-find > .node-text::before {\n  border: 1.5px solid var(--find-selection);\n  border-style: dotted;\n}\n\n.node {\n  position: absolute;\n  white-space: nowrap;\n  cursor: pointer;\n  display: grid;\n  grid-template-columns: 1em 1fr;\n  align-items: start;\n}\n\nbody.dragging-main .node {\n  cursor: var(--main-resizer-cursor);\n}\n\nbody.dragging-secondary .node {\n  cursor: var(--secondary-resizer-cursor);\n}\n\n.caret {\n  grid-column: 1;\n  display: inline-block;\n  width: 32px;\n  height: 26px;\n  position: relative;\n  left: -16px;\n  user-select: none;\n}\n\n.node-text {\n  position: relative;\n  background-repeat: no-repeat;\n  background-position-x: 2px;\n  background-position-y: 1px;\n  background-size: 19px 19px;\n  grid-column: 2;\n  display: block;\n  padding: 2px 0 2px 26px;\n  margin-right: 1.2rem;\n  border-radius: 4px;\n}\n\n/* Special handling for node icons */\n[data-show-icons=\"false\"] .node-text {\n  background-image: none !important;\n  padding-left: 4px !important;\n  /* Reduce padding when icons are hidden */\n}\n\n.caret::after {\n  display: inline-block;\n  position: relative;\n  left: 16px;\n  transform-origin: 50% 50%;\n  transition: transform 160ms cubic-bezier(0.2, 0.9, 0.3, 1), color 120ms;\n}\n\n.caret[data-expanded=\"true\"]::after {\n  content: \"\";\n  transform: rotate(90deg);\n}\n\n.caret[data-expanded=\"false\"]::after {\n  content: \"\";\n  transform: rotate(0deg);\n  color: var(--caret-dim-color);\n}\n\n.caret.toggled[data-expanded=\"true\"]::after {\n  content: \"\";\n  transform: rotate(90deg);\n  animation: rotateOpen 120ms ease-out;\n}\n\n.caret.toggled[data-expanded=\"false\"]::after {\n  content: \"\";\n  transform: rotate(0deg);\n  color: var(--caret-dim-color);\n  animation: rotateClose 120ms ease-out;\n}\n\n@keyframes rotateOpen {\n  from {\n    transform: rotate(0deg);\n    color: var(--caret-dim-color);\n  }\n\n  to {\n    transform: rotate(90deg);\n    color: inherit;\n  }\n}\n\n@keyframes rotateClose {\n  from {\n    transform: rotate(90deg);\n    color: inherit;\n  }\n\n  to {\n    transform: rotate(0deg);\n    color: var(--caret-dim-color);\n  }\n}\n\n/* buttons */\n#button-container {\n  display: var(--buttons-display);\n  position: fixed;\n  top: 0px;\n  right: 12px;\n  padding-top: 8px;\n  flex-direction: row-reverse;\n  justify-content: flex-start;\n  gap: 8px;\n  z-index: 1000;\n  transition: opacity 0.4s ease;\n  pointer-events: auto;\n}\n\n#button-container.hidden {\n  display: var(--buttons-display);\n  opacity: 0;\n  pointer-events: none;\n}\n\n#button-trigger-area {\n  display: var(--buttons-display);\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 200px;\n  height: 40px;\n  z-index: 999;\n}\n\n.action-button {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: var(--resizer-color);\n  color: var(--text-color);\n  border: 2px solid var(--text-color);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  line-height: 1;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  z-index: 1000;\n  overflow: hidden;\n  transition: transform 0.2s ease;\n  user-select: none;\n}\n\n.action-button:hover {\n  transform: scale(1.1);\n}\n\n.action-button:disabled {\n  opacity: 0.4;\n  cursor: default;\n  box-shadow: none;\n  border-color: var(--caret-dim-color);\n}\n\n.action-button:disabled:hover {\n  transform: none;\n}\n\n.svg-icon {\n  position: relative;\n  top: 0;\n  left: 0;\n  transition: top 0.3s ease, left 0.3s ease, transform 0.3s ease;\n}\n\n#dehoist-btn:active #dehoist-icon {\n  top: -10px;\n}\n\n#hoist-btn:active #hoist-icon {\n  top: 10px;\n}\n\n#prev-btn:active #prev-icon {\n  left: -10px;\n}\n\n#next-btn:active #next-icon {\n  left: 10px;\n}\n\n#theme-icon {\n  position: relative;\n  top: 0;\n  transition: top 0.3s ease;\n}\n\n#theme-toggle:active #theme-icon {\n  top: 25px;\n}\n\n#layout-icon {\n  position: relative;\n  top: 0;\n}\n\n[data-layout=\"horizontal\"] #layout-icon {\n  transform: rotate(90deg);\n}\n\n[data-transition=\"true\"] #layout-icon {\n  transition: transform 0.3s ease;\n}\n\n.svg-icon svg {\n  display: block;\n  width: 20px;\n  height: 20px;\n}\n\n.action-button:disabled:active #theme-icon,\n.action-button:disabled:active #dehoist-icon,\n.action-button:disabled:active #hoist-icon {\n  top: 0 !important;\n}\n\n.action-button:disabled:active #prev-icon,\n.action-button:disabled:active #next-icon {\n  left: 0 !important;\n}\n\n#toggle-mark-btn:active #toggle-mark-icon {\n  transform: scale(0.7);\n}\n\n#prev-marked-btn:active #prev-marked-icon {\n  left: -10px;\n}\n\n#next-marked-btn:active #next-marked-icon {\n  left: 10px;\n}\n\n.hidden-button {\n  display: none !important;\n}\n\n/* log pane */\n#log-pane {\n  display: flex;\n  flex-direction: column;\n  scrollbar-gutter: stable;\n  font-family: sans-serif;\n  padding: 0.1rem 0 0 0;\n  min-height: 0;\n  background-color: var(--find-pane-color);\n  position: relative;\n  transition: var(--find-pane-transition);\n  container-type: inline-size;\n  container-name: find-pane;\n}\n\n#find-controls,\n#config-controls {\n  gap: 0.5rem;\n  align-items: flex-start;\n  flex-wrap: wrap;\n}\n\n@container log-pane (min-width: 450px) {\n  #config-controls {\n    justify-content: center;\n  }\n}\n\n#log-pane-tabs {\n  display: flex; /* line them up horizontally */\n  gap: 2px; /* small space between tabs */\n  /* background: #222; */\n  padding: 0 0 0 0.2rem;\n  /* border-bottom: 1px solid #444; */\n}\n\n#log-pane-tabs .tab {\n  cursor: pointer;\n  user-select: none;\n  font-size: 0.8rem;\n\n  padding: 4px 6px;\n  border-radius: 6px 6px 0 0; /* tab-like top rounding */\n  transition: background 0.2s, transform 0.1s;\n}\n\n#log-pane-tabs .tab:hover {\n  background: var(--hover-bg);\n}\n\n#log-tab {\n  background: var(--log-tab-bg-color);\n}\n\n#log-controls {\n  display: var(--log-display);\n  padding: 0.5rem 0.5rem 0.5rem 0.5rem;\n}\n\n#find-tab {\n  background: var(--find-tab-bg-color);\n}\n\n#find-controls {\n  padding: 0.25rem 0.5rem 0.5rem 0.5rem;\n  display: var(--find-display);\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n#undo-tab {\n  background: var(--undo-tab-bg-color);\n}\n\n#undo-controls {\n  padding: 0;\n  display: var(--undo-display);\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n#settings-tab {\n  background: var(--settings-tab-bg-color);\n}\n\n#config-controls {\n  padding-top: 0.5rem;\n  display: var(--settings-display);\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.config-title {\n  cursor: default;\n  user-select: none;\n  width: 100%;\n  text-align: center;\n  font-weight: bold;\n  margin: 0;\n  font-size: 1em;\n  color: var(--find-text-color);\n}\n\n.config-title svg {\n  vertical-align: middle;\n}\n\n.sub-title {\n  width: 100%;\n  text-align: center;\n  margin: 0;\n  color: var(--caret-dim-color);\n  font-style: italic;\n  font-size: 0.9em;\n  cursor: default;\n  user-select: none;\n}\n\n#log-pane .config-col.shortcuts {\n  list-style: none;\n  padding: 0;\n  margin: -5px 0 0 0;\n  font-size: 0.8em;\n  color: var(--find-text-color);\n  gap: 0;\n  min-width: 285px;\n  cursor: default;\n  user-select: none;\n}\n\n#log-pane .config-col.shortcuts li {\n  padding: 0.25rem 0.5rem;\n  display: flex;\n  align-items: center;\n}\n\n#log-pane .config-col.shortcuts kbd {\n  display: inline-block;\n  padding: 0.1rem 0.4rem;\n  margin: 0 0.2rem;\n  font-family: monospace;\n  font-size: 0.9em;\n  line-height: 1.4;\n  color: var(--text-color);\n  background-color: var(--resizer-color);\n  border: 1px solid var(--find-border-color);\n  border-radius: 3px;\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);\n}\n\n.kbd-spacer {\n  display: inline-block;\n  width: 100px;\n}\n\n#log-pane .find-col,\n#log-pane .config-col {\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n  min-width: 110px;\n}\n\n#log-pane .find-col label,\n#log-pane .config-col label {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n  user-select: none;\n  font-size: 0.8em;\n  color: var(--find-text-color);\n}\n\n.config-col label {\n  padding-left: 0.5rem;\n}\n\n#log-pane input[type=\"checkbox\"],\n#log-pane input[type=\"radio\"] {\n  flex-shrink: 0;\n  width: 16px;\n  height: 16px;\n  margin: 0;\n}\n\n#find-input {\n  width: 100%;\n  /* max-width: 260px; */\n  box-sizing: border-box;\n  padding: 0.4rem 0.5rem;\n  margin: 0;\n  border-radius: 3px;\n  border: 1px solid var(--find-border-color);\n  background: transparent;\n  color: var(--find-text-color);\n  font-family: sans-serif;\n}\n\n#find-input::placeholder {\n  color: var(--find-placeholder-color);\n}\n\ninput[type=\"checkbox\"] {\n  appearance: none;\n  width: 20px;\n  height: 20px;\n  border: 1px solid var(--find-border-color);\n  border-radius: 3px;\n  background-color: var(--find-pane-color);\n  position: relative;\n}\n\ninput[type=\"checkbox\"]:checked::after {\n  content: \"\";\n  position: absolute;\n  left: 4px;\n  top: -2px;\n  width: 4px;\n  height: 12px;\n  border: solid var(--find-border-color);\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n}\n\ninput[type=\"radio\"] {\n  appearance: none;\n  width: 20px;\n  height: 20px;\n  border: 1px solid var(--find-border-color);\n  border-radius: 50%;\n  background-color: var(--find-pane-color);\n  position: relative;\n}\n\ninput[type=\"radio\"]:checked::after {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 8px;\n  height: 8px;\n  transform: translate(-50%, -50%);\n  background-color: var(--find-text-color);\n  border-radius: 50%;\n}\n\ninput[type=\"radio\"]:focus:checked::after,\ninput[type=\"radio\"]:focus-visible:checked::after {\n  background-color: var(--find-selection);\n}\n\ninput[type=\"checkbox\"]:focus:checked::after,\ninput[type=\"checkbox\"]:focus-visible:checked::after {\n  border: solid var(--find-selection);\n  border-width: 0 2px 2px 0;\n}\n\n#find-controls input:focus,\n#find-controls input:focus-visible {\n  border-color: var(--find-selection);\n  outline: 2px solid var(--find-selection);\n  outline-offset: -1px;\n}\n\na {\n  color: var(--caret-dim-color);\n  text-decoration: underline;\n}\n\na:hover {\n  color: var(--find-text-color);\n}\n\n.footer {\n  margin-bottom: 1rem;\n}\n\n/* context menu */\n.context-menu {\n  position: absolute;\n  display: none;\n  font-family: sans-serif;\n  font-size: 0.85rem;\n  background: var(--find-pane-color);\n  border: 1px solid var(--find-border-color);\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);\n  border-radius: 4px;\n  z-index: 1000;\n}\n\n.context-menu ul {\n  list-style: none;\n  margin: 0;\n  padding: 4px 0;\n}\n\n.context-menu li {\n  padding: 6px 12px;\n  cursor: pointer;\n}\n\n.context-menu li:hover {\n  background: var(--hover-bg);\n}\n\n/* toast */\n#toast {\n  position: fixed;\n  top: 16px;\n  left: 50%;\n  transform: translateX(-50%) translateY(-10px);\n  background: var(--body-pane-color);\n  color: var(--find-text-color);\n  padding: 8px 12px;\n  border-radius: 6px;\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);\n  opacity: 0;\n  pointer-events: none;\n  transition: opacity 180ms ease, transform 180ms ease;\n  z-index: 2000;\n  font-family: sans-serif;\n  font-size: 13px;\n  white-space: pre;\n}\n\n#toast.show {\n  opacity: 1;\n  transform: translateX(-50%) translateY(0);\n  pointer-events: auto;\n}\n\n/* Modal Dialog */\n.modal {\n  position: fixed;\n  inset: 0; /* full-screen */\n  background: rgba(0, 0, 0, 0.35); /* backdrop */\n  z-index: 3000;\n  align-items: center;\n  justify-content: center;\n}\n.modal-content {\n  position: relative;\n  max-width: 520px;\n  width: calc(100% - 48px);\n  padding: 16px 20px;\n  border-radius: 8px;\n  background: var(--body-pane-color);\n  color: var(--text-color);\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);\n  border: 1px solid var(--find-border-color);\n}\n\n/* Workspace dialog */\n#message-dialog {\n  display: var(--message-dialog-display);\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n}\n\n#message-dialog .modal-content button {\n  display: block;\n  margin: 16px auto 0 auto;\n  padding: 8px 12px;\n  border-radius: 6px;\n  border: 1px solid var(--find-border-color);\n  background: var(--resizer-color);\n  color: var(--text-color);\n  cursor: pointer;\n}\n#message-dialog .modal-content button:hover {\n  background: var(--hover-bg);\n}\n\n/* File open/save dialog */\n#file-dialog {\n  display: var(--file-dialog-display);\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n}\n\n/* File dialog header */\n#file-dialog .file-dialog-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 8px;\n  margin-bottom: 12px;\n  border-bottom: 1px solid var(--find-border-color);\n  padding-bottom: 8px;\n}\n\n#file-dialog-title {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--find-text-color);\n}\n\n#file-dialog-close {\n  appearance: none;\n  border: 1px solid var(--find-border-color);\n  background: transparent;\n  color: var(--find-text-color);\n  width: 28px;\n  height: 28px;\n  border-radius: 6px;\n  cursor: pointer;\n}\n#file-dialog-close:hover {\n  background: var(--hover-bg);\n}\n\n/* Breadcrumb row */\n.file-dialog-breadcrumb {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 10px;\n}\n\n/* Up button */\n#file-dialog-up {\n  appearance: none;\n  border: 1px solid var(--find-border-color);\n  background: rgba(255, 232, 29, 0.25);\n  color: var(--find-text-color);\n  width: 28px;\n  height: 28px;\n  border-radius: 6px;\n  cursor: pointer;\n}\n#file-dialog-up:hover {\n  background: var(--hover-bg);\n}\n#file-dialog-up:disabled {\n  opacity: 0.4;\n  background: rgba(221, 214, 150, 0.25);\n  cursor: default;\n  border-color: var(--caret-dim-color);\n}\n\n/* Path breadcrumb */\n#file-dialog-path {\n  flex-grow: 2;\n  font-family: monospace;\n  font-size: 0.9rem;\n  color: var(--caret-dim-color);\n  padding: 6px 8px;\n  border: 1px solid var(--find-border-color);\n  border-radius: 6px;\n  background: var(--find-pane-color);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* File list */\n.file-list {\n  list-style: none;\n  padding: 0;\n  margin: 0 0 12px 0;\n  border: 1px solid var(--find-border-color);\n  border-radius: 8px;\n  background: var(--find-pane-color);\n  height: 300px; /* fixed height */\n  overflow-y: auto; /* vertical scroll */\n  overflow-x: hidden;\n}\n\n.file-list li {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 10px;\n  cursor: pointer;\n  color: var(--text-color);\n  user-select: none;\n}\n\n/* File icons as  pseudo-elements */\n.file-list li.file::before,\n.file-list li.directory::before {\n  content: \"\";\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  background-repeat: no-repeat;\n  background-size: contain;\n  background-position: center;\n  flex-shrink: 0;\n}\n\n.file-list li.file::before {\n  /* Generic file icon emoji */\n  content: \"\";\n}\n\n.file-list li.directory::before {\n  /* Generic folder icon emoji */\n  content: \"\";\n}\n\n.file-list li:hover {\n  background: var(--hover-bg);\n}\n.file-list li.selected {\n  background: var(--selected-bg);\n  outline: 1px solid var(--find-border-color);\n}\n\n/* Footer: input + buttons */\n.file-dialog-footer {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n#file-dialog-filename {\n  flex: 1;\n  padding: 8px 10px;\n  border-radius: 6px;\n  border: 1px solid var(--find-border-color);\n  background: transparent;\n  color: var(--text-color);\n}\n#file-dialog-filename::placeholder {\n  color: var(--find-placeholder-color);\n}\n#file-dialog-filename:focus {\n  outline: 2px solid var(--find-selection);\n  border-color: var(--find-selection);\n  outline-offset: -1px;\n}\n\n#file-dialog-confirm {\n  padding: 8px 14px;\n  border-radius: 6px;\n  border: 1px solid var(--find-border-color);\n  background: var(--resizer-color);\n  color: var(--text-color);\n  cursor: pointer;\n  font-weight: 600;\n}\n#file-dialog-confirm:hover {\n  background: var(--hover-bg);\n}\n\n/* Optional: subtle accent border for the dialog content */\n#file-dialog .modal-content {\n  border: 1px solid var(--menu-border-color);\n}\n\n/* Input dialog */\n#input-dialog {\n  display: var(--input-dialog-display);\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n}\n\n#input-dialog .input-dialog-container {\n  display: flex;\n  align-items: center;\n  gap: 8px; /* space between input and button */\n  margin-top: 12px;\n}\n\n#input-dialog-input {\n  flex: 1; /* input takes remaining width */\n  padding: 8px 10px;\n  border-radius: 6px;\n  border: 1px solid var(--find-border-color);\n  background: transparent;\n  color: var(--text-color);\n}\n\n#input-dialog-input::placeholder {\n  color: var(--find-placeholder-color);\n}\n\n#input-dialog-input:focus {\n  outline: 2px solid var(--find-selection);\n  border-color: var(--find-selection);\n  outline-offset: -1px;\n}\n\n#input-dialog-btn {\n  padding: 8px 12px;\n  border-radius: 6px;\n  border: 1px solid var(--find-border-color);\n  background: var(--resizer-color);\n  color: var(--text-color);\n  cursor: pointer;\n  flex-shrink: 0; /* keep button width tight */\n  font-weight: 600;\n}\n\n#input-dialog-btn:hover {\n  background: var(--hover-bg);\n}\n",
    "felix.20251210234420.1": "@language typescript\n@tabwidth -4\n@others\n",
    "felix.20251210234420.2": "/**\n * Text and numeric constants used throughout leojs\n */\nexport class Constants {\n\n    /**\n     * Identity of account that can publish extensions to the Visual Studio Code Marketplace. \n     */\n    public static PUBLISHER: string = \"boltex\";\n\n    /**\n     * The name of the extension - should be all lowercase with no spaces.\n     */\n    @others\n}\n",
    "felix.20251210234420.3": "public static NAME: string = \"leoWeb\";\n\npublic static VERSION_STATE_KEY: string = \"leoWebVersion\";\n\npublic static FILE_EXTENSION: string = \"leo\";\npublic static DB_FILE_EXTENSION: string = \"db\";\npublic static JS_FILE_EXTENSION: string = \"leojs\";\n\n",
    "felix.20251210234420.4": "/**\n * Supported Languages\n */\npublic static LANGUAGES = [\n    \"plain\",\n    \"julia\",\n    \"batch\",\n    \"shell\",\n    \"python\",\n    \"javascript\",\n    \"typescript\",\n    \"c\",\n    \"cpp\",\n    \"css\",\n    \"fortran\",\n    \"fortran90\",\n    \"html\",\n    \"java\",\n    \"json\",\n    \"markdown\",\n    \"php\",\n    \"restructuredtext\",\n    \"rust\",\n    \"xml\",\n];\n\n",
    "felix.20251210234420.6": "/**\n * Basic user messages strings for messages and dialogs\n */\npublic static USER_MESSAGES = {\n    SCRIPT_BUTTON: \"from selected node\",\n    SCRIPT_BUTTON_TOOLTIP:\n        \"Creates a new button with the presently selected node.\\n\" +\n        \"For example, to run a script on any part of an outline:\\n\" +\n        \"\\n\" +\n        \"1.  Select the node containing a script. e.g. \\\"g.es(p.h)\\\"\\n\" +\n        \"2.  Press 'Script Button' to create a new button.\\n\" +\n        \"3.  Select another node on which to run the script.\\n\" +\n        \"4.  Press the *new* button.\",\n    SAVE_CHANGES: \"Save changes to\",\n    SAVE_DIALOG_LABEL: \"Save Leo File\",\n    BEFORE_CLOSING: \"before closing?\",\n    CANCEL: \"Cancel\",\n    OPEN_WITH_LEO: \"Open this Leo file?\",\n    OPEN_RECENT_FILE: \"Open Recent Leo File\",\n    RIGHT_CLICK_TO_OPEN: \"Right-click to open with leo\",\n    FILE_ALREADY_OPENED: \"Leo file already opened\",\n\n    CLEARED_RECENT: \"Cleared recent files list\",\n    CHOOSE_OPENED_FILE: \"Select an opened Leo File\",\n    FILE_NOT_OPENED: \"No files opened.\",\n\n    PROMPT_EDIT_HEADLINE: \"Edit Headline\",\n    PROMPT_INSERT_NODE: \"Insert Node\",\n    PROMPT_INSERT_CHILD: \"Insert Child\",\n    DEFAULT_HEADLINE: \"New Headline\",\n\n    TITLE_GOTO_GLOBAL_LINE: \"Goto global line\", // TODO : REMOVE IF NOT USED\n    PLACEHOLDER_GOTO_GLOBAL_LINE: \"#\", // TODO : REMOVE IF NOT USED\n    PROMPT_GOTO_GLOBAL_LINE: \"Line number\", // TODO : REMOVE IF NOT USED\n\n    REPLACE_TITLE: \"Replace with\",\n    REPLACE_PROMPT: \"Type text to replace with and press enter.\",\n    REPLACE_PLACEHOLDER: \"Replace pattern here\",\n\n    SEARCH_TITLE: \"Search for\",\n    SEARCH_PROMPT: \"Type text to search for and press enter.\",\n    SEARCH_PLACEHOLDER: \"Find pattern here\",\n\n    INT_SEARCH_TITLE: \"Search\",\n    INT_SEARCH_PROMPT: \"'Enter' to search\",\n    INT_SEARCH_BACKWARD: \" Backward\", // Leading space intended\n    INT_SEARCH_REGEXP: \"Regexp \", // Trailing space intended\n    INT_SEARCH_WORD: \"Word \", // Trailing space intended\n\n    SEARCH_NOT_FOUND: \"Not found\",\n    FIND_PATTERN_HERE: \"<find pattern here>\",\n\n    TAGS_CHARACTERS_ERROR: \"Cannot add tags containing any of these characters: &|^-\",\n    NO_TAGS_ON_NODE: \"No tags on node: \", // Trailing space intended\n\n    TITLE_TAG_CHILDREN: \"Tag Children\",\n    TITLE_REMOVE_TAG: \"Remove Tag\",\n    TITLE_TAG_NODE: \"Tag Node\",\n    PLACEHOLDER_TAG: \"<tag>\",\n    PROMPT_TAG: \"Enter a tag name\",\n\n    TITLE_FIND_TAG: \"Find Tag\", // TODO remove if used directly in leoFind.ts\n    PLACEHOLDER_CLONE_FIND_TAG: \"<tag>\", // TODO remove if used directly in leoFind.ts\n    PROMPT_CLONE_FIND_TAG: \"Enter a tag name\",// TODO remove if used directly in leoFind.ts\n\n    CLOSE_ERROR: \"Cannot close: No files opened.\",\n    YES: \"Yes\",\n    NO: \"No\",\n    YES_ALL: \"Yes to all\",\n    NO_ALL: \"No to all\",\n    CHOOSE_BUTTON: \"Choose @button or @rclick\",\n    SEARCH_POSITION_BY_HEADLINE: \"Search positions by headline\",\n    MINIBUFFER_PROMPT: \"Minibuffer Full Command\",\n    SELECT_CHAPTER_PROMPT: \"Select chapter\",\n    CHANGES_DETECTED: \"Changes to external files were detected.\",\n    REFRESHED: \" Nodes refreshed.\", // with voluntary leading space\n    IGNORED: \" They were ignored.\", // with voluntary leading space\n    TOO_FAST: \"Leo is busy! \", // with voluntary trailing space\n\n    LANGUAGE_NOT_SUPPORTED: \" language coloring not yet supported.\", // with leading space\n    MINIBUFFER_BUTTON_START: \"@button-\",\n    MINIBUFFER_RCLICK_START: \"@rclick-\",\n    MINIBUFFER_SCRIPT_BUTTON: \"script-button\",\n    MINIBUFFER_DEL_SCRIPT_BUTTON: \"delete-script-\",\n    MINIBUFFER_DEL_BUTTON_START: \"delete-@button-\",\n    MINIBUFFER_COMMAND_START: \"@command-\",\n    MINIBUFFER_USER_DEFINED: \"User defined command.\",\n    MINIBUFFER_BUTTON: \"$(run) @button\",\n    MINIBUFFER_RCLICK: \"$(chevron-right) @rclick\",\n    MINIBUFFER_COMMAND: \"$(zap) @command\",\n    MINIBUFFER_BAD_COMMAND: \"$(error) Not Available\",\n    MINIBUFFER_HISTORY_LABEL: \"Minibuffer History\",\n    MINIBUFFER_HISTORY_DESC: \"Choose from last run commands...\",\n\n    FIX_IT: \"Fix it\",\n    ENABLE_PREVIEW_SET: \"'Enable Preview' setting was set\",\n    ENABLE_PREVIEW_RECOMMEND: \"'Enable Preview' setting is recommended (currently disabled)\",\n    CLOSE_EMPTY_CLEARED: \"'Close Empty Groups' setting was cleared\",\n    CLOSE_EMPTY_RECOMMEND: \"'Close Empty Groups' setting is NOT recommended!\",\n    SET_LEO_ID_MESSAGE: \"Leo ID not found. Please enter an id that identifies you uniquely.\",\n    GET_LEO_ID_PROMPT: \"Please enter an id that identifies you uniquely.\\n(Letters and numbers only, and at least 3 characters in length)\",\n    ENTER_LEO_ID: \"Enter Leo id\"\n};\n\n",
    "felix.20251210234420.13": "/**\n * Used in 'when' clauses, set with vscode.commands.executeCommand(\"setContext\",...)\n */\npublic static CONTEXT_FLAGS = {\n    // Main flags for connection and opened file\n    LEO_STARTUP_DONE: \"leojsStartupDone\",\n    LEO_OPENING_FILE: \"leojsOpeningFile\",\n    LEO_ID_UNSET: \"leojsIdUnset\",\n    LEO_READY: \"leojsReady\", // Extension activated and classes created and ready\n    TREE_OPENED: \"leojsTreeOpened\", // At least one Leo file opened\n    TREE_TITLED: \"leojsTreeTitled\", // Tree is a Leo file and not a new untitled document\n\n    // 'states' flags for currently opened tree view\n    LEO_CHANGED: \"leojsChanged\",\n    LEO_CAN_UNDO: \"leojsCanUndo\",\n    LEO_CAN_REDO: \"leojsCanRedo\",\n    LEO_CAN_BACK: \"leojsCanGoBack\",\n    LEO_CAN_NEXT: \"leojsCanGoNext\",\n    LEO_CAN_DEMOTE: \"leojsCanDemote\",\n    LEO_CAN_PROMOTE: \"leojsCanPromote\",\n    LEO_CAN_DEHOIST: \"leojsCanDehoist\",\n    LEO_CAN_HOIST: \"leojsCanHoist\", // isNotRoot equivalent, Computed by hand\n    LEO_TOP_HOIST_CHAPTER: \"leojsTopHoistChapter\",\n    LEO_EDIT_HEADLINE: \"leojsEditHeadline\",\n\n    // 'states' flags about current selection, for visibility and commands availability\n    SELECTED_MARKED: \"leojsMarked\", // no need for unmarked here, use !leojsMarked\n    SELECTED_CLONE: \"leojsCloned\",\n    SELECTED_DIRTY: \"leojsDirty\",\n    SELECTED_EMPTY: \"leojsEmpty\",\n    SELECTED_CHILD: \"leojsChild\", // Has children\n    SELECTED_ATFILE: \"leojsAtFile\", // Can be refreshed\n    SELECTED_ATLEOFILE: \"leojsAtLeoFile\", // Can be used with 'open-at-leo-file' command\n\n    // Statusbar Flag 'keybindings in effect'\n    LEO_SELECTED: \"leojsObjectSelected\", // keybindings \"On\": Outline or body has focus\n\n    // Context Flags for 'when' clauses, used concatenated, for each outline node\n    NODE_MARKED: \"leojsNodeMarked\",  // Selected node is marked\n    NODE_UNMARKED: \"leojsNodeUnmarked\", // Selected node is unmarked (Needed for regexp)\n    NODE_ATFILE: \"leojsNodeAtFile\", // Selected node is an @file or @clean, etc...\n    NODE_ATLEOFILE: \"leojsNodeAtLeoFile\", // Selected node is an @leo file\n    NODE_CLONED: \"leojsNodeCloned\",\n    NODE_ROOT: \"leojsNodeRoot\",\n    NODE_NOT_ROOT: \"leojsNodeNotRoot\",\n    NODE_TAGS: \"leojsNodeTags\",\n\n    // Flags for undo nodes \n    UNDO_BEAD: \"leojsUndoNode\",\n    NOT_UNDO_BEAD: \"leojsNoUndoNode\",\n\n    // Flags for Leo documents tree view icons and hover node command buttons\n    DOCUMENT_SELECTED_TITLED: \"leojsDocumentSelectedTitled\",\n    DOCUMENT_TITLED: \"leojsDocumentTitled\",\n    DOCUMENT_SELECTED_UNTITLED: \"leojsDocumentSelectedUntitled\",\n    DOCUMENT_UNTITLED: \"leojsDocumentUntitled\",\n\n    // Flags for focus context\n    FOCUS_FIND: \"leojsFindFocus\",\n\n};\n\n",
    "felix.20251210234420.14": "/**\n * Command strings to be used with vscode.commands.executeCommand\n * See https://code.visualstudio.com/api/extension-guides/command#programmatically-executing-a-command\n */\npublic static VSCODE_COMMANDS = {\n    SET_CONTEXT: \"setContext\",\n    CLOSE_ACTIVE_EDITOR: \"workbench.action.closeActiveEditor\",\n    QUICK_OPEN: \"workbench.action.quickOpen\"\n};\n\n",
    "felix.20251210234420.15": "/**\n * * Table for converting Leo languages names for the currently opened body pane\n * Used in showBody method of leoUI.ts\n */\npublic static LANGUAGE_CODES: { [key: string]: string | undefined } = {\n    cplusplus: 'cpp',\n    md: 'markdown',\n    rest: 'restructuredtext',\n    rst: 'restructuredtext',\n    text: 'plain'\n};\n\n",
    "felix.20251210234420.16": "/**\n * All commands this expansion exposes to the user via GUI/keybindings in package.json\n */\npublic static COMMANDS = {\n    // Access to the Settings/Welcome Webview\n    SHOW_WELCOME: Constants.NAME + \".showWelcomePage\", // Always available: not in the commandPalette section of package.json\n    SHOW_SETTINGS: Constants.NAME + \".showSettingsPage\", // Always available: not in the commandPalette section of package.json\n    STATUS_BAR: Constants.NAME + \".statusBar\", // Status Bar Click Command\n    // Leo Documents\n    SET_OPENED_FILE: Constants.NAME + \".setOpenedFile\",\n    OPEN_FILE: Constants.NAME + \".openLeoFile\", // sets focus on BODY\n    REVERT: Constants.NAME + \".revert\",\n    CLEAR_RECENT_FILES: Constants.NAME + \".clearRecentFiles\",\n    // Import Export Commands\n    IMPORT_ANY_FILE: Constants.NAME + \".importAnyFile\",\n    READ_FILE_INTO_NODE: Constants.NAME + \".readFileIntoNode\",\n    EXPORT_HEADLINES: Constants.NAME + \".exportHeadlines\",\n    FLATTEN_OUTLINE: Constants.NAME + \".flattenOutline\",\n    OUTLINE_TO_CWEB: Constants.NAME + \".outlineToCweb\",\n    OUTLINE_TO_NOWEB: Constants.NAME + \".outlineToNoweb\",\n    REMOVE_SENTINELS: Constants.NAME + \".removeSentinels\",\n    WEAVE: Constants.NAME + \".weave\",\n    WRITE_FILE_FROM_NODE: Constants.NAME + \".writeFileFromNode\",\n    // Leo Document Files\n    RECENT_FILES: Constants.NAME + \".recentLeoFiles\", // shows recent Leo files, opens one on selection\n    SWITCH_FILE: Constants.NAME + \".switchLeoFile\",\n    NEW_FILE: Constants.NAME + \".newLeoFile\",\n    SAVE_FILE: Constants.NAME + \".saveLeoFile\",\n    SAVE_FILE_FO: Constants.NAME + \".saveLeoFileFromOutline\",\n    SAVE_AS_FILE: Constants.NAME + \".saveAsLeoFile\",\n    SAVE_AS_LEOJS: Constants.NAME + \".saveAsLeoJsFile\",\n    CLOSE_FILE: Constants.NAME + \".closeLeoFile\",\n    MINIBUFFER: Constants.NAME + \".minibuffer\",\n    SET_LEO_ID: Constants.NAME + \".setLeoID\",\n    GOTO_LINE_IN_LEO_OUTLINE: Constants.NAME + \".gotoLineInLeoOutline\",\n    IMPORT_INTO_LEO_OUTLINE: Constants.NAME + \".importIntoLeoOutline\",\n    HANDLE_UNL: Constants.NAME + \".handleUnl\",\n    SHORT_GNX_UNL_TO_CLIPBOARD: Constants.NAME + \".shortGnxUnlToClipboard\",\n    FULL_GNX_UNL_TO_CLIPBOARD: Constants.NAME + \".fullGnxUnlToClipboard\",\n    SHORT_LEGACY_UNL_TO_CLIPBOARD: Constants.NAME + \"shortLegacyUnlToClipboard\",\n    FULL_LEGACY_UNL_TO_CLIPBOARD: Constants.NAME + \"fullLegacyUnlToClipboard\",\n    GIT_DIFF: Constants.NAME + \".gitDiff\",\n    TAB_CYCLE_NEXT: Constants.NAME + \".tabCycleNext\",\n    WRITE_AT_FILE_NODES: Constants.NAME + \".writeAtFileNodes\",\n    WRITE_AT_FILE_NODES_FO: Constants.NAME + \".writeAtFileNodesFromOutline\",\n    WRITE_DIRTY_AT_FILE_NODES: Constants.NAME + \".writeDirtyAtFileNodes\",\n    WRITE_DIRTY_AT_FILE_NODES_FO: Constants.NAME + \".writeDirtyAtFileNodesFromOutline\",\n    // At-buttons\n    CLICK_BUTTON: Constants.NAME + \".clickButton\",\n    REMOVE_BUTTON: Constants.NAME + \".removeButton\",\n    GOTO_SCRIPT: Constants.NAME + \".gotoScript\",\n    // Outline Node User Interaction\n    SELECT_NODE: Constants.NAME + \".selectTreeNode\",\n    OPEN_ASIDE: Constants.NAME + \".openAside\", // Opens aside a body pane locked to this gnx & commander.\n    // Goto operations that always finish with focus in outline\n    PAGE_UP: Constants.NAME + \".pageUp\",\n    PAGE_DOWN: Constants.NAME + \".pageDown\",\n    GOTO_FIRST_VISIBLE: Constants.NAME + \".gotoFirstVisible\",\n    GOTO_LAST_VISIBLE: Constants.NAME + \".gotoLastVisible\",\n    GOTO_FIRST_SIBLING: Constants.NAME + \".gotoFirstSibling\",\n    GOTO_LAST_SIBLING: Constants.NAME + \".gotoLastSibling\",\n    GOTO_NEXT_VISIBLE: Constants.NAME + \".gotoNextVisible\",\n    GOTO_PREV_VISIBLE: Constants.NAME + \".gotoPrevVisible\",\n    GOTO_NEXT_MARKED: Constants.NAME + \".gotoNextMarked\",\n    GOTO_NEXT_CLONE: Constants.NAME + \".gotoNextClone\",\n    GOTO_NEXT_CLONE_SELECTION: Constants.NAME + \".gotoNextCloneSelection\",\n    GOTO_NEXT_CLONE_SELECTION_FO: Constants.NAME + \".gotoNextCloneSelectionFromOutline\",\n    CONTRACT_OR_GO_LEFT: Constants.NAME + \".contractOrGoLeft\",\n    EXPAND_AND_GO_RIGHT: Constants.NAME + \".expandAndGoRight\",\n    // Leo Operations\n    UNDO: Constants.NAME + \".undo\", // From command Palette\n    UNDO_FO: Constants.NAME + \".undoFromOutline\", // from button, return focus on OUTLINE\n    REDO: Constants.NAME + \".redo\", // From command Palette\n    REDO_FO: Constants.NAME + \".redoFromOutline\", // from button, return focus on OUTLINE\n    REVERT_TO_UNDO: Constants.NAME + \".revertToUndo\",\n    EXECUTE: Constants.NAME + \".executeScript\",\n    SHOW_BODY: Constants.NAME + \".showBody\",\n    SHOW_OUTLINE: Constants.NAME + \".showOutline\",\n    SHOW_LOG: Constants.NAME + \".showLogPane\",\n    SORT_CHILDREN: Constants.NAME + \".sortChildrenSelection\",\n    SORT_CHILDREN_FO: Constants.NAME + \".sortChildrenSelectionFromOutline\",\n    SORT_SIBLING: Constants.NAME + \".sortSiblingsSelection\",\n    SORT_SIBLING_FO: Constants.NAME + \".sortSiblingsSelectionFromOutline\",\n    CONTRACT_ALL: Constants.NAME + \".contractAll\", // From command Palette\n    CONTRACT_ALL_FO: Constants.NAME + \".contractAllFromOutline\", // from button, return focus on OUTLINE\n    PREV_NODE: Constants.NAME + \".prev\",\n    PREV_NODE_FO: Constants.NAME + \".prevFromOutline\",\n    NEXT_NODE: Constants.NAME + \".next\",\n    NEXT_NODE_FO: Constants.NAME + \".nextFromOutline\",\n    // Commands from tree panel buttons or context: focus on OUTLINE\n    SET_UA: Constants.NAME + \".setUa\",\n    MARK: Constants.NAME + \".mark\",\n    UNMARK: Constants.NAME + \".unmark\",\n    COPY: Constants.NAME + \".copyNode\",\n    CUT: Constants.NAME + \".cutNode\",\n    PASTE: Constants.NAME + \".pasteNode\",\n    PASTE_CLONE: Constants.NAME + \".pasteNodeAsClone\",\n    PASTE_AS_TEMPLATE: Constants.NAME + \".pasteAsTemplate\",\n    DELETE: Constants.NAME + \".delete\",\n    HEADLINE: Constants.NAME + \".editHeadline\",\n    MOVE_DOWN: Constants.NAME + \".moveOutlineDown\",\n    MOVE_LEFT: Constants.NAME + \".moveOutlineLeft\",\n    MOVE_RIGHT: Constants.NAME + \".moveOutlineRight\",\n    MOVE_UP: Constants.NAME + \".moveOutlineUp\",\n    INSERT: Constants.NAME + \".insertNode\",\n    INSERT_CHILD: Constants.NAME + \".insertChildNode\",\n    CLONE: Constants.NAME + \".cloneNode\",\n    PROMOTE: Constants.NAME + \".promote\",\n    DEMOTE: Constants.NAME + \".demote\",\n    REFRESH_FROM_DISK: Constants.NAME + \".refreshFromDisk\",\n    OPEN_AT_LEO_FILE: Constants.NAME + \".openAtLeoFile\",\n    // Commands from keyboard, while focus on BODY (command-palette returns to BODY for now)\n    MARK_SELECTION: Constants.NAME + \".markSelection\",\n    UNMARK_SELECTION: Constants.NAME + \".unmarkSelection\",\n    COPY_SELECTION: Constants.NAME + \".copyNodeSelection\", // Nothing to refresh/focus so no \"FO\" version\n    CUT_SELECTION: Constants.NAME + \".cutNodeSelection\",\n    PASTE_SELECTION: Constants.NAME + \".pasteNodeAtSelection\",\n    PASTE_CLONE_SELECTION: Constants.NAME + \".pasteNodeAsCloneAtSelection\",\n    DELETE_SELECTION: Constants.NAME + \".deleteSelection\",\n    HEADLINE_SELECTION: Constants.NAME + \".editSelectedHeadline\",\n    MOVE_DOWN_SELECTION: Constants.NAME + \".moveOutlineDownSelection\",\n    MOVE_LEFT_SELECTION: Constants.NAME + \".moveOutlineLeftSelection\",\n    MOVE_RIGHT_SELECTION: Constants.NAME + \".moveOutlineRightSelection\",\n    MOVE_UP_SELECTION: Constants.NAME + \".moveOutlineUpSelection\",\n    INSERT_SELECTION: Constants.NAME + \".insertNodeSelection\", // Can be interrupted\n    INSERT_SELECTION_INTERRUPT: Constants.NAME + \".insertNodeSelectionInterrupt\", // Interrupted version\n    INSERT_CHILD_SELECTION: Constants.NAME + \".insertChildNodeSelection\", // Can be interrupted\n    INSERT_CHILD_SELECTION_INTERRUPT: Constants.NAME + \".insertChildNodeSelectionInterrupt\", // Can be interrupted\n    CLONE_SELECTION: Constants.NAME + \".cloneNodeSelection\",\n    PROMOTE_SELECTION: Constants.NAME + \".promoteSelection\",\n    DEMOTE_SELECTION: Constants.NAME + \".demoteSelection\",\n    REFRESH_FROM_DISK_SELECTION: Constants.NAME + \".refreshFromDiskSelection\",\n    OPEN_AT_LEO_FILE_SELECTION: Constants.NAME + \".openAtLeoFileSelection\",\n    // Commands from keyboard, while focus on OUTLINE (no need for COPY_SELECTION)\n    MARK_SELECTION_FO: Constants.NAME + \".markSelectionFromOutline\",\n    UNMARK_SELECTION_FO: Constants.NAME + \".unmarkSelectionFromOutline\",\n    CUT_SELECTION_FO: Constants.NAME + \".cutNodeSelectionFromOutline\",\n    PASTE_SELECTION_FO: Constants.NAME + \".pasteNodeAtSelectionFromOutline\",\n    PASTE_CLONE_SELECTION_FO: Constants.NAME + \".pasteNodeAsCloneAtSelectionFromOutline\",\n    DELETE_SELECTION_FO: Constants.NAME + \".deleteSelectionFromOutline\",\n    HEADLINE_SELECTION_FO: Constants.NAME + \".editSelectedHeadlineFromOutline\",\n    MOVE_DOWN_SELECTION_FO: Constants.NAME + \".moveOutlineDownSelectionFromOutline\",\n    MOVE_LEFT_SELECTION_FO: Constants.NAME + \".moveOutlineLeftSelectionFromOutline\",\n    MOVE_RIGHT_SELECTION_FO: Constants.NAME + \".moveOutlineRightSelectionFromOutline\",\n    MOVE_UP_SELECTION_FO: Constants.NAME + \".moveOutlineUpSelectionFromOutline\",\n    INSERT_SELECTION_FO: Constants.NAME + \".insertNodeSelectionFromOutline\",\n    INSERT_CHILD_SELECTION_FO: Constants.NAME + \".insertChildNodeSelectionFromOutline\",\n    CLONE_SELECTION_FO: Constants.NAME + \".cloneNodeSelectionFromOutline\",\n    PROMOTE_SELECTION_FO: Constants.NAME + \".promoteSelectionFromOutline\",\n    DEMOTE_SELECTION_FO: Constants.NAME + \".demoteSelectionFromOutline\",\n    REFRESH_FROM_DISK_SELECTION_FO: Constants.NAME + \".refreshFromDiskSelectionFromOutline\",\n    OPEN_AT_LEO_FILE_SELECTION_FO: Constants.NAME + \".openAtLeoFileSelectionFromOutline\",\n    HOIST: Constants.NAME + \".hoistNode\",\n    HOIST_SELECTION: Constants.NAME + \".hoistSelection\",\n    HOIST_SELECTION_FO: Constants.NAME + \".hoistSelectionFromOutline\",\n    DEHOIST: Constants.NAME + \".deHoist\",\n    DEHOIST_FO: Constants.NAME + \".deHoistFromOutline\",\n    CHAPTER_NEXT: Constants.NAME + \".chapterNext\",\n    CHAPTER_BACK: Constants.NAME + \".chapterBack\",\n    CHAPTER_MAIN: Constants.NAME + \".chapterMain\",\n    CHAPTER_SELECT: Constants.NAME + \".chapterSelect\",\n    EXTRACT: Constants.NAME + \".extract\",\n    EXTRACT_NAMES: Constants.NAME + \".extractNames\",\n    COPY_MARKED: Constants.NAME + \".copyMarked\",\n    DIFF_MARKED_NODES: Constants.NAME + \".diffMarkedNodes\",\n    MARK_CHANGED_ITEMS: Constants.NAME + \".markChangedItems\",\n    MARK_SUBHEADS: Constants.NAME + \".markSubheads\",\n    UNMARK_ALL: Constants.NAME + \".unmarkAll\",\n    CLONE_MARKED_NODES: Constants.NAME + \".cloneMarkedNodes\",\n    DELETE_MARKED_NODES: Constants.NAME + \".deleteMarkedNodes\",\n    MOVE_MARKED_NODES: Constants.NAME + \".moveMarkedNodes\",\n\n    FIND_QUICK: Constants.NAME + \".findQuick\",\n    FIND_QUICK_SELECTED: Constants.NAME + \".findQuickSelected\",\n    FIND_QUICK_TIMELINE: Constants.NAME + \".findQuickTimeline\",\n    FIND_QUICK_CHANGED: Constants.NAME + \".findQuickChanged\",\n    FIND_QUICK_HISTORY: Constants.NAME + \".history\",\n    FIND_QUICK_MARKED: Constants.NAME + \".markedList\",\n    FIND_QUICK_GO_ANYWHERE: Constants.NAME + \".goAnywhere\",\n    GOTO_NAV_ENTRY: Constants.NAME + \".gotoNav\",\n\n    GOTO_NAV_PREV: Constants.NAME + \".gotoNavPrev\",\n    GOTO_NAV_NEXT: Constants.NAME + \".gotoNavNext\",\n    GOTO_NAV_FIRST: Constants.NAME + \".gotoNavFirst\",\n    GOTO_NAV_LAST: Constants.NAME + \".gotoNavLast\",\n\n    START_SEARCH: Constants.NAME + \".startSearch\",\n    SEARCH_BACKWARD: Constants.NAME + \".searchBackward\",\n    RE_SEARCH: Constants.NAME + \".reSearch\",\n    RE_SEARCH_BACKWARD: Constants.NAME + \".reSearchBackward\",\n    WORD_SEARCH: Constants.NAME + \".wordSearch\",\n    WORD_SEARCH_BACKWARD: Constants.NAME + \".wordSearchBackward\",\n    FIND_ALL: Constants.NAME + \".findAll\",\n    FIND_NEXT: Constants.NAME + \".findNext\",\n    FIND_NEXT_FO: Constants.NAME + \".findNextFromOutline\",\n    FIND_PREVIOUS: Constants.NAME + \".findPrevious\",\n    FIND_PREVIOUS_FO: Constants.NAME + \".findPreviousFromOutline\",\n    FIND_DEF: Constants.NAME + \".findDef\",\n    REPLACE: Constants.NAME + \".replace\",\n    REPLACE_FO: Constants.NAME + \".replaceFromOutline\",\n    REPLACE_THEN_FIND: Constants.NAME + \".replaceThenFind\",\n    REPLACE_THEN_FIND_FO: Constants.NAME + \".replaceThenFindFromOutline\",\n    REPLACE_ALL: Constants.NAME + \".replaceAll\",\n\n    CLONE_FIND_ALL: Constants.NAME + \".cloneFindAll\",\n    CLONE_FIND_ALL_FLATTENED: Constants.NAME + \".cloneFindAllFlattened\",\n    CLONE_FIND_TAG: Constants.NAME + \".cloneFindTag\",\n    CLONE_FIND_MARKED: Constants.NAME + \".cloneFindMarked\",\n    CLONE_FIND_FLATTENED_MARKED: Constants.NAME + \".cloneFindFlattenedMarked\",\n\n    CLONE_FIND_PARENTS: Constants.NAME + \".cloneFindParents\",\n    GOTO_GLOBAL_LINE: Constants.NAME + \".gotoGlobalLine\",\n    TAG_CHILDREN: Constants.NAME + \".tagChildren\",\n    TAG_NODE: Constants.NAME + \".tagNode\",\n    REMOVE_TAG: Constants.NAME + \".removeTag\",\n    REMOVE_TAGS: Constants.NAME + \".removeTags\",\n    SET_FIND_EVERYWHERE_OPTION: Constants.NAME + \".setFindEverywhereOption\",\n    SET_FIND_NODE_ONLY_OPTION: Constants.NAME + \".setFindNodeOnlyOption\",\n    SET_FIND_FILE_ONLY_OPTION: Constants.NAME + \".setFindFileOnlyOption\",\n    SET_FIND_SUBOUTLINE_ONLY_OPTION: Constants.NAME + \".setFindSuboutlineOnlyOption\",\n    TOGGLE_FIND_IGNORE_CASE_OPTION: Constants.NAME + \".toggleFindIgnoreCaseOption\",\n    TOGGLE_FIND_MARK_CHANGES_OPTION: Constants.NAME + \".toggleFindMarkChangesOption\",\n    TOGGLE_FIND_MARK_FINDS_OPTION: Constants.NAME + \".toggleFindMarkFindsOption\",\n    TOGGLE_FIND_REGEXP_OPTION: Constants.NAME + \".toggleFindRegexpOption\",\n    TOGGLE_FIND_WORD_OPTION: Constants.NAME + \".toggleFindWordOption\",\n    TOGGLE_FIND_SEARCH_BODY_OPTION: Constants.NAME + \".toggleFindSearchBodyOption\",\n    TOGGLE_FIND_SEARCH_HEADLINE_OPTION: Constants.NAME + \".toggleFindSearchHeadlineOption\",\n    SET_BODY_WRAP_SETTINGS: Constants.NAME + \".setBodyWrapSettings\",\n    SET_ENABLE_PREVIEW: Constants.NAME + \".setEnablePreview\",\n    CLEAR_CLOSE_EMPTY_GROUPS: Constants.NAME + \".clearCloseEmptyGroups\",\n};\n\n",
    "felix.20251210234420.17": "/**\n * Leo command names that are called from vscode's gui/menu/buttons/keybindings triggers\n */\npublic static LEO_COMMANDS = {\n\n    // * File Commands\n    // NEW: 'new', // newLeoFile used instead\n    // OPEN_OUTLINE: 'open_outline', // openLeoFile used instead\n    WRITE_AT_FILE_NODES: 'write-at-file-nodes',\n    WRITE_DIRTY_AT_FILE_NODES: 'write-dirty-at-file-nodes',\n    REVERT: 'revert',\n    // * More Commands\n    GOTO_GLOBAL_LINE: \"goto-global-line\",\n    SET_UA: 'set-ua',\n\n    // * Import Export\n    IMPORT_ANY_FILE: \"import-file\",\n    READ_FILE_INTO_NODE: \"read-file-into-node\",\n\n    EXPORT_HEADLINES: \"export-headlines\",\n    FLATTEN_OUTLINE: \"flatten-outline\",\n    OUTLINE_TO_CWEB: \"outline-to-cweb\",\n    OUTLINE_TO_NOWEB: \"outline-to-noweb\",\n    REMOVE_SENTINELS: \"remove-sentinels\",\n    WEAVE: \"weave\",\n    WRITE_FILE_FROM_NODE: \"write-file-from-node\",\n\n    // * Search operations\n    START_SEARCH: \"start-search\",\n    FIND_ALL: \"find-all\",\n    // FIND_NEXT: \"!find_next\",\n    // FIND_PREVIOUS: \"!find_previous\",\n    FIND_DEF: \"find-def\",\n    // REPLACE: \"!replace\",\n    // REPLACE_THEN_FIND: \"!replace_then_find\",\n    REPLACE_ALL: \"change-all\",\n\n    SET_FIND_EVERYWHERE_OPTION: \"set-find-everywhere\",\n    SET_FIND_NODE_ONLY_OPTION: \"set-find-node-only\",\n    SET_FIND_FILE_ONLY_OPTION: \"set-find-file-only\",\n    SET_FIND_SUBOUTLINE_ONLY_OPTION: \"set-find-suboutline-only\",\n    TOGGLE_FIND_IGNORE_CASE_OPTION: \"toggle-find-ignore-case-option\",\n    TOGGLE_FIND_MARK_CHANGES_OPTION: \"toggle-find-mark-changes-option\",\n    TOGGLE_FIND_MARK_FINDS_OPTION: \"toggle-find-mark-finds-option\",\n    TOGGLE_FIND_REGEXP_OPTION: \"toggle-find-regex-option\",\n    TOGGLE_FIND_WORD_OPTION: \"toggle-find-word-option\",\n    TOGGLE_FIND_SEARCH_BODY_OPTION: \"toggle-find-in-body-option\",\n    TOGGLE_FIND_SEARCH_HEADLINE_OPTION: \"toggle-find-in-headline-option\",\n\n    SEARCH_BACKWARD: \"search-backward\",\n    RE_SEARCH: \"re-search\",\n    RE_SEARCH_BACKWARD: \"re-search-backward\",\n    WORD_SEARCH: \"word-search\",\n    WORD_SEARCH_BACKWARD: \"word-search-backward\",\n\n    TAG_NODE: \"tag-node\",\n    TAG_CHILDREN: \"tag-children\",\n    REMOVE_TAG: \"remove-tag\",\n    REMOVE_ALL_TAGS: \"remove-all-tags\",\n\n    // * Undo Operations\n    UNDO: \"undo\",\n    REDO: \"redo\",\n    // * Tree Building\n    EXECUTE_SCRIPT: \"execute-script\",\n    REFRESH_FROM_DISK: \"refresh-from-disk\",\n    OPEN_AT_LEO_FILE: \"open-at-leo-file\",\n    GIT_DIFF: \"git-diff\",\n    // * Outline from body text\n    EXTRACT: \"extract\",\n    EXTRACT_NAMES: \"extract-names\",\n    // * Hoist Operations\n    HOIST_PNODE: \"hoist\",\n    DEHOIST: \"de-hoist\",\n    CHAPTER_NEXT: \"chapter-next\",\n    CHAPTER_BACK: \"chapter-back\",\n    CHAPTER_SELECT: \"chapter-select\",\n    CHAPTER_MAIN: \"chapter-select-main\",\n    // * History Navigation\n    GOTO_PREV_HISTORY: \"goto-prev-history-node\",\n    GOTO_NEXT_HISTORY: \"goto-next-history-node\",\n    // * Goto & Folding\n    PAGE_UP: \"tree-page-up\",\n    PAGE_DOWN: \"tree-page-down\",\n    GOTO_FIRST_VISIBLE: \"goto-first-visible-node\",\n    GOTO_LAST_VISIBLE: \"goto-last-visible-node\",\n    GOTO_FIRST_SIBLING: \"goto-first-sibling\",\n    GOTO_LAST_SIBLING: \"goto-last-sibling\",\n    GOTO_NEXT_VISIBLE: \"goto-next-visible\",\n    GOTO_PREV_VISIBLE: \"goto-prev-visible\",\n    GOTO_NEXT_MARKED: \"goto-next-marked\",\n    // GOTO_PREV_MARKED: \"goto-prev-marked\", // ! Not in Leo's menu nor LeoJS package.json.\n    GOTO_NEXT_CLONE: \"goto-next-clone\",\n    CONTRACT_OR_GO_LEFT: \"contract-or-go-left\",\n    EXPAND_AND_GO_RIGHT: \"expand-and-go-right\",\n    CONTRACT_ALL: \"contract-all\",\n    // * Mark Operations\n    TOGGLE_MARK: \"toggle-mark\",\n    COPY_MARKED: \"copy-marked-nodes\",\n    DIFF_MARKED_NODES: \"diff-marked-nodes\",\n    MARK_CHANGED_ITEMS: \"mark-changed-items\",\n    MARK_SUBHEADS: \"mark-subheads\",\n    UNMARK_ALL: \"unmark-all\",\n    CLONE_MARKED_NODES: \"clone-marked-nodes\",\n    DELETE_MARKED_NODES: \"delete-marked-nodes\",\n    MOVE_MARKED_NODES: \"move-marked-nodes\",\n    // * Clipboard Operations\n    COPY_PNODE: \"copy-node\",\n    CUT_PNODE: \"cut-node\",\n    PASTE_PNODE: \"async-paste-node\",\n    PASTE_CLONE_PNODE: \"async-paste-retaining-clones\",\n    PASTE_AS_TEMPLATE: \"async-paste-as-template\",\n    // * Outline Editing\n    DELETE_PNODE: \"delete-node\",\n    MOVE_PNODE_DOWN: \"move-outline-down\",\n    MOVE_PNODE_LEFT: \"move-outline-left\",\n    MOVE_PNODE_RIGHT: \"move-outline-right\",\n    MOVE_PNODE_UP: \"move-outline-up\",\n    INSERT_PNODE: \"insert-node\",\n    INSERT_CHILD_PNODE: \"insert-child\",\n    CLONE_PNODE: \"clone-node\",\n    // * Marshalling Operations\n    PROMOTE_PNODE: \"promote\",\n    DEMOTE_PNODE: \"demote\",\n    SORT_CHILDREN: \"sort-children\",\n    SORT_SIBLINGS: \"sort-siblings\",\n    // * Clone-find functionality\n\n    CLONE_FIND_ALL_FLATTENED: \"cff\",\n\n    CLONE_FIND_FLATTENED_MARKED: \"cffm\",\n    CLONE_FIND_TAG: \"cft\",\n    CLONE_FIND_ALL: \"cfa\",\n    CLONE_FIND_MARKED: \"cfam\",\n    CLONE_FIND_PARENTS: \"clone-find-parents\",\n};\n\n",
    "felix.20251210234420.18": "/**\n * List of command names for both categories of possible offsets when keeping selection.\n */\npublic static OLD_POS_OFFSETS = {\n    DELETE: [\"cut-node\", \"delete-node\"],\n    ADD: [\"clone-node\", \"async-paste-node\", \"async-paste-retaining-clones\"]\n};\n\n",
    "felix.20251210234420.19": "/**\n * * Overridden 'good' minibuffer command name strings\n */\npublic static MINIBUFFER_OVERRIDDEN_NAMES: { [key: string]: string } = {\n    'paste-node': 'async-paste-node',\n    'paste-retaining-clones': 'async-paste-retaining-clones',\n    'paste-as-template': 'async-paste-as-template',\n    'insert-child': 'async-insert-child',\n    'insert-node': 'async-insert-node',\n    'insert-as-first-child': 'async-insert-as-first-child',\n    'insert-as-last-child': 'async-insert-as-last-child',\n    'insert-node-before': 'async-insert-node-before',\n};\n\n",
    "felix.20251210234451.1": "@language typescript\n@tabwidth -4\n\n// ambient module declaration for https://www.npmjs.com/package/date-format-lite\ndeclare module \"date-format-lite\" { }\n\n// date-format-lite augments built-in Date\ninterface Date {\n    format: (format?: string) => string;\n    masks: { default: string };\n}\n",
    "felix.20251211000427.1": "import { Constants } from \"./constants\";\n// import { Position } from \"./core/leoNodes\";\ntype Position = any;\n\n// String and other types/structures helper functions, along with common vscode API calls\n\n@language typescript\n@tabwidth -4\n@others\n",
    "felix.20251211212644.1": "/**\n * Throttle function execution to limit how often it can be called\n * @param func Function to throttle\n * @param limit Minimum time between calls in milliseconds\n * @returns Throttled version of the function\n */\nexport function throttle<T extends any[]>(func: (...args: T) => void, limit: number) {\n    let lastCall = 0;\n    let timeout: ReturnType<typeof setTimeout>;\n\n    return (...args: T): void => {\n        const now = Date.now();\n        if (timeout) {\n            clearTimeout(timeout);\n        }\n        if (now - lastCall >= limit) {\n            lastCall = now;\n            func(...args);\n        } else {\n            timeout = setTimeout(() => {\n                lastCall = Date.now();\n                func(...args);\n            }, limit - (now - lastCall));\n        }\n    };\n}\n",
    "felix.20251211212701.1": "/**\n * Safely access localStorage.getItem with error handling\n */\nexport function safeLocalStorageGet(key: string): string | null {\n    try {\n        return localStorage.getItem(key);\n    } catch (e) {\n        return null;\n    }\n}\n",
    "felix.20251211212717.1": "/**\n * Safely access localStorage.setItem with error handling\n */\nexport function safeLocalStorageSet(key: string, value: string): void {\n    try {\n        localStorage.setItem(key, value);\n    } catch (e) {\n        // ignore\n    }\n}\n",
    "felix.20251211212732.1": "/**\n * Prevent default event behavior - useful as event handler\n */\nexport function preventDefault(e: Event): void {\n    e.preventDefault();\n}\n",
    "felix.20251211212753.1": "/**\n * Get the text node and offset at a given global character index within a root node\n */\nexport function getTextNodeAtIndex(root: Node, index: number): { node: Node; offset: number } | null {\n    const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, null);\n    let currentNode = walker.nextNode();\n    let remaining = index;\n\n    while (currentNode) {\n        const len = currentNode!.nodeValue!.length;\n        if (remaining <= len) {\n            return { node: currentNode, offset: remaining };\n        }\n        remaining -= len;\n        currentNode = walker.nextNode();\n    }\n    return null;\n}\n",
    "felix.20251211212824.1": "/**\n * Get the global character offset within a root node for a given text node and offset\n */\nexport function getGlobalOffset(root: Node, container: Node, offset: number): number {\n    const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, null);\n    let total = 0;\n    let current: Node | null = walker.nextNode();\n\n    while (current) {\n        if (current === container) {\n            return total + offset;\n        }\n        total += current.nodeValue!.length;\n        current = walker.nextNode();\n    }\n    return total;\n}\n",
    "felix.20251211212832.1": "/**\n * Read all entries from a directory handle, returning an array of name/kind/handle objects\n */\nexport async function readDirectory(dirHandle: FileSystemDirectoryHandle): Promise<Array<{ name: string; kind: 'file' | 'directory'; handle: FileSystemHandle }>> {\n    const entries = [];\n    for await (const [name, handle] of dirHandle.entries()) {\n        entries.push({\n            name,\n            kind: handle.kind, // \"file\" or \"directory\"\n            handle\n        });\n    }\n    return entries;\n}\n",
    "felix.20251211000427.2": "/**\n * * window.performace.now browser/node crossover utility\n */\nexport function performanceNow(): number {\n    const w_now = process.hrtime();\n    const [w_secs, w_nanosecs] = w_now;\n    return w_secs * 1000 + Math.floor(w_nanosecs / 1000000);\n}\n\n",
    "felix.20251211000427.5": "/**\n * * Unique numeric Id\n */\nvar uniqueId: number = 0;\n\n",
    "felix.20251211000427.6": "/**\n * * Get new uniqueID\n */\nexport function getUniqueId(): string {\n    const id = uniqueId++;\n    return id.toString();\n}\n\n",
    "felix.20251211000427.7": "export function getNonce(): string {\n    let text = '';\n    const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    for (let i = 0; i < 32; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n    return text;\n}\n\n",
    "felix.20251211000427.8": "/**\n * * Build a string for representing a number that's 2 digits wide, padding with a zero if needed\n * @param p_number Between 0 and 99\n * @returns a 2 digit wide string representation of the number, left padded with zeros as needed.\n */\nexport function padNumber2(p_number: number): string {\n    return (\"0\" + p_number).slice(-2);\n}\n\n",
    "felix.20251211000427.16": "/**\n * Convert Leo's internal filetype descriptions array\n * to vscode's option format for open/save dialogs.\n */\nexport function convertLeoFiletypes(p_filetypes: [string, string][]): { [name: string]: string[] } {\n    /*\n        from :\n            [\n                [\"\", \"\"],\n                [\"Leo files\", \"*.leojs *.leo *.db\"]\n                ['C/C++ files', '*.c'],\n                ['C/C++ files', '*.cpp'],\n                ['C/C++ files', '*.h'],\n                ['C/C++ files', '*.hpp'],\n                ['Images', '*.png *.jpg'],\n                ['TypeScript', '*.ts *.tsx']\n            ],\n\n        to :\n        {\n            'Leo files': ['leojs', 'leo', 'db'],\n            'C/C++ files': ['c', 'cpp', 'h', 'hpp']\n            'Images': ['png', 'jpg']\n            'TypeScript': ['ts', 'tsx']\n        }\n    */\n\n    const w_types: { [name: string]: string[] } = {};\n    p_filetypes.forEach(type => {\n        const typeName = type[0];\n        if (!typeName) {\n            return; // Skip empty type names\n        }\n\n        // Extract extensions from current entry\n        const extensions = type[1].split(\" \").map((p_entry) => {\n            return p_entry.startsWith(\"*.\") ? p_entry.substring(2) : p_entry;\n        }).filter(ext => ext); // Filter out empty strings\n\n        // If type already exists, merge extensions, otherwise create new entry\n        if (w_types[typeName]) {\n            // Add only extensions that don't already exist in the array\n            extensions.forEach(ext => {\n                if (!w_types[typeName]!.includes(ext)) {\n                    w_types[typeName]!.push(ext);\n                }\n            });\n        } else {\n            w_types[typeName] = extensions;\n        }\n    });\n    return w_types;\n}\n",
    "felix.20251211000427.17": "/**\n * * Returns milliseconds between the p_start process.hrtime tuple and p_end (or current call to process.hrtime)\n * @param p_start starting process.hrtime to subtract from p_end or current immediate time\n * @param p_end optional end process.hrtime (or immediate time)\n * @returns number of milliseconds passed since the given start hrtime\n */\nexport function getDurationMs(p_start: [number, number], p_end?: [number, number]): number {\n    if (!p_end) {\n        p_end = process.hrtime();\n    }\n    const w_secs = p_end[0] - p_start[0];\n    const w_nanosecs = p_end[1] - p_start[1];\n\n    return w_secs * 1000 + Math.floor(w_nanosecs / 1000000);\n}\n\n",
    "felix.20251211000427.18": "/**\n * Milliseconds converted into seconds, limiting to two decimals. \n */\nexport function getDurationSeconds(p_start: [number, number], p_end?: [number, number]): number {\n    return parseFloat((getDurationMs(p_start, p_end) / 1000).toFixed(2));\n}\n",
    "felix.20251211000427.19": "/**\n * * Extracts the file name from a full path, such as \"foo.bar\" from \"/abc/def/foo.bar\"\n * @param p_path Full path such as \"/var/drop/foo/boo/moo.js\" or \"C:\\Documents and Settings\\img\\recycled log.jpg\"\n * @returns file name string such as \"moo.js\" or \"recycled log.jpg\"\"\n */\nexport function getFileFromPath(p_path: string): string {\n    return p_path.replace(/^.*[\\\\\\/]/, '');\n}\n\n",
    "felix.20251211000427.20": "export function isAlphaNumeric(str: string): boolean {\n    let code: number;\n    let i: number;\n    let len: number;\n    for (i = 0, len = str.length; i < len; i++) {\n        code = str.charCodeAt(i);\n        if (!(code > 47 && code < 58) && // numeric (0-9)\n            !(code > 64 && code < 91) && // upper alpha (A-Z)\n            !(code > 96 && code < 123) // lower alpha (a-z)\n        ) {\n            return false;\n        }\n    }\n    return true;\n};\n",
    "felix.20251211000427.21": "/**\n * * Checks if a node would become dirty if it were to now have body content at all\n * @param p_node LeoNode from vscode's outline\n * @param p_newHasBody Flag to signify presence of body content, to be compared with its current state\n * @returns True if it would change the icon with actual body content, false otherwise\n */\nexport function isIconChangedByEdit(p_node: Position, p_newHasBody: boolean): boolean {\n    // hasBody can be undefined so force boolean.\n    if (!p_node.isDirty() || (!!p_node.bodyString().length === !p_newHasBody)) {\n        return true;\n    }\n    return false;\n}\n\n",
    "felix.20251211000427.22": "/**\n * * Checks if a string is formatted as a valid rrggbb color code.\n * @param p_hexString hexadecimal 6 digits string, without leading '0x'\n * @returns True if the string is a valid representation of an hexadecimal 6 digit number\n */\nexport function isHexColor(p_hexString: string): boolean {\n    return typeof p_hexString === 'string'\n        && p_hexString.length === 6\n        && !isNaN(Number('0x' + p_hexString));\n}\n\n",
    "felix.20251211000618.1": "// import { Position } from \"./core/leoNodes\";\n// import { RClick } from \"./core/mod_scripting\";\n// For now, these imports are commented out until implemented.\ntype RClick = any;\ntype Position = any;\n\n@language typescript\n@tabwidth -4\n@others\n",
    "felix.20251211213133.1": "export interface TreeNode {\n    gnx: number;\n    parent?: TreeNode;\n    children?: TreeNode[];\n    toggled?: boolean; // To track if node was toggled (expanded/collapsed) since last render\n}",
    "felix.20251211213147.1": "export interface NodeData {\n    headString: string;\n    bodyString: string;\n    icon?: number; // Bitmask for icons: hasBody: 1, isMarked: 2, isClone: 4, isDirty: 8\n}",
    "felix.20251211213151.1": "export interface FlatRow {\n    label: string;\n    depth: number;\n    toggled: boolean; // Will make it render with toggled class\n    hasChildren: boolean;\n    isExpanded: boolean;\n    node: TreeNode;\n    isSelected: boolean;\n    isAncestor: boolean;      // Is ancestor of selected node\n    isInitialFind: boolean;   // Used for find scope highlighting\n    icon: number;             // Icon number for the node\n}",
    "felix.20251211213155.1": "export interface MenuEntry {\n    label: string;\n    action?: string;\n    entries?: MenuEntry[];\n}",
    "felix.20251211213200.1": "export interface FileStat {\n    type: 'file' | 'directory';\n    size?: number;\n    mtime?: number;\n}\n",
    "felix.20251211213205.1": "export interface FilePath {\n    name: string;\n    handle: FileSystemDirectoryHandle;\n}",
    "felix.20251211213209.1": "export interface OpenDialogOptions {\n    defaultUri?: string; // Default URI to open\n    openLabel?: string; // A human-readable string for the open button.\n    title?: string; // Dialog title.\n}",
    "felix.20251211213213.1": "export interface SaveDialogOptions {\n    defaultUri?: string; // Default URI to open\n    saveLabel?: string; // A human-readable string for the save button.\n    title?: string; // Dialog title.\n}",
    "felix.20251211213217.1": "export interface InputDialogOptions {\n    title: string;\n    prompt: string;\n    placeholder?: string;\n    value?: string;\n}",
    "felix.20251211000618.2": "/**\n * * Types of the various JSON configuration keys such as treeKeepFocus, defaultReloadIgnore, etc.\n */\nexport interface ConfigMembers {\n    checkForChangeExternalFiles: string;\n    defaultReloadIgnore: string;\n    sessionPerWorkspace: boolean;\n    leoTreeBrowse: boolean;\n    treeKeepFocus: boolean;\n    treeKeepFocusWhenAside: boolean;\n\n    collapseAllShortcut: boolean;\n    activityViewShortcut: boolean;\n    goAnywhereShortcut: boolean;\n\n    showUnlOnStatusBar: boolean,\n\n    treeInExplorer: boolean;\n\n    showFileOnOutline: boolean;\n    showHoistDehoistOnOutline: boolean;\n    showPrevNextOnOutline: boolean;\n    showPromoteDemoteOnOutline: boolean;\n    showRecentFilesOnOutline: boolean;\n    showSettingsOnOutline: boolean;\n    showShowLogOnOutline: boolean;\n    showUndoRedoOnOutline: boolean;\n\n    showEditOnNodes: boolean;\n    showAddOnNodes: boolean;\n    showMarkOnNodes: boolean;\n    showCloneOnNodes: boolean;\n    showCopyOnNodes: boolean;\n\n    // showEditionOnBody: boolean; // clone delete insert(s)\n    // showClipboardOnBody: boolean; // cut copy paste(s)\n    // showPromoteOnBody: boolean; // promote demote\n    // showExecuteOnBody: boolean; // extract(s)\n    // showExtractOnBody: boolean;\n    // showImportOnBody: boolean;\n    // showRefreshOnBody: boolean;\n    // showHoistOnBody: boolean;\n    // showMarkOnBody: boolean;\n    // showSortOnBody: boolean;\n\n    invertNodeContrast: boolean;\n    leoID: string;\n}\n\n",
    "felix.20251211000618.3": "/**\n * * Structure for configuration settings changes used along with welcome/settings webview.\n */\nexport interface ConfigSetting {\n    code: string;\n    value: any;\n}\n\n",
    "felix.20251211000618.4": "/**\n * * Location of focus to be set when current/last command is resolved\n */\nexport const enum Focus {\n    NoChange = 0, // Stays on goto pane, or other current panel.\n    Body, // Forces body to appear, refresh leaves focus on body.\n    Outline, // Forces outline to appear, refresh leaves focus on Outline.\n    Goto\n}\n\n",
    "felix.20251211000618.5": "/**\n * * When refreshing the outline and getting to Leo's selected node\n */\nexport const enum RevealType {\n    NoReveal = 0, // Re-use the old treeId with \"NoReveal\" for the selected node.\n    Reveal,\n    RevealSelect,\n    RevealSelectFocus\n}\n\n",
    "felix.20251211000618.6": "/**\n * * Required Refresh Dictionary of \"elements to refresh\" flags\n */\nexport interface ReqRefresh {\n    node?: boolean; // Reveal received selected node (Navigation only, no tree change)\n    tree?: boolean; // Tree needs refresh\n    body?: boolean; // Body needs refresh\n    excludeDetached?: boolean; // Body needs refresh EXCLUDE DETACHED\n\n    scroll?: boolean; // Body needs to set and reveal text selection\n\n    states?: boolean; // Currently opened tree view states needs refresh:\n    // changed, canUndo, canRedo, canGoBack, canGoNext, canDemote, canPromote, \n    // canHoist, canDehoist, inChapter, topHoistChapter\n\n    buttons?: boolean; // Buttons needs refresh\n    documents?: boolean; // Documents needs refresh\n    goto?: boolean; // Goto pane needs refresh\n}\n\n",
    "felix.20251211000618.7": "export interface CommandOptions {\n    node?: Position, // facultative, precise node onto which the command is run (also see p_keepSelection)\n    refreshType: ReqRefresh, // Object containing flags for sections needing to refresh after command ran\n    finalFocus: Focus, // final focus placement\n    keepSelection?: boolean, // flag to bring back selection on the original node\n    isNavigation?: boolean // Navigation commands force-show the body and outline\n}\n\n",
    "felix.20251211000618.8": "/**\n * * LeoBody virtual file time information object\n */\nexport interface BodyTimeInfo {\n    ctime: number;\n    mtime: number;\n    lastBodyLength?: number;\n}\n\n",
    "felix.20251211000618.9": "/**\n * * General state flags for UI representation and controls visibility.\n */\nexport interface LeoPackageStates {\n    changed: boolean; // Leo document has changed (is dirty)\n    canUndo: boolean; // Leo document can undo the last operation done\n    canRedo: boolean; // Leo document can redo the last operation 'undone'\n    canGoBack: boolean; // Has history\n    canGoNext: boolean; // Has used goBack at least once\n    canDemote: boolean; // Currently selected node can have its siblings demoted\n    canPromote: boolean; // Currently selected node can have its children promoted\n    canDehoist: boolean; // Leo Document is currently hoisted and can be de-hoisted\n    canHoist: boolean; // Selected node is not the first top node already root\n    topIsChapter: boolean; // Top of the hoisted outline is an @chapter node\n}\n\n",
    "felix.20251211000618.10": "/**\n * * Leo document structure used in the 'Opened Leo Documents' tree view provider\n */\nexport interface LeoDocument {\n    name: string;\n    index: number;\n    changed: boolean;\n    selected: boolean;\n}\n\n",
    "felix.20251211000618.11": "/**\n * * Leo '@button' structure used in the '@buttons' tree view provider\n */\nexport interface LeoButton {\n    name: string;\n    index: number;\n    rclicks?: RClick[];\n}\n\n",
    "felix.20251211000618.12": "export type TGotoTypes = \"tag\" | \"headline\" | \"body\" | \"parent\" | \"generic\";\n\n",
    "felix.20251211000618.13": "export interface LeoGoto {\n    key: number; // id from python\n    h: string;\n    t: TGotoTypes;\n}\n\n",
    "felix.20251211000618.14": "export const enum LeoGotoNavKey {\n    prev = 0,\n    next,\n    first,\n    last\n}\n\n",
    "felix.20251211000618.15": "/**\n * * Enum type for the search scope radio buttons of the find panel.\n */\nexport const enum LeoSearchScope {\n    entireOutline = 0,\n    subOutlineOnly,\n    nodeOnly,\n    fileOnly\n}\n\n",
    "felix.20251211000618.16": "/**\n * * Search settings structure for use with the 'find' webview\n */\nexport interface LeoSearchSettings {\n    // Nav options\n    navText: string;\n    isTag: boolean;\n    showParents: boolean;\n    searchOptions: number;\n    // Find/change strings...\n    findText: string;  // find_text\n    replaceText: string; // change_text\n    // Find options...\n    wholeWord: boolean;\n    ignoreCase: boolean;\n    regExp: boolean;\n    markFinds: boolean;\n    markChanges: boolean;\n    searchHeadline: boolean;\n    searchBody: boolean;\n    searchScope: LeoSearchScope; // 0, 1 or 2 for outline, sub-outline, or node.\n}\n\n",
    "felix.20251211000618.17": "/**\n * * Leo's GUI search settings internal structure\n */\nexport interface LeoGuiFindTabManagerSettings {\n    // Nav options\n    nav_text: string;\n    is_tag: boolean;\n    show_parents: boolean;\n    search_options: number;\n    //Find/change strings...\n    find_text: string,\n    change_text: string,\n    // Find options...\n    ignore_case: boolean,\n    mark_changes: boolean,\n    mark_finds: boolean,\n    node_only: boolean,\n    file_only: boolean,\n    pattern_match: boolean,\n    search_body: boolean,\n    search_headline: boolean,\n    suboutline_only: boolean,\n    whole_word: boolean\n}\n\n",
    "felix.20251211000618.19": "/**\n * * LeoBody virtual file time information object\n */\nexport interface BodyTimeInfo {\n    ctime: number;\n    mtime: number;\n}\n\n",
    "felix.20251211000618.20": "/**\n * * Body position\n * Used in BodySelectionInfo interface\n */\nexport interface BodyPosition {\n    line: number;\n    col: number;\n}\n\n",
    "felix.20251211000618.21": "/**\n * * LeoBody cursor active position and text selection state, along with gnx\n */\nexport interface BodySelectionInfo {\n    gnx: string;\n    // scroll is stored as-is as the 'scrollBarSpot' in Leo\n    // ! TEST scroll as single number only (for Leo vertical scroll value)\n    scroll: number;\n    // scroll: {\n    //     start: BodyPosition;\n    //     end: BodyPosition;\n    // }\n    insert: BodyPosition;\n    start: BodyPosition;\n    end: BodyPosition;\n}\n\n",
    "felix.20251211000618.22": "/**\n * * Parameter structure used in the 'runSaveFileDialog' equivalent when asking user input\n */\nexport interface showSaveAsDialogParameters {\n    \"initialFile\": string;\n    \"title\": string;\n    \"message\": string;\n    \"filetypes\": string[];\n}\n\n",
    "felix.20251211000618.23": "/**\n * * Parameter structure used in the 'runAskYesNoDialog' equivalent when asking user input\n */\nexport interface runAskYesNoDialogParameters {\n    \"ask\": string;\n    \"message\": string;\n    \"yes_all\": boolean;\n    \"no_all\": boolean;\n}\n\n",
    "felix.20251211000618.24": "/**\n * * Parameter structure used in the 'runAskOkDialog' equivalent when showing a warning\n */\nexport interface runWarnMessageDialogParameters {\n    \"warn\": string;\n    \"message\": string;\n}\n\n",
    "felix.20251211000618.25": "/**\n * * Parameter structure for non-blocking info message about detected file changes\n */\nexport interface runInfoMessageDialogParameters {\n    \"message\": string;\n}\n\n",
    "felix.20251211000618.26": "/**\n * * Used in showAskModalDialog to get answer from user interaction\n */\nexport interface AskMessageItem {\n    label: string;\n    description?: string;\n    value: string;\n}\n\n",
    "felix.20251211000618.27": "/**\n * * Used in switch Leo document to get answer from user interaction\n */\nexport interface ChooseDocumentItem {\n    value: number;\n    label: string;\n    description?: string;\n}\n\n",
    "felix.20251211000618.28": "/**\n * * Used to select a button's rclick by index\n */\nexport interface ChooseRClickItem {\n    index: number;\n    rclick?: RClick;\n    label: string;\n    description?: string;\n}\n\n",
    "felix.20251211000618.29": "/**\n * * Used by the minibuffer command pallette\n */\nexport interface MinibufferCommand {\n    func: string;\n    label: string;\n    description?: string;\n}\n\n",
    "felix.20251211000618.30": "export type UnlType = 'shortGnx' | 'fullGnx' | 'shortLegacy' | 'fullLegacy';\n\n",
    "felix.20251207200255.1": "# This file contains almost all of LeoJS sources.\n\n# See the \"About this file\" node for important notes.\n",
    "ekr.20140902032918.18591": "@language rest\n@wrap\n\nLeo uses a model/view/controller architecture.\n\n- Controller: The Commands class and its helpers in leoCommands.py and leoEditCommands.py.\n\n- Model: The VNode and Position classes in leoNodes.py.\n\n- View: The gui-independent base classes are in the node \"Gui Base Classes\". The Qt-Specific subclasses are in the node \"Qt gui\".\n\n**Important**: The general organization of these classes have changed hardly at all in Leo's 20+ year history.  The reason is that what each class does is fairly obvious.  How the gets the job done may have changed drastically, but *that's an internal implementation detail of the class itself*.  This is the crucial design principle that allows Leo's code to remain stable.  *Classes do not know or meddle in the internal details of other classes*.  As a result, nobody, including EKR, needs to remember internal details.\n\n",
    "ekr.20140831085423.18639": "Here is what you *must know* to understand Leo's core:\n\n1. A **widget** is an actual Qt widget.\n\nLeo's core seldom accesses widgets directly.  Instead...\n\n2. A **wrapper class** defines a standard api that hides the details\n   of the underlying gui **text** widgets.\n\nLeo's core uses this api almost exclusively. That is, Leo's core code treats wrappers *as if* they were only text widgets there are!\n\nThere is, however, a back door for (hopefully rare!) special cases. All wrapper classes define an official ``widget`` ivar, so core or plugin code can gain access to the real Qt widget using wrapper.widget. Searching for wrapper.widget will find all gui-dependent snippets of code in Leo's core.\n",
    "ekr.20140831085423.18630": "This outline contains all of Leo's core source code.\n\nLeo's code uses the following conventions throughout:\n\nc:  a commander.\nch: a character.\nd:  a dict.\nf:  an open file.\nfn: a file name.\ng:  the leoGlobals module.\ni, j, k: indices into a string.\np:  a Position.\ns:  a string.\nt:  a text widget.\nu:  an undoer.\nw:  a gui widget.\nv:  a Vnode\nz:  a local temp.\n\nIn more limited contexts, the following conventions apply:\n\nsi:     a g.ShortcutInfo object.\nks:     a g.KeyStroke object\nstroke: a KeyStroke object.\n\nbtw:    leoFrame.BaseTextWrapper\nstw:    leoFrame.StringTextWrapper\n\nbqtw:   qt_text.BaseQTextWrapper\nlqtb:   qt_text.LeoQTextBrowser\nqhlw:   qt_text.QHeadlineWrapper\nqmbw:   qt_text.QMinibufferWrapper\nqlew:   qt_text.QLineEditWrapper\nqsciw:  qt_text.QScintiallaWrapper\nqtew:   qt_text.QTextEditWrapper",
    "ekr.20140831085423.18631": "The following 'official' ivars will always exist:\n\nc.frame                 The frame containing the log,body,tree, etc.\nc.frame.body            The body pane.\nc.frame.body.widget     The gui widget for the body pane.\nc.frame.body.wrapper    The high level interface for the body widget.\nc.frame.iconBar         The icon bar.\nc.frame.log             The log pane.\nc.frame.log.widget      The gui widget for the log pane.\nc.frame.log.wrapper     The high-level inteface for the log pane.\nc.frame.tree            The tree pane.\n\nThe following were official ivars that no longer exist:\n\nc.frame.body.bodyCtrl   Use c.frame.body.wrapper instead.\nc.frame.log.logCtrl     Use c.frame.log.wrapper instead.\n",
    "felix.20251213133753.2": "<< imports >>\n<< types >>\n@others\n@language typescript\n@tabwidth -4\n",
    "felix.20251213133753.3": "import * as g from './leoGlobals';\nimport { Commands } from './leoCommands';\nimport { ISettings, LeoFind } from './leoFind';\n\n",
    "felix.20251213133753.4": "export interface LeoFindTabMAnagerSettings {\n    // Find/change strings...\n    find_text: string;\n    change_text: string;\n    // Find options...\n    file_only: boolean;\n    ignore_case: boolean;\n    mark_changes: boolean;\n    mark_finds: boolean;\n    node_only: boolean;\n    pattern_match: boolean;\n    search_body: boolean;\n    search_headline: boolean;\n    suboutline_only: boolean;\n    whole_word: boolean;\n}\n",
    "felix.20251213133753.5": "/**\n * Simulate a QCheckBox.\n */\nexport class StringCheckBox {\n    private label: string;\n    private name: string;\n    private value: boolean;\n\n    constructor(name: string, label = '') {\n        this.label = label;\n        this.name = name;\n        this.value = true;\n    }\n\n    public checkState(): boolean {\n        return this.value;\n    }\n    public isChecked(): boolean {\n        return this.checkState();\n    }\n\n    public objectName(): string {\n        return this.name;\n    }\n    public setCheckState(value: boolean): void {\n        this.value = value;\n    }\n    public toggle(): void {\n        this.value = !this.value;\n    }\n}\n\n",
    "felix.20251213133753.6": "/**\n * Simulate a QRadioButton.\n */\nexport class StringRadioButton {\n    private label: string;\n    private name: string;\n    private value: boolean;\n\n    constructor(name: string, label = '') {\n        this.label = label;\n        this.name = name;\n        this.value = true;\n    }\n\n    public isChecked(): boolean {\n        return this.value;\n    }\n    public objectName(): string {\n        return this.name;\n    }\n    public toggle(): void {\n        this.value = !this.value;\n    }\n}\n",
    "felix.20251213133753.7": "/**\n * Simulate a QLineEdit.\n */\nexport class StringLineEdit {\n    private disabled: boolean;\n    private name: string;\n    private pos: number;\n    private s: string;\n\n    constructor(name: string, disabled = false) {\n        this.disabled = disabled;\n        this.name = name;\n        this.pos = 0;\n        this.s = '';\n    }\n\n    public clear(): void {\n        this.pos = 0;\n        this.s = '';\n    }\n    public insert(s: string): void {\n        if (s) {\n            const i = this.pos;\n            this.s = this.s.substring(0, i) + s + this.s.substring(i);\n            this.pos += s.length;\n        }\n    }\n    public objectName(): string {\n        return this.name;\n    }\n    public text(): string {\n        return this.s;\n    }\n}\n\n",
    "felix.20251213133753.8": "/**\n * A string-based FindTabManager class.\n */\nexport class StringFindTabManager {\n    public c: Commands;\n    public entry_focus: any;\n    // Find/change text boxes...\n    public find_findbox: StringLineEdit;\n    public find_replacebox: StringLineEdit;\n    // Check boxes...\n    public check_box_ignore_case: StringCheckBox;\n    public check_box_mark_changes: StringCheckBox;\n    public check_box_mark_finds: StringCheckBox;\n    public check_box_regexp: StringCheckBox;\n    public check_box_search_body: StringCheckBox;\n    public check_box_search_headline: StringCheckBox;\n    public check_box_whole_word: StringCheckBox;\n    // Radio buttons...\n    public radio_button_entire_outline: StringRadioButton;\n    public radio_button_file_only: StringRadioButton;\n    public radio_button_node_only: StringRadioButton;\n    public radio_button_suboutline_only: StringRadioButton;\n\n    @others\n}\n\n",
    "felix.20251213133753.9": "/**\n * Ctor for the FindTabManager class.\n */\nconstructor(c: Commands) {\n    this.c = c;\n    this.entry_focus = undefined; // Accessed directly from code(!)\n    // Find/change text boxes...\n    this.find_findbox = new StringLineEdit('find_text');\n    this.find_replacebox = new StringLineEdit('change_text');\n    // Check boxes...\n    this.check_box_ignore_case = new StringCheckBox('ignore_case');\n    this.check_box_mark_changes = new StringCheckBox('mark_changes');\n    this.check_box_mark_finds = new StringCheckBox('mark_finds');\n    this.check_box_regexp = new StringCheckBox('pattern_match');\n    this.check_box_search_body = new StringCheckBox('search_body');\n    this.check_box_search_headline = new StringCheckBox('search_headline');\n    this.check_box_whole_word = new StringCheckBox('whole_word');\n    // Radio buttons...\n    this.radio_button_entire_outline = new StringRadioButton(\n        'entire_outline'\n    );\n    this.radio_button_file_only = new StringRadioButton('file_only');\n    this.radio_button_node_only = new StringRadioButton('node_only');\n    this.radio_button_suboutline_only = new StringRadioButton(\n        'suboutline_only'\n    );\n    // Init the default values.\n    this.init_widgets();\n}\n\n",
    "felix.20251213133753.10": "public clear_focus(): void {\n    this.entry_focus = undefined;\n    // this.find_findbox.clearFocus(); // UNUSED IN LEOJS\n}\npublic init_focus(): void {\n    this.set_entry_focus();\n    // SEND LEO SEARCH CONFIG TO VSCODE AND FOCUS IN FIND PANEL !\n    // TODO : TEST THIS !!\n    g.app.gui.startSearch();\n    //\n    // const w = this.find_findbox;\n    // w.setFocus()\n    // s = w.text()\n    // w.setSelection(0, len(s))\n}\npublic set_entry_focus(): void {\n    // Remember the widget that had focus, changing headline widgets\n    // to the tree pane widget.  Headline widgets can disappear!\n    const c = this.c;\n    let w = g.app.gui.get_focus();\n    if (w !== c.frame.body.wrapper.widget) {\n        w = c.frame.tree.treeWidget;\n    }\n    this.entry_focus = w;\n}\n\n",
    "felix.20251213133753.11": "/**\n * Return a g.bunch representing all widget values.\n *\n * Similar to LeoFind.default_settings, but only for find-tab values.\n */\npublic get_settings(): ISettings {\n    return {\n        // Find/change strings...\n        find_text: this.find_findbox.text(),\n        change_text: this.find_replacebox.text(),\n        // Find options...\n        file_only: this.radio_button_file_only.isChecked(),\n        ignore_case: this.check_box_ignore_case.isChecked(),\n        mark_changes: this.check_box_mark_changes.isChecked(),\n        mark_finds: this.check_box_mark_finds.isChecked(),\n        node_only: this.radio_button_node_only.isChecked(),\n        pattern_match: this.check_box_regexp.isChecked(),\n        search_body: this.check_box_search_body.isChecked(),\n        search_headline: this.check_box_search_headline.isChecked(),\n        suboutline_only: this.radio_button_suboutline_only.isChecked(),\n        whole_word: this.check_box_whole_word.isChecked(),\n    };\n}\n",
    "felix.20251213133753.12": "/**\n * Init widgets and ivars from c.config settings.\n * Create callbacks that always keep the LeoFind ivars up to date.\n */\npublic init_widgets(): void {\n    const c = this.c;\n    const find = this.c.findCommands;\n\n    // Find/change text boxes.\n    const table1 = [\n        ['find_findbox', 'find_text', ''], // '<find pattern here>' in original Leo\n        ['find_replacebox', 'change_text', ''],\n    ];\n    for (let [widget_ivar, setting_name, default_val] of table1) {\n        const w = this[widget_ivar as keyof StringFindTabManager];\n        const s = c.config.getString(setting_name) || default_val;\n        w.insert(s);\n    }\n\n    // Check boxes.\n    const table2 = [\n        ['ignore_case', 'check_box_ignore_case'],\n        ['mark_changes', 'check_box_mark_changes'],\n        ['mark_finds', 'check_box_mark_finds'],\n        ['pattern_match', 'check_box_regexp'],\n        ['search_body', 'check_box_search_body'],\n        ['search_headline', 'check_box_search_headline'],\n        ['whole_word', 'check_box_whole_word'],\n    ];\n\n    for (let [setting_name, widget_ivar] of table2) {\n        const w = this[widget_ivar as keyof StringFindTabManager];\n        const val = c.config.getBool(setting_name, false);\n        // setattr(find, setting_name, val)\n        (find[setting_name as keyof LeoFind] as any) = val;\n        if (val !== w.isChecked()) {\n            // Support LeoJS. :)\n            w.toggle();\n        }\n    }\n\n    // Radio buttons\n    const table3: [string, string | undefined, string][] = [\n        ['file_only', 'file_only', 'radio_button_file_only'], // #2684.\n        ['node_only', 'node_only', 'radio_button_node_only'],\n        ['entire_outline', undefined, 'radio_button_entire_outline'],\n        [\n            'suboutline_only',\n            'suboutline_only',\n            'radio_button_suboutline_only',\n        ],\n    ];\n\n    for (let [setting_name, ivar, widget_ivar] of table3) {\n        const w = this[widget_ivar as keyof StringFindTabManager];\n        const val = c.config.getBool(setting_name, false);\n        if (ivar !== undefined) {\n            // assert hasattr(find, setting_name), setting_name\n            (find[setting_name as keyof LeoFind] as any) = val;\n            if (val !== w.isChecked()) {\n                w.toggle();\n            }\n        }\n    }\n\n    // Ensure one radio button is set.\n    const w = this.radio_button_entire_outline;\n    if (!find.node_only && !find.suboutline_only && !find.file_only) {\n        if (!w.isChecked()) {\n            w.toggle();\n        }\n    } else {\n        if (w.isChecked()) {\n            w.toggle();\n        }\n    }\n}\n\n",
    "felix.20251213133753.13": "/**\n * Set all settings from d.\n */\npublic set_widgets_from_dict(d: { [key: string]: any }): void {\n    // Similar to ftm.init_widgets, which has already been called.\n    const c = this.c;\n    const find = c.findCommands;\n    // Set find text.\n    const find_text = d['find_text'];\n    this.set_find_text(find_text);\n    find.find_text = find_text;\n    // Set change text.\n    const change_text = d['change_text'];\n    this.set_change_text(change_text);\n    find.change_text = change_text;\n    // Check boxes...\n    const table1 = [\n        ['ignore_case', 'check_box_ignore_case'],\n        ['mark_changes', 'check_box_mark_changes'],\n        ['mark_finds', 'check_box_mark_finds'],\n        ['pattern_match', 'check_box_regexp'],\n        ['search_body', 'check_box_search_body'],\n        ['search_headline', 'check_box_search_headline'],\n        ['whole_word', 'check_box_whole_word'],\n    ];\n    for (let [setting_name, widget_ivar] of table1) {\n        const w = this[widget_ivar as keyof StringFindTabManager];\n        const val = d[setting_name] || false;\n        // setattr(find, setting_name, val)\n        (find[setting_name as keyof LeoFind] as any) = val;\n        if (val !== w.isChecked()) {\n            // Support LeoJS. :)\n            w.toggle();\n        }\n    }\n    // Radio buttons...\n    const table2: [string, string | undefined, string][] = [\n        ['node_only', 'node_only', 'radio_button_node_only'],\n        ['entire_outline', undefined, 'radio_button_entire_outline'],\n        [\n            'suboutline_only',\n            'suboutline_only',\n            'radio_button_suboutline_only',\n        ],\n        ['file_only', 'file_only', 'radio_button_file_only'], // #2684.\n    ];\n    for (let [setting_name, ivar, widget_ivar] of table2) {\n        const w = this[widget_ivar as keyof StringFindTabManager];\n        const val = d[setting_name] || false;\n        if (ivar !== undefined) {\n            // assert hasattr(find, setting_name), setting_name\n            (find[setting_name as keyof LeoFind] as any) = val;\n            if (val !== w.isChecked()) {\n                w.toggle();\n            }\n        }\n    }\n    // Ensure one radio button is set.\n    const w = this.radio_button_entire_outline;\n    if (!find.node_only && !find.suboutline_only && !find.file_only) {\n        if (!w.isChecked()) {\n            w.toggle();\n        }\n    } else {\n        if (w.isChecked()) {\n            w.toggle();\n        }\n    }\n}\n",
    "felix.20251213133753.14": "/**\n * Return the search-body and search-headline checkboxes to their defaults.\n */\npublic set_body_and_headline_checkbox(): void {\n    // #1840: headline-only one-shot\n    const c = this.c;\n    const find = c.findCommands;\n\n    if (!find) {\n        return;\n    }\n    const table: [string, StringCheckBox][] = [\n        ['search_body', this.check_box_search_body],\n        ['search_headline', this.check_box_search_headline],\n    ];\n\n    for (let [setting_name, w] of table) {\n        const val = c.config.getBool(setting_name, false);\n        if (val !== w.isChecked()) {\n            w.toggle();\n        }\n    }\n}\n\n",
    "felix.20251213133753.15": "/**\n * Set the value of the radio buttons\n */\npublic set_radio_button(name: string): void {\n    const d: { [key: string]: StringRadioButton } = {\n        'file-only': this.radio_button_file_only,\n        'node-only': this.radio_button_node_only,\n        'entire-outline': this.radio_button_entire_outline,\n        'suboutline-only': this.radio_button_suboutline_only,\n    };\n    // loop the keys instead of targeting d[name] directly\n    for (let key in d) {\n        let w = d[key];\n        if (key === name) {\n            if (w && !w.isChecked()) {\n                w.toggle();\n            }\n        } else {\n            if (w && w.isChecked()) {\n                w.toggle(); // turn off other radios\n            }\n        }\n    }\n}\n",
    "felix.20251213133753.16": "public get_find_text(): string {\n    let s = this.find_findbox.text();\n    if (s && ['\\r', '\\n'].includes(s.substring(s.length - 1))) {\n        s = s.slice(0, -1);\n    }\n    return s;\n}\n\npublic get_change_text(): string {\n    let s = this.find_replacebox.text();\n    if (s && ['\\r', '\\n'].includes(s.substring(s.length - 1))) {\n        s = s.slice(0, -1);\n    }\n    return s;\n}\n\npublic set_find_text(s: string): void {\n    const w = this.find_findbox;\n    w.clear();\n    w.insert(s);\n}\n\npublic set_change_text(s: string): void {\n    const w = this.find_replacebox;\n    w.clear();\n    w.insert(s);\n}\n",
    "felix.20251213133753.17": "/**\n * Toggle the value of the checkbox whose name is given.\n */\npublic toggle_checkbox(checkbox_name: string): void {\n    const d: { [key: string]: StringCheckBox } = {\n        ignore_case: this.check_box_ignore_case,\n        mark_changes: this.check_box_mark_changes,\n        mark_finds: this.check_box_mark_finds,\n        pattern_match: this.check_box_regexp,\n        search_body: this.check_box_search_body,\n        search_headline: this.check_box_search_headline,\n        whole_word: this.check_box_whole_word,\n    };\n    const w = d[checkbox_name];\n    w.toggle();\n}\n",
    "felix.20251213133753.18": "/**\n *  Leo's gui-independent find classes.\n */\n<< leoFind imports >>\n<< Theory of operation of find/change >>\n\n/**\n * Command decorator for the findCommands class.\n */\nfunction cmd(p_name: string, p_doc: string) {\n    return new_cmd_decorator(p_name, p_doc, ['c', 'findCommands']);\n}\n\nexport interface ISettings {\n    // State...\n    in_headline?: boolean;\n    p?: Position;\n    // Find/change strings...\n    find_text: string;\n    change_text: string;\n    // Find options...\n    file_only: boolean;\n    ignore_case: boolean;\n    mark_changes: boolean;\n    mark_finds: boolean;\n    node_only: boolean;\n    pattern_match: boolean;\n    search_body: boolean;\n    search_headline: boolean;\n    suboutline_only: boolean;\n    whole_word: boolean;\n    reverse?: boolean;\n    wrapping?: boolean;\n}\ntype ISettingsKey = keyof ISettings;\ntype IFindUndoData = {\n    end: number | undefined;\n    in_headline: boolean;\n    insert: number | undefined;\n    p: Position;\n    start: number | undefined;\n};\n\n@others\n@language typescript\n@tabwidth -4\n",
    "felix.20251213133753.19": "import * as g from './leoGlobals';\nimport { new_cmd_decorator } from './decorators';\nimport { Commands } from './leoCommands';\nimport { Position, VNode } from './leoNodes';\nimport {\n    StringCheckBox,\n    StringFindTabManager,\n    StringRadioButton,\n} from './findTabManager';\nimport { StringTextWrapper } from './leoFrame';\nimport { QuickSearchController } from './quicksearch';\n",
    "felix.20251213133753.20": "@language rest\n@nosearch\n@\n\nNOTE: LEOJS DOES NOT RESPECT THE GUI-INDEPENDENCE\nTODO: Call those via g.app.gui as LeoUi to respect GUI-independence!)\n\nLeoFind.py contains the gui-independent part of all of Leo's\nfind/change code. Such code is tricky, which is why it should be\ngui-independent code! Here are the governing principles:\n\n1. Find and Change commands initialize themselves using only the state\n   of the present Leo window. In particular, the Find class must not\n   save internal state information from one invocation to the next.\n   This means that when the user changes the nodes, or selects new\n   text in headline or body text, those changes will affect the next\n   invocation of any Find or Change command. Failure to follow this\n   principle caused all kinds of problems earlier versions.\n\n   This principle simplifies the code because most ivars do not\n   persist. However, each command must ensure that the Leo window is\n   left in a state suitable for restarting the incremental\n   (interactive) Find and Change commands. Details of initialization\n   are discussed below.\n\n2. The Find and Change commands must not change the state of the\n   outline or body pane during execution. That would cause severe\n   flashing and slow down the commands a great deal. In particular,\n   c.selectPosition and c.editPosition must not be called while\n   looking for matches.\n\n3. When incremental Find or Change commands succeed they must leave\n   the Leo window in the proper state to execute another incremental\n   command. We restore the Leo window as it was on entry whenever an\n   incremental search fails and after any Find All and Replace All\n   command. Initialization involves setting the self.c, self.v,\n   self.in_headline, self.wrapping and self.s_text ivars.\n\nSetting self.in_headline is tricky; we must be sure to retain the\nstate of the outline pane until initialization is complete.\nInitializing the Find All and Replace All commands is much easier\nbecause such initialization does not depend on the state of the Leo\nwindow. Using the same kind of text widget for both headlines and body\ntext results in a huge simplification of the code.\n\nThe searching code does not know whether it is searching headline or\nbody text. The search code knows only that self.s_text is a text\nwidget that contains the text to be searched or changed and the insert\nand sel attributes of self.search_text indicate the range of text to\nbe searched.\n\nSearching headline and body text simultaneously is complicated. The\nfind_next_match() method and its helpers handle the many details\ninvolved by setting self.s_text and its insert and sel attributes.\n",
    "felix.20251213133753.21": "/**\n * The base class for Leo's Find commands.\n */\nexport class LeoFind {\n    public c: Commands;\n    public expert_mode: boolean = false; // Set in finishCreate.\n    // Created by dw.createFindTab.\n    public ftm!: StringFindTabManager; // FindTabManager;\n    // public k: KeyHandler = c.k // ? needed ?\n    public re_obj!: RegExp;\n    //\n    // The work \"widget\".\n    public work_s = ''; // p.b or p.c.\n    public work_sel!: [number, number, number]; // pos, newpos, insert.\n    //\n    // Options ivars: set by FindTabManager.init.\n    // These *must* be initially None, not False.\n    public ignore_case!: boolean;\n    public node_only!: boolean;\n    public file_only!: boolean;\n    public pattern_match!: boolean;\n    public search_headline!: boolean;\n    public search_body!: boolean;\n    public entire_outline!: boolean;\n    public suboutline_only!: boolean;\n    public mark_changes!: boolean;\n    public mark_finds!: boolean;\n    public whole_word!: boolean;\n    //\n    // For isearch commands...\n    public stack: [Position, number, number, boolean][] = [];\n    // public inverseBindingDict: {[key: string]: [string, Stroke][]} = { };\n    public isearch_ignore_case: boolean = false;\n    public isearch_forward_flag: boolean = false;\n    public isearch_regexp: boolean = false;\n    // public iSearchStrokes: List[Stroke] = [];\n    public findTextList: string[] = [];\n    public changeTextList: string[] = [];\n    //\n    // For find/change...\n    public find_text = '';\n    public change_text = '';\n    //\n    // State machine...\n    public escape_handler!: (preloaded?: boolean) => any;\n    public handler!: (preloaded?: boolean) => any;\n    // \"Delayed\" requests for do_find_next.\n    public request_reverse: boolean = false;\n    public request_pattern_match: boolean = false;\n    public request_whole_word: boolean = false;\n    // Internal state...\n    public find_def_data: any;\n    public in_headline: boolean = false;\n    public match_obj!: RegExpExecArray | undefined;\n    public reverse: boolean = false;\n    public root: Position | undefined; // The start of the search, especially for suboutline-only.\n    public total_links = 0;\n    //\n    // User settings.\n    public minibuffer_mode!: boolean;\n    public reverse_find_defs!: boolean;\n    public prefer_nav_pane!: boolean;\n\n    // Patterns for find_def.\n    public bad_regex_patterns: string[] = [];\n\n    public python_patterns: string[] = [\n        // Python original 'python' regex patterns from Leo.\n        // r\"^\\s*class\\s+[[word]]\\b\",\n        // r\"^\\s*def\\s+[[word]]\\b\",\n        // r\"\\b[[word]]\\s*=\",\n        // r\"\\b[[word]]:\",\n\n        `^\\\\s*class\\\\s+[[word]]\\\\b`,\n        `^\\\\s*def\\\\s+[[word]]\\\\b`,\n        `\\\\b[[word]]\\\\s*=`,\n        `\\\\b[[word]]:`,\n    ];\n\n    public rust_patterns: string[] = [\n        // Rust original 'python' regex patterns from Leo.\n        // # fn first.\n        // r'\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s+fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*crate\\s*\\)\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*self\\s*\\)\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*super\\s*\\)\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*in\\s*crate::.*?\\)\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*in\\s*self::.*?\\)\\s*fn\\s+[[word]]',\n        // r'\\s*pub\\s*\\(\\s*in\\s*super::.*?\\)\\s*fn\\s+[[word]]',\n        // # enum.\n        // r'\\s*enum\\s+[[word]]\\s*\\{',\n        // r'\\s*pub\\s+enum\\s+[[word]]\\s*\\{',\n        // # impl.\n        // r'\\s*impl\\b(.*?)[[word]]',\n        // # mod.\n        // r'\\s*mod\\s+[[word]]',\n        // # struct.\n        // r'\\s*struct\\b(.*?)[[word]]',\n        // r'\\s*pub\\s+struct\\b(.*?)[[word]]',\n        // # trait.\n        // r'\\s*trait\\b(.*?)[[word]]',\n        // r'\\s*pub\\s+trait\\b(.*?)[[word]]',\n        // # use.\n        // r'\\s*use\\b.*?[[word]]',\n\n        // fn first.\n        `\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s+fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*crate\\\\s*\\\\)\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*self\\\\s*\\\\)\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*super\\\\s*\\\\)\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*in\\\\s*crate::.*?\\\\)\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*in\\\\s*self::.*?\\\\)\\\\s*fn\\\\s+[[word]]`,\n        `\\\\s*pub\\\\s*\\\\(\\\\s*in\\\\s*super::.*?\\\\)\\\\s*fn\\\\s+[[word]]`,\n        // enum.\n        `\\\\s*enum\\\\s+[[word]]\\\\s*\\\\{`,\n        `\\\\s*pub\\\\s+enum\\\\s+[[word]]\\\\s*\\\\{`,\n        // impl.\n        `\\\\s*impl\\\\b(.*?)[[word]]`,\n        // mod.\n        `\\\\s*mod\\\\s+[[word]]`,\n        // struct.\n        `\\\\s*struct\\\\b(.*?)[[word]]`,\n        `\\\\s*pub\\\\s+struct\\\\b(.*?)[[word]]`,\n        // trait.\n        `\\\\s*trait\\\\b(.*?)[[word]]`,\n        `\\\\s*pub\\\\s+trait\\\\b(.*?)[[word]]`,\n        // use.\n        `\\\\s*use\\\\b.*?[[word]]`,\n    ];\n\n    @others\n}\n",
    "felix.20251213133753.23": "constructor(c: Commands) {\n    this.c = c;\n    this.reload_settings();\n}\n",
    "felix.20251213133753.24": "/**\n * Return a dict representing all default settings.\n */\npublic default_settings(): ISettings {\n    const c = this.c;\n    return {\n        // State...\n        in_headline: false,\n        p: c.rootPosition()!,\n        // Find/change strings...\n        find_text: '',\n        change_text: '',\n        // Find options...\n        file_only: false,\n        ignore_case: false,\n        mark_changes: false,\n        mark_finds: false,\n        node_only: false,\n        pattern_match: false,\n        reverse: false,\n        search_body: true,\n        search_headline: true,\n        suboutline_only: false,\n        whole_word: false,\n        wrapping: false,\n    };\n}\n",
    "felix.20251213133753.25": "public finishCreate(): void {\n    // New in 4.11.1.\n    // Must be called when config settings are valid.\n    const c = this.c;\n    this.reload_settings();\n    // now that configuration settings are valid,\n    // we can finish creating the Find pane.\n    // ! not needed !\n    // dw = c.frame.top\n    // if dw:\n    //     dw.finishCreateLogPane()\n}\n\n",
    "felix.20251213133753.26": "/**\n * Initialize all ivars from settings, including required defaults.\n *\n * This should be called from the do_ methods as follows:\n *\n * self.init_ivars_from_settings(settings)\n * if not self.check_args('find-next'):\n *     return <appropriate error indication>\n */\npublic init_ivars_from_settings(settings: ISettings): void {\n    //\n    // Init required defaults.\n    this.reverse = false;\n    //\n    // Init find/change strings.\n    this.change_text = settings.change_text;\n    this.find_text = settings.find_text;\n    //\n    // Init find options.\n    this.file_only = settings.file_only;\n    this.ignore_case = settings.ignore_case;\n    this.mark_changes = settings.mark_changes;\n    this.mark_finds = settings.mark_finds;\n    this.node_only = settings.node_only;\n    this.pattern_match = settings.pattern_match;\n    this.search_body = settings.search_body;\n    this.search_headline = settings.search_headline;\n    this.suboutline_only = settings.suboutline_only;\n    this.whole_word = settings.whole_word;\n    // self.wrapping = settings.wrapping\n}\n\n",
    "felix.20251213133753.27": "/**\n * LeoFind.reload_settings.\n */\npublic reload_settings(): void {\n    const c = this.c;\n    this.minibuffer_mode = c.config.getBool('minibuffer-find-mode', false);\n    this.reverse_find_defs = c.config.getBool('reverse-find-defs', false);\n    this.prefer_nav_pane = c.config.getBool('prefer-nav-pane', true);\n}\n\n// Necessary alias.\npublic reloadSettings(): void {\n    this.reload_settings();\n}\n",
    "felix.20251213133753.28": "\npublic batch_change(\n    root: Position,\n    replacements: [string, string][],\n    settings?: ISettings\n): number {\n    << docstring: find.batch_change >>\n    try {\n        // self._init_from_dict(settings or {})\n        this._init_from_dict(settings || {});\n        let count = 0;\n        let find;\n        let change;\n        for ([find, change] of replacements) {\n            count += this._batch_change_helper(root, find, change);\n        }\n        return count;\n    } catch (e) {\n        g.es_exception(e);\n        return 0;\n    }\n}\n",
    "felix.20251213133753.29": "/*\n *  Support batch change scripts.\n *\n * replacement: a list of tuples (find_string, change_string).\n * settings: a dict or g.Bunch containing find/change settings.\n *           See find._init_from_dict for a list of valid settings.\n *\n * Example:\n *\n *     h = '@file src/ekr/coreFind.py'\n *     root = g.findNodeAnywhere(c, h)\n *     assert root\n *     replacements = (\n *         ('clone_find_all', 'do_clone_find_all'),\n *         ('clone_find_all_flattened', 'do_clone_find_all_flattened'),\n *     )\n *     settings = dict(suboutline_only=True)\n *     count = c.findCommands.batch_change(root, replacements, settings)\n *     if count:\n *         c.save()\n */\n",
    "felix.20251213133753.30": "private _batch_change_helper(\n    p: Position,\n    find_text: string,\n    change_text: string\n): number {\n    const c = this.c;\n    const p1 = p.copy();\n    const u = this.c.undoer;\n    const undoType = 'Batch Change All';\n    // Check...\n    if (!find_text) {\n        return 0;\n    }\n    if (!this.search_headline && !this.search_body) {\n        return 0;\n    }\n    if (this.pattern_match) {\n        const ok = this.compile_pattern();\n        if (!ok) {\n            return 0;\n        }\n    }\n    // Init...\n    this.find_text = find_text;\n    this.change_text = this.replace_back_slashes(change_text);\n    let positions: Generator<Position, any, unknown> | Position[];\n    if (this.node_only) {\n        positions = [p1];\n    } else if (this.suboutline_only) {\n        positions = p1.self_and_subtree();\n    } else {\n        positions = c.all_unique_positions();\n    }\n    // Init the work widget.\n    const s: string = this.in_headline ? p.h : p.b;\n    this.work_s = s;\n    this.work_sel = [0, 0, 0];\n    // The main loop.\n    u.beforeChangeGroup(p1, undoType);\n    let count: number = 0;\n    for (const p of positions) {\n        let count_h: number | false = 0;\n        let count_b: number | false = 0;\n        let new_h: string | undefined;\n        let new_b: string | undefined;\n\n        const undoData = u.beforeChangeNodeContents(p);\n        if (this.search_headline) {\n            [count_h, new_h] = this._change_all_search_and_replace(p.h);\n\n            if (count_h) {\n                count += count_h;\n                p.h = new_h!;\n            }\n        }\n        if (this.search_body) {\n            [count_b, new_b] = this._change_all_search_and_replace(p.b);\n\n            if (count_b) {\n                count += count_b;\n                p.b = new_b!;\n            }\n        }\n        if (count_h || count_b) {\n            u.afterChangeNodeContents(p1, 'Replace All', undoData);\n        }\n    }\n    u.afterChangeGroup(p1, undoType);\n\n    if (!g.unitTesting) {\n        g.es(`${count}: ${find_text} => ${change_text}`);\n    }\n    return count;\n}\n",
    "felix.20251213133753.31": "/**\n * Initialize ivars from settings (a dict or g.Bunch).\n */\nprivate _init_from_dict(settings: { [key: string]: any }): void {\n    // The valid ivars and reasonable defaults.\n    const valid: { [key: string]: any } = {\n        ignore_case: false,\n        node_only: false,\n        pattern_match: false,\n        search_body: true,\n        search_headline: true,\n        suboutline_only: false, // Seems safest.  // Was true !!!\n        whole_word: true,\n    };\n    // Set ivars to reasonable defaults.\n    for (const ivar in valid) {\n        // * USING 'in' TO GET KEYS\n        // setattr(self, ivar, valid.get(ivar));\n        (this as any)[ivar] = valid[ivar];\n    }\n    // Override ivars from settings.\n    let errors = 0;\n    for (const ivar in settings) {\n        // * USING 'in' TO GET KEYS\n        if (ivar in valid) {\n            const val = settings[ivar];\n            if ([true, false].includes(val)) {\n                // setattr(self, ivar, val);\n                (this as any)[ivar] = val;\n            } else {\n                g.trace(`bad value: ${ivar} = ${val}`);\n                errors += 1;\n            }\n        } else {\n            g.trace(`ignoring ${ivar} setting`);\n            errors += 1;\n        }\n    }\n    if (errors) {\n        g.printObj(Object.keys(valid).sort(), 'valid keys');\n    }\n}\n",
    "felix.20251213133753.33": "@cmd('show-all-tags', 'Show all tags, organized by node.')\npublic show_all_tags(): void {\n    const c = this.c;\n    if (!c) {\n        return;\n    }\n    const tc = c.theTagController;\n    if (tc) {\n        tc.show_all_tags();\n    } else {\n        g.es('nodetags plugin not enabled');\n    }\n}\n",
    "felix.20251213133753.34": "@cmd('replace-then-find', 'Handle the replace-then-find command.')\n@cmd('change-then-find', 'Handle the replace-then-find command.')\npublic change_then_find(): void {\n    g.app.gui.replace(false, true);\n    // // Settings...\n    // this.init_in_headline();\n    // const settings = this.ftm.get_settings();\n    // this.do_change_then_find(settings);\n}\n",
    "felix.20251213133753.35": "/**\n * Do the change-then-find command from settings.\n *\n *  This is a stand-alone method for unit testing.\n */\npublic do_change_then_find(settings: ISettings): boolean {\n    const p = this.c.p;\n    this.init_ivars_from_settings(settings);\n    if (!this.check_args('change-then-find')) {\n        return false;\n    }\n    if (this.change_selection(p)) {\n        return !!this.do_find_next(settings)[0];\n    } else {\n        return false;\n    }\n}\n",
    "felix.20251213133753.36": "@cmd(\n    'clone-find-all-marked',\n    'clone-find-all-marked, aka cfam. ' +\n    'Create an organizer node whose descendants contain clones of all marked ' +\n    'nodes. The list is *not* flattened: clones appear only once in the ' +\n    'descendants of the organizer node.'\n)\n@cmd(\n    'cfam',\n    'clone-find-all-marked, aka cfam. ' +\n    'Create an organizer node whose descendants contain clones of all marked ' +\n    'nodes. The list is *not* flattened: clones appear only once in the ' +\n    'descendants of the organizer node.'\n)\npublic cloneFindAllMarked(): void {\n    this.do_find_marked(false);\n}\n@cmd(\n    'clone-find-all-flattened-marked',\n    'clone-find-all-flattened-marked, aka cffm. ' +\n    'Create an organizer node whose direct children are clones of all marked ' +\n    'nodes. The list is flattened: every cloned node appears as a direct ' +\n    'child of the organizer node, even if the clone also is a descendant of ' +\n    'another cloned node.'\n)\n@cmd(\n    'cffm',\n    'clone-find-all-flattened-marked, aka cffm. ' +\n    'Create an organizer node whose direct children are clones of all marked ' +\n    'nodes. The list is flattened: every cloned node appears as a direct ' +\n    'child of the organizer node, even if the clone also is a descendant of ' +\n    'another cloned node.'\n)\npublic cloneFindAllFlattenedMarked(): void {\n    this.do_find_marked(true);\n}\n",
    "felix.20251213133753.37": "/**\n * Helper for clone-find-marked commands.\n *\n * This is a stand-alone method for unit testing.\n */\npublic do_find_marked(flatten: boolean): boolean {\n    const c = this.c;\n    const u = this.c.undoer;\n    const undoType = 'clone-find-marked';\n    const failMsg = 'No marked nodes';\n\n    let count = 0;\n    for (let p of c.all_unique_positions()) {\n        if (p.isMarked()) {\n            count += 1;\n        }\n    }\n    if (count === 0) {\n        g.es(failMsg); // prevent even creating an undo bead.\n        return false;\n    }\n    function isMarked(p: Position): boolean {\n        return p.isMarked();\n    }\n\n    u.beforeChangeGroup(c.p.copy(), undoType, false); // will create a bead.\n\n    const root: Position | undefined = c.cloneFindByPredicate(\n        c.all_unique_positions.bind(c),\n        isMarked,\n        failMsg,\n        flatten,\n        undefined,\n        undoType\n    );\n\n    if (root) {\n        // Unmarking all nodes is convenient.\n        for (let p of c.all_unique_positions()) {\n            if (p.isMarked()) {\n                const bunch = u.beforeMark(p, 'Unmark');\n                c.clearMarked(p);\n                u.afterMark(p, 'Unmark', bunch);\n            }\n        }\n        const n = root.numberOfChildren();\n        root.b = `# Found ${n} marked node${g.plural(n)}`;\n        c.selectPosition(root);\n        c.redraw(root);\n    }\n    u.afterChangeGroup(c.p.copy(), undoType);\n    return !!root && root.__bool__();\n}\n",
    "felix.20251213133753.38": "@cmd(\n    'clone-find-parents',\n    'Create an organizer node whose direct children are clones of all ' +\n    'parents of the selected node, which must be a clone.'\n)\npublic cloneFindParents(): boolean {\n    const c = this.c;\n    const u = this.c.undoer;\n    const p = c.p;\n\n    if (!p || !p.__bool__()) {\n        return false;\n    }\n    if (!p.isCloned()) {\n        g.es(`not a clone: ${p.h}`);\n        return false;\n    }\n    const p0 = p.copy();\n    const undoType = 'Find Clone Parents';\n    const aList = c.vnode2allPositions(p.v);\n    if (!aList.length) {\n        g.trace('can not happen: no parents');\n        return false;\n    }\n    // Create the node as the last top-level node.\n    // All existing positions remain valid.\n    u.beforeChangeGroup(p, undoType);\n    let b = u.beforeInsertNode(p);\n    const found = c.lastTopLevel().insertAfter();\n    found.h = `Found: parents of ${p.h}`;\n    u.afterInsertNode(found, 'insert', b);\n    const seen: VNode[] = [];\n    for (let p2 of aList) {\n        const parent = p2.parent();\n        if (parent && parent.__bool__() && !seen.includes(parent.v)) {\n            seen.push(parent.v);\n            b = u.beforeCloneNode(parent);\n            // Bug fix 2021/06/15: Create the clone directly as a child of found.\n            const clone = parent.copy();\n            const n = found.numberOfChildren();\n            clone._linkCopiedAsNthChild(found, n);\n            u.afterCloneNode(clone, 'clone', b);\n        }\n    }\n\n    u.afterChangeGroup(p0, undoType);\n    c.setChanged();\n    c.redraw(found);\n\n    return true;\n}\n",
    "felix.20251213133753.39": "@cmd('find-def', 'Find the class, def or assignment to var of the word under the cursor.')\n@cmd('find-var', 'Find the class, def or assignment to var of the word under the cursor.')\npublic find_def(): [number, Position, string][] {\n    const word = this._compute_find_def_word();\n    return this.do_find_def(word);\n}\n\n// Compatibility. \n// find_var = find_def\npublic find_var(): [number, Position, string][] {\n    return this.find_def();\n}\n",
    "felix.20251213133753.40": "/*\n * A helper for find_def's.\n * It's a standalone method for unit tests.\n */\npublic do_find_def(word?: string): [number, Position, string][] {\n\n    const c = this.c;\n    let patterns = this._make_patterns(word);\n    let matches = this._find_all_matches(patterns);\n    if (g.unitTesting) {\n        return matches;\n    }\n    // Look for alternate matches only if there are no exact matches.\n    if (!matches.length) {\n        const alt_word = this._switch_style(word);\n        patterns = this._make_patterns(alt_word);\n        matches = this._find_all_matches(patterns);\n    }\n    if (!matches.length) {\n        g.es(`not found: ${word}`, { color: 'red' });\n        return matches;\n    }\n    // Always update the Nav pane if it is enabled.\n    const use_nav_pane = this.prefer_nav_pane;\n    if (use_nav_pane) {\n        this._load_quicksearch_entries(word, matches);\n    }\n    // Carefully select the most convenient clone of p.\n    if (matches.length === 1) {\n        let [i, p, s] = matches[0];\n        if (p === c.p) {\n            // Do nothing\n        } else if (this.reverse_find_defs) {\n            let search_p = c.lastPosition();\n            while (search_p && search_p.__bool__()) {\n                if (search_p.v === p.v) {\n                    p = search_p;\n                    break;\n                } else {\n                    search_p.moveToThreadBack();\n                }\n            }\n        } else {\n            // Start in the root position.\n            let search_p = c.rootPosition();\n            while (search_p && search_p.__bool__()) {\n                if (search_p.v === p.v) {\n                    p = search_p;\n                    break;\n                } else {\n                    search_p.moveToThreadNext();\n                }\n            }\n        }\n        c.selectPosition(p);\n        const w = c.frame.body.wrapper;\n        if (w) {\n            w.setSelectionRange(i, i + s.length, i);\n        }\n    } else if (!use_nav_pane) {\n        // Show clones, but only if the Nav pane isn't available.\n        this._make_clones(word, matches);\n    }\n    return matches;\n}\n\n// Compatibility.\n// do_find_var = do_find_def\npublic do_find_var(word: string): [number, Position, string][] {\n    return this.do_find_def(word);\n}\n",
    "felix.20251213133753.41": "public _load_quicksearch_entries(word?: string, matches: [number, Position, string][] = []): void {\n    /* Put all matches in the Nav pane. */\n    const c = this.c;\n    const unique_matches = Array.from(new Set(matches.map(([i, p, s]) => s.trim()).filter(s => s)));\n    // The Nav pane can show only one match, so issue a warning.\n    if (unique_matches.length > 1) {\n        g.es_print(`Multiple matches for ${word}`);\n        for (const z of unique_matches.slice(1)) {\n            g.es_print(z);\n        }\n    }\n    // Put the first match in the Nav pane's edit widget and update.\n    const scon: QuickSearchController = c.quicksearchController;\n    scon.navText = unique_matches[0];\n    scon.qsc_search(unique_matches[0]);\n    g.app.gui.showNavResults();\n    g.app.gui.loadSearchSettings();\n}\n\n",
    "felix.20251213133753.42": "/**\n * Init the find-def command. Return the word to find or None.\n */\nprivate _compute_find_def_word(): string | undefined {\n\n    const c = this.c;\n    const w = c.frame.body.wrapper;\n\n    // First get the word.\n    c.bodyWantsFocusNow();\n\n    if (!w.hasSelection()) {\n        c.editCommands.extendToWord(true);\n    }\n\n    const word: string = w.getSelectedText().trim();\n    if (!word) {\n        return undefined;\n    }\n\n    // 'keywords' array used for equivalent of python's keyword.iskeyword(word)\n    const keywords = [\n        'False',\n        'await',\n        'else',\n        'import',\n        'pass',\n        'None',\n        'break',\n        'except',\n        'in',\n        'raise',\n        'True',\n        'class',\n        'finally',\n        'is',\n        'return',\n        'and',\n        'continue',\n        'for',\n        'lambda',\n        'try',\n        'as',\n        'def',\n        'from',\n        'nonlocal',\n        'while',\n        'assert',\n        'del',\n        'global',\n        'not',\n        'with',\n        'async',\n        'elif',\n        'if',\n        'or',\n        'yield',\n    ];\n    if (keywords.includes(word)) {\n        return undefined;\n    }\n\n    // Return word, stripped of preceding class or def.\n    for (let tag of ['class ', 'def ']) {\n        const found = word.startsWith(tag) && word.length > tag.length;\n        if (found) {\n            return word.substring(tag.length).trim();\n        }\n    }\n    return word;\n}\n",
    "felix.20251213133753.43": "/*\n* Search all nodes for any of the given compiled regex patterns.\n* \n* Return a list of tuples (starting-index, p, matching-string) describing the matches.\n*/\npublic _find_all_matches(patterns: RegExp[]): [number, Position, string][] {\n\n    const c = this.c;\n    const target_language = c.getLanguage(c.p);\n    let p = c.rootPosition();\n    const results: [number, Position, string][] = [];\n    const seen = new Set();\n\n    while (p && p.__bool__()) {\n        if (g.inAtNosearch(p)) {\n            p.moveToNodeAfterTree();\n            continue;\n        }\n        if (seen.has(p.v)) {\n            p.moveToThreadNext();\n            continue;\n        }\n        seen.add(p.v);\n\n        // Only search nodes with the desired language.\n        let language = c.getLanguage(p);\n        if (language === target_language) {\n            const b = p.b;\n            let i = 0;  // The index within p.b of the start of s.\n            let found = false;  // Only report the first match within p.b.\n            for (const s of g.splitLines(b)) {\n                for (const pattern of patterns) {\n                    const m = pattern.exec(s);\n                    if (m) {\n                        results.push([i + m.index, p.copy(), m[0]]);\n                        found = true;\n                        break;\n                    }\n                }\n                if (found) {\n                    break;\n                }\n                i += s.length;\n            }\n        }\n        p.moveToThreadNext();\n    }\n    return results;\n}\n",
    "felix.20251213133753.44": "public _make_clones(word: string = \"\", matches: [number, Position, string][] = []): void {\n    /*\n    * Undoably create clones for all matches, similar to the clone-find commands.\n    */\n    const c = this.c;\n    const ftm = this.ftm;\n    const u = c.undoer;\n    const undoData = u.beforeInsertNode(c.p);\n\n    // Create the found node.\n    const found = c.lastTopLevel().insertAfter();\n    found.h = `Found ${matches.length}: ${word}`;\n    found.b = `@nosearch\\n\\n# found ${matches.length} nodes`;\n    // Clone nodes as children of the found node.\n    const clones = matches.map(([i, p, s]) => p);\n    for (const p of clones) {\n        const p2 = p.copy();\n        const n = found.numberOfChildren();\n        p2._linkCopiedAsNthChild(found, n);\n    }\n    // Sort the clones in place, without undo.\n    found.v.children.sort((v1, v2) => v1.h.toLowerCase().localeCompare(v2.h.toLowerCase()));\n\n    // Set the search text. This is convenient and should not cause problems.\n    this.find_text = word;\n    ftm.set_find_text(word);\n\n    // Set the undo data.\n    u.afterInsertNode(found, 'find-def', undoData);\n    c.setChanged();\n    found.expand();\n    c.redraw(found);\n}\n",
    "felix.20251213133753.45": "public _make_patterns(word?: string): RegExp[] {\n    /* Return a list of compiled regex patterns. */\n    const c = this.c;\n\n    // Get the patterns of the language in effect.\n    const language = c.getLanguage(c.p);\n    const patterns: string[] = language ? {\n        'python': this.python_patterns,\n        'rust': this.rust_patterns,\n    }[language] || [] : [];\n\n    // Compute the list of compiled patterns.\n    const results: RegExp[] = [];\n    for (let pattern of patterns) {\n        pattern = pattern.replace('[[word]]', `\\\\b${word}\\\\b`);\n        try {\n            results.push(new RegExp(pattern));\n        } catch (e) {\n            if (!this.bad_regex_patterns.includes(pattern)) {\n                this.bad_regex_patterns.push(pattern);\n                g.es_print(`bad regex pattern: ${pattern}`);\n            }\n        }\n    };\n    return results;\n}\n\n",
    "felix.20251213133753.46": "/**\n * Switch between camelCase and underscore_style function definitions.\n * Return undefined if there would be no change.\n */\nprivate _switch_style(word?: string): string | undefined {\n    let s = word;\n    if (!s) {\n        return undefined;\n    }\n\n    if (g.isUpper(s[0])) {\n        return undefined; // Don't convert class names.\n    }\n    if (s.indexOf('_') > -1) {\n        // Convert to CamelCase\n        s = s.toLowerCase();\n        while (s) {\n            const i = s.indexOf('_');\n            if (i === -1) {\n                break;\n            }\n            s = s.substring(0, i) + g.capitalize(s.substring(i + 1));\n        }\n        return s;\n    }\n\n    // Convert to underscore_style.\n    const result = [];\n    let i;\n    let ch;\n    for (const [i, ch] of g.enumerate(s)) {\n        if (i > 0 && g.isUpper(ch)) {\n            result.push('_');\n        }\n        result.push(ch.toLowerCase());\n    }\n    s = result.join('');\n    return s === word ? undefined : s;\n}\n",
    "felix.20251213133753.47": "@cmd('find-next', 'The find-next command.')\npublic find_next(): void {\n    g.app.gui.find(false, false);\n    // // Settings...\n    // this.reverse = false;\n    // this.init_in_headline();  // Do this *before* creating the settings.\n    // const settings = this.ftm.get_settings();\n    // // Do the command!\n    // this.do_find_next(settings);\n}\n@cmd('find-prev', 'Handle F2 (find-previous)')\npublic find_prev(): void {\n    g.app.gui.find(false, true);\n    // // Settings...\n    // this.init_in_headline();  // Do this *before* creating the settings.\n    // const settings = this.ftm.get_settings();\n    // // Do the command!\n    // this.do_find_prev(settings);\n}\n",
    "felix.20251213133753.48": "/**\n * Find the previous instance of this.find_text.\n */\npublic do_find_prev(\n    settings: ISettings\n): [Position | undefined, number | undefined, number | undefined] {\n    this.request_reverse = true;\n    return this.do_find_next(settings);\n}\n/**\n * Find the next instance of this.find_text.\n *\n * Return True (for vim-mode) if a match was found.\n */\npublic do_find_next(\n    settings: ISettings\n): [Position | undefined, number | undefined, number | undefined] {\n    const c = this.c;\n    let p: Position | undefined = this.c.p;\n    //\n    // The gui widget may not exist for headlines.\n    const gui_w = this.in_headline\n        ? c.edit_widget(p)\n        : c.frame.body.wrapper;\n    //\n    // Init the work widget, so we don't get stuck.\n    const s = this.in_headline ? p.h : p.b;\n    const ins = gui_w ? gui_w.getInsertPoint() : 0;\n    this.work_s = s;\n    this.work_sel = [ins, ins, ins];\n    //\n    // Set the settings *after* initing the search.\n    this.init_ivars_from_settings(settings);\n    //\n    // Honor delayed requests.\n    for (const ivar of ['reverse', 'pattern_match', 'whole_word']) {\n        const request = 'request_' + ivar;\n        const val = (this as any)[request]; // getattr(this, request)\n        if (val) {\n            // Only *set* the ivar!\n            // setattr(this, ivar, val)  // Set the ivar.\n            (this as any)[ivar] = val;\n            //setattr(this, request, false)  // Clear the request!\n            (this as any)[request] = false;\n        }\n    }\n    //\n    // Leo 6.4: set/clear this.root\n    if (this.root && this.root.__bool__()) {\n        // pragma: no cover\n        if (!p.__eq__(this.root) && !this.root.isAncestorOf(p)) {\n            // p is outside of this.root's tree.\n            // Clear suboutline-only.\n            this.root = undefined;\n            this.suboutline_only = false;\n            this.set_find_scope_every_where(); // Update find-tab & status area.\n        }\n    } else if (this.suboutline_only) {\n        // Start the range and set suboutline-only.\n        this.root = c.p;\n        this.set_find_scope_suboutline_only(); // Update find-tab & status area.\n    } else if (this.file_only) {\n        // Start the range and set file-only.\n        this.root = c.p;\n        p = c.p;\n        let node: Position = this.c.p;\n        let found = false;\n        let hitBase = false;\n        while (!found && !hitBase) {\n            let h = node.h;\n            if (h) {\n                h = h.split(' ')[0];\n            }\n\n            if (\n                [\n                    '@clean',\n                    '@file',\n                    '@asis',\n                    '@thin',\n                    '@edit',\n                    '@auto',\n                    '@auto-md',\n                    '@auto-org',\n                    '@auto-otl',\n                    '@auto-rst',\n                ].includes(h)\n            ) {\n                found = true;\n            } else {\n                if (node.level() === 0) {\n                    hitBase = true;\n                } else {\n                    node = node.parent();\n                }\n            }\n        }\n        this.root = node;\n        this.set_find_scope_file_only(); // Update find-tab & status area.\n        p = node;\n    }\n    //\n    // Now check the args.\n    const tag = this.reverse ? 'find-prev' : 'find-next';\n    if (!this.check_args(tag)) {\n        // Issues error message.\n        return [undefined, undefined, undefined];\n    }\n    const data = this.save();\n    let pos;\n    let newpos;\n    [p, pos, newpos] = this.find_next_match(p);\n    const found = pos !== undefined;\n    if (found) {\n        this.show_success(p!, pos!, newpos!);\n    } else {\n        // Restore previous position.\n        this.restore(data);\n    }\n    this.show_status(found);\n    return [p, pos, newpos];\n}\n",
    "felix.20251213133753.49": "@cmd('replace', 'Replace the selected text with the replacement text.')\n@cmd('change', 'Replace the selected text with the replacement text.')\npublic change(): void {\n    g.app.gui.replace(false, false);\n    // const p = this.c.p;\n    // if (this.check_args('replace')) {\n    //     this.init_in_headline();\n    //     this.change_selection(p);\n    // }\n}\n\n",
    "felix.20251213133753.50": "@cmd(\n    'set-find-everywhere',\n    \"Set the 'Entire Outline' radio button in the Find tab.\"\n)\npublic set_find_scope_every_where(): void {\n    g.app.gui.setSearchSetting('entireOutline');\n    // this.set_find_scope('entire-outline');\n}\n@cmd(\n    'set-find-node-only',\n    \"Set the 'Node Only' radio button in the Find tab.\"\n)\npublic set_find_scope_node_only(): void {\n    g.app.gui.setSearchSetting('nodeOnly');\n    // this.set_find_scope('node-only');\n}\n@cmd(\n    'set-find-file-only',\n    \"Set the 'File Only' radio button in the Find tab.\"\n)\npublic set_find_scope_file_only(): void {\n    g.app.gui.setSearchSetting('fileOnly');\n    // this.set_find_scope('file-only');\n}\n@cmd(\n    'set-find-suboutline-only',\n    \"Set the 'Suboutline Only' radio button in the Find tab.\"\n)\npublic set_find_scope_suboutline_only(): void {\n    g.app.gui.setSearchSetting('subOutlineOnly');\n    // this.set_find_scope('suboutline-only');\n}\n\n/**\n * Set the radio buttons to the given scope\n */\npublic set_find_scope(where: string): void {\n    const c = this.c;\n    const fc = this.c.findCommands;\n    this.ftm.set_radio_button(where);\n\n    // const options = fc.compute_find_options_in_status_area(); // ? NEEDED ?\n    // c.frame.statusLine.put(options); // ? NEEDED ?\n}\n",
    "felix.20251213133753.51": "@cmd('show-find-options', 'Show the present find options')\npublic show_find_options(): void {\n    // frame = self.c.frame // ? NEEDED ?\n    // frame.clearStatusLine() // ? NEEDED ?\n    let part1;\n    let part2;\n    [part1, part2] = this.compute_find_options();\n    // frame.putStatusLine(part1, 'blue');  // ? NEEDED ?\n    // frame.putStatusLine(part2);  // ? NEEDED ?\n    g.es(part1);\n    g.es(part2);\n}\n",
    "felix.20251213133753.52": "/**\n * Return the status line as two strings.\n */\npublic compute_find_options(): [string, string] {\n    const z: string[] = [];\n    let scope: string;\n    // Set the scope field.\n    if (this.suboutline_only) {\n        scope = 'tree';\n    } else if (this.node_only) {\n        scope = 'node';\n    } else {\n        scope = 'all';\n    }\n    // scope = this.getOption('radio-search-scope')\n    // d = {'entire-outline':'all','suboutline-only':'tree','node-only':'node'}\n    // scope = d.get(scope) or ''\n\n    const head = this.search_headline ? 'head' : '';\n    const body = this.search_body ? 'body' : '';\n    const sep = head && body ? '+' : '';\n    const part1 = `${head}${sep}${body} ${scope}  `;\n    // Set the type field.\n    const regex = this.pattern_match;\n    if (regex) {\n        z.push('regex');\n    }\n    const table = [\n        ['reverse', 'reverse'],\n        ['ignore_case', 'noCase'],\n        ['whole_word', 'word'],\n        // ['wrap', 'wrap'],\n        ['mark_changes', 'markChg'],\n        ['mark_finds', 'markFnd'],\n    ];\n    let ivar;\n    let s;\n    for (const [ivar, s] of table) {\n        const val = (this as any)['ivar'];\n        if (val) {\n            z.push(s);\n        }\n    }\n    const part2 = z.join(' ');\n\n    return [part1, part2];\n}\n",
    "felix.20251213133753.53": "@cmd('toggle-find-collapses-nodes', \"Toggle the 'Collapse Nodes' setting.\")\npublic toggle_find_collapses_nodes(): void {\n    const c = this.c;\n    c.sparse_find = !c.sparse_find;\n    if (!g.unitTesting) {\n        g.es('sparse_find', c.sparse_find);\n    }\n}\n@cmd(\n    'toggle-find-ignore-case-option',\n    \"Toggle the 'Ignore Case' checkbox in the Find tab.\"\n)\npublic toggle_ignore_case_option(): void {\n    g.app.gui.setSearchSetting('ignoreCase');\n    // this.toggle_option('ignore_case');\n}\n@cmd(\n    'toggle-find-mark-changes-option',\n    \"Toggle the 'Mark Changes' checkbox in the Find tab.\"\n)\npublic toggle_mark_changes_option(): void {\n    g.app.gui.setSearchSetting('markChanges');\n    // this.toggle_option('mark_changes');\n}\n@cmd(\n    'toggle-find-mark-finds-option',\n    \"Toggle the 'Mark Finds' checkbox in the Find tab.\"\n)\npublic toggle_mark_finds_option(): void {\n    g.app.gui.setSearchSetting('markFinds');\n    // this.toggle_option('mark_finds');\n}\n@cmd(\n    'toggle-find-regex-option',\n    \"Toggle the 'Regexp' checkbox in the Find tab.\"\n)\npublic toggle_regex_option(): void {\n    g.app.gui.setSearchSetting('regExp');\n    // this.toggle_option('pattern_match');\n}\n@cmd(\n    'toggle-find-in-body-option',\n    \"Set the 'Search Body' checkbox in the Find tab.\"\n)\npublic toggle_search_body_option(): void {\n    g.app.gui.setSearchSetting('searchBody');\n    // this.toggle_option('search_body');\n}\n@cmd(\n    'toggle-find-in-headline-option',\n    \"Toggle the 'Search Headline' checkbox in the Find tab.\"\n)\npublic toggle_search_headline_option(): void {\n    g.app.gui.setSearchSetting('searchHeadline');\n    // this.toggle_option('search_headline');\n}\n@cmd(\n    'toggle-find-word-option',\n    \"Toggle the 'Whole Word' checkbox in the Find tab.\"\n)\npublic toggle_whole_word_option(): void {\n    g.app.gui.setSearchSetting('wholeWord');\n    // this.toggle_option('whole_word');\n}\n// # @cmd('toggle-find-wrap-around-option')\n// # public toggleWrapSearchOption(this, event):\n// # \"\"\"Toggle the 'Wrap Around' checkbox in the Find tab.\"\"\"\n// # return this.toggle_option('wrap')\n\npublic toggle_option(checkbox_name: string): void {\n    const c = this.c;\n    const fc = this.c.findCommands;\n    this.ftm.toggle_checkbox(checkbox_name);\n    // const options = fc.compute_find_options_in_status_area(); // ? NEEDED ?\n    // c.frame.statusLine.put(options); // ? NEEDED ?\n}\n",
    "felix.20251213133753.55": "@cmd(\n    'change-all',\n    'Replace all instances of the search string with the replacement string.'\n)\n@cmd(\n    'replace-all',\n    'Replace all instances of the search string with the replacement string.'\n)\npublic interactive_change_all(): Thenable<unknown> {\n    let w_searchString: string = this.ftm.find_findbox.text(); // this._lastSettingsUsed!.findText;\n    let w_replaceString: string = this.ftm.find_replacebox.text(); // this._lastSettingsUsed!.replaceText;\n\n    return g.app.gui.get1Arg({\n        title: \"Search for\",\n        prompt: \"Type text to search for and press enter.\",\n        placeHolder: \"Find pattern here\",\n        value: w_searchString === \"<find pattern here>\" ? '' : w_searchString\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return true; // Cancelled with escape or empty string.\n            }\n            w_searchString = p_findString;\n            return g.app.gui.get1Arg({\n                title: \"Replace with\",\n                prompt: \"Type text to replace with and press enter.\",\n                placeHolder: \"Replace pattern here\",\n                value: w_replaceString\n            }).then((p_replaceString) => {\n                if (p_replaceString === undefined) {\n                    return true;\n                }\n                w_replaceString = p_replaceString;\n                return false;\n            });\n        })\n        .then((p_cancelled: boolean) => {\n            if (!p_cancelled) {\n\n                this.ftm.set_find_text(w_searchString);\n                this.ftm.set_change_text(w_replaceString);\n\n                const w_changeSettings = this.ftm.get_settings();\n\n                const w_result = this.do_change_all(w_changeSettings);\n\n                this.c.widgetWantsFocusNow(this.c.frame.body.wrapper);\n\n                g.app.gui.loadSearchSettings();\n\n                return;\n\n            }\n        });\n\n}\n// def interactive_change_all(self, event: Event=None) -> None:  # pragma: no cover (interactive)\n//     \"\"\"Replace all instances of the search string with the replacement string.\"\"\"\n//     self.ftm.clear_focus()\n//     self.ftm.set_entry_focus()\n//     prompt = 'Replace Regex: ' if self.pattern_match else 'Replace: '\n//     self.start_state_machine(event, prompt,\n//         handler=self.interactive_replace_all1,\n//         # Allow either '\\t' or '\\n' to switch to the change text.\n//         escape_handler=self.interactive_replace_all1,\n//     )\n\n// def interactive_replace_all1(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     k = self.k\n//     find_pattern = k.arg\n//     self._sString = k.arg\n//     self.update_find_list(k.arg)\n//     regex = ' Regex' if self.pattern_match else ''\n//     prompt = f\"Replace{regex}: {find_pattern} With: \"\n//     k.setLabelBlue(prompt)\n//     self.add_change_string_to_label()\n//     k.getNextArg(self.interactive_replace_all2)\n\n// def interactive_replace_all2(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n\n//     # Update settings data.\n//     find_pattern = self._sString\n//     change_pattern = k.arg\n//     self.init_vim_search(find_pattern)\n//     self.update_change_list(change_pattern)\n//     # Compute settings...\n//     self.ftm.set_find_text(find_pattern)\n//     self.ftm.set_change_text(change_pattern)\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     # Do the command!\n//     self.do_change_all(settings)\n",
    "felix.20251213133753.56": "public do_change_all(settings: ISettings): number {\n    const c = this.c;\n    // Settings...\n    this.init_ivars_from_settings(settings);\n    if (!this.check_args('change-all')) {\n        return 0;\n    }\n    const n = this._change_all_helper(settings);\n    //\n    // #947, #880 and #722: Set ancestor @<file> nodes by brute force.\n    for (let p of c.all_positions()) {\n        if (\n            p.anyAtFileNodeName() &&\n            !p.v.isDirty() &&\n            [...p.subtree()].some((element) => element.v.isDirty())\n            // any(p2.v.isDirty() for p2 in p.subtree());\n        ) {\n            p.setDirty();\n        }\n    }\n    // c.redraw(); // ? NEEDED ?\n    return n;\n}\n",
    "felix.20251213133753.57": "/**\n * Do the change-all command. Return the number of changes, or 0 for error.\n */\nprivate _change_all_helper(settings: ISettings): number {\n    // Caller has checked settings.\n    const c = this.c;\n    const current = this.c.p;\n    const u = this.c.undoer;\n    const undoType = 'Replace All';\n    const t1 = g.process_time();\n    const saveData = this.save();\n    u.beforeChangeGroup(current, undoType);\n\n    // Fix bug 338172: ReplaceAll will not replace newlines\n    // indicated as \\n in target string.\n    if (!this.find_text) {\n        return 0;\n    }\n    if (!this.search_headline && !this.search_body) {\n        return 0;\n    }\n    this.change_text = this.replace_back_slashes(this.change_text);\n    if (this.pattern_match) {\n        const ok = this.compile_pattern();\n        if (!ok) {\n            return 0;\n        }\n    }\n\n    let positions: Position[];\n    // #1428: Honor limiters in replace-all.\n    if (this.node_only) {\n        positions = [c.p];\n    } else if (this.suboutline_only) {\n        positions = [...c.p.self_and_subtree()];\n    } else {\n        positions = [...c.all_unique_positions()];\n    }\n\n    let count = 0;\n    for (let p of positions) {\n        let count_h: number | false = 0;\n        let count_b: number | false = 0;\n        let new_h: string | undefined;\n        let new_b: string | undefined;\n        const undoData = u.beforeChangeNodeContents(p);\n        if (this.search_headline) {\n            [count_h, new_h] = this._change_all_search_and_replace(p.h);\n            if (count_h) {\n                count += count_h;\n                p.h = new_h!;\n            }\n        }\n        if (this.search_body) {\n            [count_b, new_b] = this._change_all_search_and_replace(p.b);\n            if (count_b) {\n                count += count_b;\n                p.b = new_b!;\n            }\n        }\n        if (count_h || count_b) {\n            u.afterChangeNodeContents(p, 'Replace All', undoData);\n            // Also check to honor 'Mark Changes' option\n            if (this.mark_changes && !p.isMarked()) {\n                const markUndoType = 'Mark Changes';\n                const bunch = u.beforeMark(p, markUndoType);\n                p.setMarked();\n                p.setDirty();\n                u.afterMark(p, markUndoType, bunch);\n            }\n        }\n    }\n\n    // suboutline-only is a one-shot for batch commands.\n    this.root = undefined;\n    this.node_only = false;\n    this.suboutline_only = false;\n    let p = c.p;\n    u.afterChangeGroup(p, undoType);\n    const t2 = g.process_time();\n    if (!g.unitTesting) {\n        g.es_print(\n            `changed ${count} instances${count} ` + `in ${t2 - t1} sec.`\n        );\n    }\n    // c.recolor(); // ? NEEDED ?\n    // c.redraw(p); // ? NEEDED ?\n    this.restore(saveData);\n\n    return count;\n}\n",
    "felix.20251213133753.58": "/**\n * Search s for this.find_text and replace with this.change_text.\n *\n * Return (found, new text)\n */\nprivate _change_all_search_and_replace(\n    s: string\n): [number | false, string | undefined] {\n    // This hack would be dangerous on MacOs: it uses '\\r' instead of '\\n' (!)\n    if (g.isWindows) {\n        // Ignore '\\r' characters, which may appear in @edit nodes.\n        // Fixes this bug: https://groups.google.com/forum/#!topic/leo-editor/yR8eL5cZpi4\n        //s = s.replace('\\r', '')\n        s = s.replace(/\\r/g, '');\n    }\n    if (!s) {\n        return [false, undefined];\n    }\n\n    // Order matters: regex matches ignore whole-word.\n    if (this.pattern_match) {\n        return this._change_all_regex(s);\n    }\n\n    if (this.whole_word) {\n        return this._change_all_word(s);\n    }\n\n    return this._change_all_plain(s);\n}\n",
    "felix.20251213133753.59": "/**\n * Perform all plain find/replace on s.\n * return (count, new_s)\n */\npublic _change_all_plain(s: string): [number, string] {\n    let find = this.find_text;\n    const change = this.change_text;\n    // #1166: s0 and find0 aren't affected by ignore-case.\n    const s0 = s;\n    const find0 = this.replace_back_slashes(find);\n    if (this.ignore_case) {\n        s = s0.toLowerCase();\n        find = find0.toLowerCase();\n    }\n    let count = 0;\n    let prev_i = 0;\n    let progress: number;\n    let result = [];\n    let i;\n    while (true) {\n        progress = prev_i;\n        // #1166: Scan using s and find.\n        i = s.indexOf(find, prev_i);\n        if (i === -1) {\n            break;\n        }\n        // #1166: Replace using s0 & change.\n        count += 1;\n        result.push(s0.substring(prev_i, i));\n        result.push(change);\n        prev_i = Math.max(prev_i + 1, i + find.length); // 2021/01/08 (!)\n        g.assert(prev_i > progress, prev_i.toString());\n    }\n\n    // #1166: Complete the result using s0.\n    result.push(s0.substring(prev_i));\n    return [count, result.join('')];\n}\n",
    "felix.20251213133753.60": "/**\n * Perform all regex find/replace on s.\n * return (count, new_s)\n */\npublic _change_all_regex(s: string): [number, string] {\n    let count = 0;\n    let prev_i = 0;\n    let result = [];\n\n    let flags = 'mgd';\n    if (this.ignore_case) {\n        flags += 'i';\n    }\n    const re = RegExp(this.find_text, flags);\n    // let m of re.finditer(this.find_text, s, flags)\n    for (let m; (m = re.exec(s)); null) {\n        count += 1;\n        const i = re.lastIndex - m[0].length; // m.start();\n        result.push(s.substring(prev_i, i));\n        // #1748.\n        // groups = m.groups(); // check if array more than one item instead\n        // see: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec\n        let change_text: string;\n        const groups = m.length > 1; // ! FLAG INSTEAD ! send m array result instead of groups !\n        if (groups) {\n            change_text = this.make_regex_subs(this.change_text, m); // ! send m array result instead of groups !\n        } else {\n            change_text = this.change_text;\n        }\n        result.push(change_text);\n        prev_i = re.lastIndex; // m.end();  // ? equivalent to lastIndex ?\n    }\n    // Compute the result.\n    result.push(s.substring(prev_i));\n    s = result.join('');\n    return [count, s];\n}\n",
    "felix.20251213133753.61": "/**\n * Perform all whole word find/replace on s.\n * return (count, new_s)\n */\npublic _change_all_word(s: string): [number, string] {\n    let find = this.find_text;\n    const change = this.change_text;\n    // #1166: s0 and find0 aren't affected by ignore-case.\n    const s0 = s;\n    const find0 = this.replace_back_slashes(find);\n    if (this.ignore_case) {\n        s = s0.toLowerCase();\n        find = find0.toLowerCase();\n    }\n    let count = 0;\n    let prev_i = 0;\n    const result = [];\n    while (true) {\n        // #1166: Scan using s and find.\n        const i = s.indexOf(find, prev_i);\n        if (i === -1) {\n            break;\n        }\n        // #1166: Replace using s0, change & find0.\n        result.push(s0.substring(prev_i, i));\n        if (g.match_word(s, i, find)) {\n            count += 1;\n            result.push(change);\n        } else {\n            result.push(find0);\n        }\n        prev_i = i + find.length;\n    }\n    // #1166: Complete the result using s0.\n    result.push(s0.substring(prev_i));\n    return [count, result.join('')];\n}\n",
    "felix.20251213133753.62": "@cmd(\n    'clone-find-all',\n    'clone-find-all (aka find-clone-all and cfa). ' +\n    'Create an organizer node whose descendants contain clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is *not* flattened: clones appear only once in the ' +\n    'descendants of the organizer node.'\n)\n@cmd(\n    'find-clone-all',\n    'clone-find-all (aka find-clone-all and cfa). ' +\n    'Create an organizer node whose descendants contain clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is *not* flattened: clones appear only once in the ' +\n    'descendants of the organizer node.'\n)\n@cmd(\n    'cfa',\n    'clone-find-all (aka find-clone-all and cfa). ' +\n    'Create an organizer node whose descendants contain clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is *not* flattened: clones appear only once in the ' +\n    'descendants of the organizer node.'\n)\npublic interactive_clone_find_all(): unknown {\n\n    let w_searchString: string = this.ftm.find_findbox.text(); // this._lastSettingsUsed!.findText;\n\n    return g.app.gui.get1Arg({\n        title: \"Search for\",\n        prompt: \"Type text to search for and press enter.\",\n        placeHolder: \"Find pattern here\",\n        value: w_searchString === \"<find pattern here>\" ? '' : w_searchString\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return; // Cancelled with escape or empty string.\n            }\n            this.ftm.set_find_text(p_findString);\n            const w_findSettings = this.ftm.get_settings();\n            const count = this.do_clone_find_all(w_findSettings);\n            if (count) {\n                this.c.treeWantsFocus();\n            }\n\n            g.app.gui.loadSearchSettings();\n\n            return count;\n\n        });\n\n}\n\n// def interactive_clone_find_all(self,\n//     event: Event=None,\n//     preloaded: bool=False,\n// ) -> None:  # pragma: no cover (interactive)\n//     \"\"\"\n//     clone-find-all ( aka find-clone-all and cfa).\n\n//     Create an organizer node whose descendants contain clones of all nodes\n//     matching the search string, except @nosearch trees.\n\n//     The list is *not* flattened: clones appear only once in the\n//     descendants of the organizer node.\n//     \"\"\"\n//     w = self.c.frame.body.wrapper\n//     if not w:\n//         return\n//     if not preloaded:\n//         self.preload_find_pattern(w)\n//     self.start_state_machine(event,\n//         prefix='Clone Find All: ',\n//         handler=self.interactive_clone_find_all1)\n\n// def interactive_clone_find_all1(self, event: Event) -> int:  # pragma: no cover (interactive)\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n//     # Settings...\n//     pattern = k.arg\n//     self.ftm.set_find_text(pattern)\n//     self.init_vim_search(pattern)\n//     self.init_in_headline()\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     count = self.do_clone_find_all(settings)\n//     if count:\n//         c.redraw()\n//         c.treeWantsFocus()\n//     return count\n",
    "felix.20251213133753.63": "/**\n * Do the clone-all-find commands from settings.\n *\n * Return the count of found nodes.\n *\n * This is a stand-alone method for unit testing.\n */\npublic do_clone_find_all(settings: ISettings): number {\n    this.init_ivars_from_settings(settings);\n    if (!this.check_args('clone-find-all')) {\n        return 0;\n    }\n    return this._cf_helper(settings, false);\n}\n",
    "felix.20251213133753.64": "@cmd(\n    'clone-find-all-flattened',\n    'clone-find-all-flattened (aka find-clone-all-flattened and cff). ' +\n    'Create an organizer node whose direct children are clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is flattened: every cloned node appears as a direct child ' +\n    'of the organizer node, even if the clone also is a descendant of ' +\n    'another cloned node.'\n)\n@cmd(\n    'find-clone-all-flattened',\n    'clone-find-all-flattened (aka find-clone-all-flattened and cff). ' +\n    'Create an organizer node whose direct children are clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is flattened: every cloned node appears as a direct child ' +\n    'of the organizer node, even if the clone also is a descendant of ' +\n    'another cloned node.'\n)\n@cmd(\n    'cff',\n    'clone-find-all-flattened (aka find-clone-all-flattened and cff). ' +\n    'Create an organizer node whose direct children are clones of all nodes ' +\n    'matching the search string, except @nosearch trees. ' +\n    'The list is flattened: every cloned node appears as a direct child ' +\n    'of the organizer node, even if the clone also is a descendant of ' +\n    'another cloned node.'\n)\npublic interactive_cff(): Thenable<unknown> {\n\n    let w_searchString: string = this.ftm.find_findbox.text(); // this._lastSettingsUsed!.findText;\n\n    return g.app.gui.get1Arg({\n        title: \"Search for\",\n        prompt: \"Type text to search for and press enter.\",\n        placeHolder: \"Find pattern here\",\n        value: w_searchString === \"<find pattern here>\" ? '' : w_searchString\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return; // Cancelled with escape or empty string.\n            }\n            this.ftm.set_find_text(p_findString);\n            const w_findSettings = this.ftm.get_settings();\n            const count = this.do_clone_find_all_flattened(w_findSettings);\n            if (count) {\n                this.c.treeWantsFocus();\n            }\n\n            g.app.gui.loadSearchSettings();\n\n            return count;\n\n        });\n\n\n\n}\n// def interactive_cff(self, event: Event=None, preloaded: bool=False) -> None:  # pragma: no cover (interactive)\n//     \"\"\"\n//     clone-find-all-flattened (aka find-clone-all-flattened and cff).\n\n//     Create an organizer node whose direct children are clones of all nodes\n//     matching the search string, except @nosearch trees.\n\n//     The list is flattened: every cloned node appears as a direct child\n//     of the organizer node, even if the clone also is a descendant of\n//     another cloned node.\n//     \"\"\"\n//     w = self.c.frame.body.wrapper\n//     if not w:\n//         return\n//     if not preloaded:\n//         self.preload_find_pattern(w)\n//     self.start_state_machine(event,\n//         prefix='Clone Find All Flattened: ',\n//         handler=self.interactive_cff1)\n\n// def interactive_cff1(self, event: Event) -> int:  # pragma: no cover (interactive)\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n//     # Settings...\n//     pattern = k.arg\n//     self.ftm.set_find_text(pattern)\n//     self.init_vim_search(pattern)\n//     self.init_in_headline()\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     count = self.do_clone_find_all_flattened(settings)\n//     if count:\n//         c.redraw()\n//         c.treeWantsFocus()\n//     return count\n",
    "felix.20251213133753.65": "/**\n * Do the clone-find-all-flattened command from the settings.\n *\n * Return the count of found nodes.\n *\n * This is a stand-alone method for unit testing.\n */\npublic do_clone_find_all_flattened(settings: ISettings): number {\n    this.init_ivars_from_settings(settings);\n    if (this.check_args('clone-find-all-flattened')) {\n        return this._cf_helper(settings, true);\n    }\n    return 0;\n}\n",
    "felix.20251213133753.66": "@cmd(\n    'clone-find-tag',\n    'clone-find-tag (aka find-clone-tag and cft). ' +\n    'Create an organizer node whose descendants contain clones of all ' +\n    'nodes matching the given tag, except @nosearch trees. ' +\n    'The list is always flattened: every cloned node appears as a ' +\n    'direct child of the organizer node, even if the clone also is a ' +\n    'descendant of another cloned node.'\n)\n@cmd(\n    'find-clone-tag',\n    'clone-find-tag (aka find-clone-tag and cft). ' +\n    'Create an organizer node whose descendants contain clones of all ' +\n    'nodes matching the given tag, except @nosearch trees. ' +\n    'The list is always flattened: every cloned node appears as a ' +\n    'direct child of the organizer node, even if the clone also is a ' +\n    'descendant of another cloned node.'\n)\n@cmd(\n    'cft',\n    'clone-find-tag (aka find-clone-tag and cft). ' +\n    'Create an organizer node whose descendants contain clones of all ' +\n    'nodes matching the given tag, except @nosearch trees. ' +\n    'The list is always flattened: every cloned node appears as a ' +\n    'direct child of the organizer node, even if the clone also is a ' +\n    'descendant of another cloned node.'\n)\npublic async interactive_clone_find_tag(): Promise<[number, Position] | undefined> {\n    const w_findText = this.ftm.find_findbox.text();\n    const w_startValue = w_findText === \"<find pattern here>\" ? '' : w_findText;\n\n    let w_inputResult = await g.app.gui.get1Arg(\n        {\n            value: w_startValue,\n            title: \"Find Tag\",\n            placeHolder: \"<tag>\",\n            prompt: \"Enter a tag name\",\n        }\n    );\n    if (w_inputResult && w_inputResult.trim()) {\n        w_inputResult = w_inputResult.trim();\n        this.find_text = w_inputResult;\n        this.c.treeWantsFocus();\n        return this.do_clone_find_tag(w_inputResult);\n    }\n}\n\n",
    "felix.20251213133753.67": "/**\n * Do the clone-all-find commands from settings.\n * Return (len(clones), found) for unit tests.\n */\npublic do_clone_find_tag(tag: string): [number, Position] {\n    const c = this.c;\n    const u = this.c.undoer;\n    const tc = c.theTagController;\n    if (!tc) {\n        if (!g.unitTesting) {\n            g.es_print('nodetags not active');\n        }\n        return [0, c.p];\n    }\n\n    const clones = tc.get_tagged_nodes(tag);\n    if (!clones || !clones.length) {\n        if (!g.unitTesting) {\n            g.es_print(`tag not found: ${tag}`);\n        }\n        tc.show_all_tags();\n        return [0, c.p];\n    }\n\n    const undoData = u.beforeInsertNode(c.p);\n    const found: Position = this._create_clone_tag_nodes(clones);\n    u.afterInsertNode(found, 'Clone Find Tag', undoData);\n    g.assert(c.positionExists(found, undefined, true), found.h);\n    c.setChanged();\n    c.selectPosition(found);\n    // c.redraw()\n    return [clones.length, found];\n}\n",
    "felix.20251213133753.68": "/**\n * Create a \"Found Tag\" node as the last node of the outline.\n * Clone all positions in the clones set as children of found.\n */\nprivate _create_clone_tag_nodes(clones: Position[]): Position {\n    const c = this.c;\n    const p = this.c;\n    // Create the found node.;\n    g.assert(\n        c.positionExists(c.lastTopLevel()),\n        c.lastTopLevel().toString()\n    );\n    const found = c.lastTopLevel().insertAfter();\n    g.assert(found && found.__bool__());\n    g.assert(c.positionExists(found), found.toString());\n    found.h = `Found Tag: ${this.find_text}`;\n    // Clone nodes as children of the found node.\n    for (let p of clones) {\n        // Create the clone directly as a child of found.\n        const p2 = p.copy();\n        const n = found.numberOfChildren();\n        p2._linkCopiedAsNthChild(found, n);\n    }\n    return found;\n}\n",
    "felix.20251213133753.69": "// * The interactive_find_all methods are not implemented\n// * '@cmd' commands @cmd('find-all'), etc,  are overriden in the UI client.\n// * do_find_all is intended to be called directly from the UI client instead.\n\n@cmd(\n    'find-all',\n    'Create a summary node containing descriptions of all matches of the' +\n    'search string.'\n)\npublic interactive_find_all(): Thenable<unknown> {\n\n    let w_searchString: string = this.ftm.find_findbox.text(); // this._lastSettingsUsed!.findText;\n\n    return g.app.gui.get1Arg({\n        title: \"Search for\",\n        prompt: \"Type text to search for and press enter.\",\n        placeHolder: \"Find pattern here\",\n        value: w_searchString === \"<find pattern here>\" ? '' : w_searchString\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return; // Cancelled with escape or empty string.\n            }\n\n            this.ftm.set_find_text(p_findString);\n\n            const w_changeSettings = this.ftm.get_settings();\n\n            const w_result = this.do_find_all(w_changeSettings);\n\n            this.c.widgetWantsFocusNow(this.c.frame.body.wrapper);\n\n            g.app.gui.loadSearchSettings();\n\n            return;\n        });\n\n\n\n}\n// def interactive_find_all(self, event: Event=None) -> None:  # pragma: no cover (interactive)\n//     \"\"\"\n//     Create a summary node containing descriptions of all matches of the\n//     search string.\n\n//     Typing tab converts this to the change-all command.\n//     \"\"\"\n//     self.ftm.clear_focus()\n//     self.ftm.set_entry_focus()\n//     self.start_state_machine(event, 'Search: ',\n//         handler=self.interactive_find_all1,\n//         escape_handler=self.find_all_escape_handler,\n//     )\n\n// def interactive_find_all1(self, event: Event=None) -> None:  # pragma: no cover (interactive)\n//     k = self.k\n//     # Settings.\n//     find_pattern = k.arg\n//     self.ftm.set_find_text(find_pattern)\n//     settings = self.ftm.get_settings()\n//     self.find_text = find_pattern\n//     self.change_text = self.ftm.get_change_text()\n//     self.update_find_list(find_pattern)\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     self.do_find_all(settings)\n\n// def find_all_escape_handler(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     k = self.k\n//     prompt = 'Replace ' + ('Regex' if self.pattern_match else 'String')\n//     find_pattern = k.arg\n//     self._sString = k.arg\n//     self.update_find_list(k.arg)\n//     s = f\"{prompt}: {find_pattern} With: \"\n//     k.setLabelBlue(s)\n//     self.add_change_string_to_label()\n//     k.getNextArg(self.find_all_escape_handler2)\n\n// def find_all_escape_handler2(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n//     find_pattern = self._sString\n//     change_pattern = k.arg\n//     self.update_change_list(change_pattern)\n//     self.ftm.set_find_text(find_pattern)\n//     self.ftm.set_change_text(change_pattern)\n//     self.init_vim_search(find_pattern)\n//     self.init_in_headline()\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     self.do_change_all(settings)\n",
    "felix.20251213133753.70": "/**\n * Top-level helper for find-all command.\n *\n *  Returns a dict of the form:\n *      {\n *          'distinct_body_lines': distinct_body_lines,\n *          'match_dict': matches_dict,\n *          'result_string': result_string,\n *          'total_matches': total_matches,\n *          'total_nodes': total_nodes,\n *      }\n *  where the matches_dict has the form:\n *      {\n *          'body': body,  # List of indices into v.b\n *          'head': head,  # List of indices into v.h\n *          'v': v,        # The vnode containing the mateches.\n *      }\n *\n */\npublic do_find_all(settings: ISettings): { [key: string]: any } {\n    this.init_ivars_from_settings(settings);\n    if (!this.check_args('find-all')) {\n        return {};\n    }\n    const result_dict = this._find_all_helper(settings);\n    // Suboutline-only is a one-shot for batch commands.\n    this.ftm.set_radio_button('entire-outline');\n    this.root = undefined;\n    this.node_only = this.suboutline_only = false;\n    return result_dict;\n}\n",
    "felix.20251213133753.71": "/**\n * Handle the find-all command from p to after.\n *\n * Return the List of Dicts describing each match.\n */\nprivate _find_all_helper(settings: ISettings): { [key: string]: any } {\n    const c = this.c;\n    const u = this.c.undoer;\n    const undoType = 'Find All';\n    const saveData = this.save();\n    if (this.pattern_match) {\n        const ok = this.compile_pattern();\n        if (!ok) {\n            return {};\n        }\n    }\n    // Create a list of vnodes, honoring limiters.\n    let vnodes: VNode[];\n    if (this.node_only) {\n        vnodes = [c.p.v];\n    } else if (this.suboutline_only) {\n        vnodes = [];\n        for (const z of c.p.self_and_subtree()) {\n            vnodes.push(z.v);\n        }\n        vnodes = [...new Set(vnodes)];\n    } else {\n        vnodes = [...c.all_unique_nodes()];\n    }\n\n    const matches_dict: { body: number[]; head: number[]; v: VNode }[] = [];\n    let distinct_body_lines, total_matches, total_nodes;\n    [distinct_body_lines, total_matches, total_nodes] = [0, 0, 0];\n    let body, head;\n\n    for (const v of vnodes) {\n        [body, head] = [[], []];\n        // Ignore @nosearch nodes.\n        if ([...g.splitLines(v.b)].some((z) => z.startsWith('@nosearch'))) {\n            continue;\n        }\n        if (this.search_body) {\n            body = this.find_all_matches_in_string(v.b);\n            total_matches += body.length;\n            // Update the distinct line numbers in this body.\n            let line_number_set = new Set();\n            let line_number, _unused;\n            for (const index of body) {\n                [line_number, _unused] = this.index_to_line_info(\n                    index,\n                    v.b\n                );\n                line_number_set.add(line_number);\n            }\n\n            distinct_body_lines += [...line_number_set].length;\n        }\n        if (this.search_headline) {\n            head = this.find_all_matches_in_string(v.h);\n            total_matches += head.length;\n        }\n        if (body.length || head.length) {\n            total_nodes += 1;\n            matches_dict.push({ body: body, head: head, v: v });\n        }\n    }\n\n    if (!matches_dict.length) {\n        // Not even one match found!\n        this.restore(saveData);\n        return {};\n    }\n    // Check first if need to make a 'group' undo bead\n    if (this.mark_finds) {\n        // Start an undo-group instead of a single 'InsertNode' undo\n        u.beforeChangeGroup(c.p, undoType);\n    }\n    // Create the result dict.\n    const result_string = this.make_result_from_matches(matches_dict);\n    // Create the summary node.\n    const undoData = u.beforeInsertNode(c.p);\n    const found_p = this.create_find_all_node(result_string);\n    u.afterInsertNode(found_p, undoType, undoData);\n    c.selectPosition(found_p);\n\n    if (this.mark_finds) {\n        for (const match of matches_dict) {\n            const p = c.vnode2position(match['v']);\n            if (p && !p.isMarked()) {\n                const markUndoType = 'Mark Finds';\n                const bunch = u.beforeMark(p, markUndoType);\n                p.setMarked();\n                p.setDirty();\n                u.afterMark(p, markUndoType, bunch);\n            }\n        }\n        // Finish undo group only if mark_finds is true\n        u.afterChangeGroup(found_p, undoType);\n    }\n    c.setChanged();\n    c.redraw();\n    // Return a dict containing the actual results and statistics.\n    return {\n        distinct_body_lines: distinct_body_lines,\n        match_dict: matches_dict,\n        result_string: result_string,\n        total_matches: total_matches,\n        total_nodes: total_nodes,\n    };\n}\n",
    "felix.20251213133753.72": "/**\n * Create a \"Found All\" node as the last node of the outline.\n */\nprivate create_find_all_node(result: string): Position {\n    const c = this.c;\n\n    const found = c.lastTopLevel().insertAfter();\n    g.assert(found && found.__bool__());\n    found.h = `find-all:${this.find_text}`;\n    let status = this.compute_result_status(true);\n    status = status.trim();\n    status = g.ltrim(status, '(');\n    status = g.rtrim(status, ')');\n    status = status.trim();\n    found.b = `@nosearch\\n# ${status}\\n${result}`;\n    return found;\n}\n",
    "felix.20251213133753.73": "private index_to_line_info(index: number, s: string): [number, string] {\n    let i, j;\n    [i, j] = g.getLine(s, index);\n    const line = s.substring(i, j);\n    let row, col;\n    [row, col] = g.convertPythonIndexToRowCol(s, i);\n    return [row + 1, line];\n}\n",
    "felix.20251213133753.74": "private make_result_from_matches(\n    matches: { body: number[]; head: number[]; v: VNode }[]\n): string {\n    const results: string[] = ['\\n'];\n    // Report settings.\n    results.push(\n        `  ignore-case: ${this.ignore_case}\\n`,\n        `        regex: ${this.pattern_match}\\n`,\n        `   whole-word: ${this.whole_word}\\n`,\n        `search string: ${this.find_text}\\n`\n    );\n    let body, head, v;\n    for (const d of matches) {\n        [body, head, v] = [d['body'], d['head'], d['v']];\n        if (head.length || body.length) {\n            results.push(`\\nnode: ${v.h}...\\n`);\n        }\n        if (head.length) {\n            results.push(`head: matches: ${head.length}\\n`);\n        }\n        if (body.length) {\n            results.push(`body: matches: ${body.length}\\n`);\n            const seen = new Set();\n            let n, line;\n            for (const i of body) {\n                [n, line] = this.index_to_line_info(i, v.b);\n                const item = JSON.stringify([n, line]);\n                if (!seen.has(item)) {\n                    seen.add(item);\n                    const line_col_s = `line ${n}, col ${i}`;\n                    results.push(`     ${line_col_s}: ${line.trimEnd()}\\n`);\n                    this.put_link(line, n, v);\n                }\n            }\n        }\n    }\n    return results.join('');\n}\n",
    "felix.20251213133753.75": "/**\n * Put a link to the given line at the given line_number in v.h.\n */\nprivate put_link(line: string, line_number: number, v: VNode): void {\n    const c = this.c;\n    // const log = c.frame.log // UNAVAILABLE IN LEOJS\n    this.total_links += 1;\n    if (this.total_links > 100) {\n        return;\n    }\n    // Find the first position with the given vnode.\n    let found;\n    for (const p of c.all_unique_positions()) {\n        if (p.v === v) {\n            found = p;\n            break;\n        }\n    }\n    if (!found) {\n        g.trace(`Can not happen: no position for ${v.gnx}`);\n        return;\n    }\n    const unl = found.get_UNL();\n\n    // TODO : Maybe Send to GOTO PANE ?\n    // TODO Test this !\n    g.es(line.trim() + `\\n ${unl}::${line_number - 1}`);\n    // log.put(line.strip() + '\\n', nodeLink=f\"{unl}::{line_number - 1}\")  // Local line.\n}\n",
    "felix.20251213133753.76": "/**\n * Find all matches in string s.\n *\n * Return a list of indices into s.\n */\nprivate find_all_matches_in_string(s: string): number[] {\n    // This hack would be dangerous on MacOs: it uses '\\r' instead of '\\n' (!)\n    if (g.isWindows) {\n        // Ignore '\\r' characters, which may appear in @edit nodes.\n        // Fixes this bug: https://groups.google.com/forum/#!topic/leo-editor/yR8eL5cZpi4\n        s = s.replace(/(\\r)/gm, '');\n    }\n    if (!s.trim()) {\n        return [];\n    }\n    const find_s = this.replace_back_slashes(this.find_text);\n    const f = this.pattern_match\n        ? this.find_all_regex\n        : this.find_all_plain;\n    return f.bind(this)(find_s, s);\n}\n",
    "felix.20251213133753.77": "/**\n * Perform all plain finds s, including whole-word finds.\n * return a list indices into s.\n */\npublic find_all_plain(find_s: string, s: string): number[] {\n    if (this.ignore_case) {\n        find_s = find_s.toLowerCase();\n        s = s.toLowerCase();\n    }\n    let i = 0;\n    let result: number[] = [];\n    // A line may contain more than one match.\n    while (i < s.length) {\n        i = s.indexOf(find_s, i);\n        if (i === -1) {\n            break;\n        }\n        if (\n            !this.whole_word ||\n            (this.whole_word && g.match_word(s, i, find_s))\n        ) {\n            result.push(i);\n        }\n        i += find_s.length;\n    }\n    return result;\n}\n",
    "felix.20251213133753.78": "/**\n * Perform all regex find/replace on s.\n * return a list of matching indices.\n */\npublic find_all_regex(find_s: string, s: string): number[] {\n    let flags = 'mgd';\n    if (this.ignore_case) {\n        flags += 'i';\n    }\n\n    // return [m.start() for m in re.finditer(find_s, s, flags)]\n    const re = RegExp(find_s, flags);\n    let result = [];\n    for (let m; (m = re.exec(s)); null) {\n        const i = re.lastIndex - m[0].length; // m.start();\n        result.push(i);\n    }\n    return result;\n}\n",
    "felix.20251213133753.79": "@cmd('re-search', 'Same as start-find, with regex.')\n@cmd('re-search-forward', 'Same as start-find, with regex.')\npublic interactive_re_search_forward(): Promise<unknown> {\n    return g.app.gui.interactiveSearch(false, true, false); // TODO : Move implementation here if possible.\n}\n// def interactive_re_search_forward(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     \"\"\"Same as start-find, with regex.\"\"\"\n//     # Set flag for show_find_options.\n//     self.pattern_match = True\n//     self.show_find_options()\n//     # Set flag for do_find_next().\n//     self.request_pattern_match = True\n//     # Go.\n//     self.start_state_machine(event,\n//         prefix='Regexp Search: ',\n//         handler=self.start_search1,  # See start-search\n//         escape_handler=self.start_search_escape1,  # See start-search\n//     )\n",
    "felix.20251213133753.80": "@cmd(\n    're-search-backward',\n    'Same as start-find, but with regex and in reverse.'\n)\npublic interactive_re_search_backward(): Promise<unknown> {\n    return g.app.gui.interactiveSearch(true, true, false); // TODO : Move implementation here if possible.\n}\n// def interactive_re_search_backward(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     \"\"\"Same as start-find, but with regex and in reverse.\"\"\"\n//     # Set flags for show_find_options.\n//     self.reverse = True\n//     self.pattern_match = True\n//     self.show_find_options()\n//     # Set flags for do_find_next().\n//     self.request_reverse = True\n//     self.request_pattern_match = True\n//     # Go.\n//     self.start_state_machine(event,\n//         prefix='Regexp Search Backward:',\n//         handler=self.start_search1,  # See start-search\n//         escape_handler=self.start_search_escape1,  # See start-search\n//     )\n\n",
    "felix.20251213133753.81": "@cmd('search-backward', 'Same as start-find, but in reverse.')\npublic interactive_search_backward(): Promise<unknown> {\n    return g.app.gui.interactiveSearch(true, false, false); // TODO : Move implementation here if possible.\n}\n// def interactive_search_backward(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     \"\"\"Same as start-find, but in reverse.\"\"\"\n//     # Set flag for show_find_options.\n//     self.reverse = True\n//     self.show_find_options()\n//     # Set flag for do_find_next().\n//     self.request_reverse = True\n//     # Go.\n//     self.start_state_machine(event,\n//         prefix='Search Backward: ',\n//         handler=self.start_search1,  # See start-search\n//         escape_handler=self.start_search_escape1,  # See start-search\n//     )\n",
    "felix.20251213133753.82": "@cmd(\n    'start-search',\n    'The default binding of Ctrl-F. Also contains default state-machine entries for find/change commands.'\n)\n@cmd(\n    'search-forward',\n    'The default binding of Ctrl-F. Also contains default state-machine entries for find/change commands.'\n)\npublic start_search(): void {\n    // GUI action that opens the find panel & focuses the 'find' text box.\n    g.app.gui.startSearch();\n}\n// def start_search(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     \"\"\"\n//     The default binding of Ctrl-F.\n\n//     Also contains default state-machine entries for find/change commands.\n//     \"\"\"\n//     w = self.c.frame.body.wrapper\n//     if not w:\n//         return\n//     self.preload_find_pattern(w)\n//     # #1840: headline-only one-shot\n//     #        Do this first, so the user can override.\n//     self.ftm.set_body_and_headline_checkbox()\n//     if self.minibuffer_mode:\n//         # Set up the state machine.\n//         self.ftm.clear_focus()\n//         self.findAllUniqueFlag = False\n//         self.ftm.set_entry_focus()\n//         self.start_state_machine(event,\n//             prefix='Search: ',\n//             handler=self.start_search1,\n//             escape_handler=self.start_search_escape1,\n//         )\n//     else:\n//         self.open_find_tab(event)\n//         self.ftm.init_focus()\n//         return\n\n// startSearch = start_search  # Compatibility. Do not delete.\n",
    "felix.20251213133753.83": "// def start_search1(self, event: Event=None) -> None:  # pragma: no cover\n//     \"\"\"Common handler for use by vim commands and other find commands.\"\"\"\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n//     # Settings...\n//     find_pattern = k.arg\n//     self.ftm.set_find_text(find_pattern)\n//     self.update_find_list(find_pattern)\n//     self.init_vim_search(find_pattern)\n//     self.init_in_headline()  # Required.\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     # Do the command!\n//     self.do_find_next(settings)  # Handles reverse.\n",
    "felix.20251213133753.84": "// def start_search_escape1(self, event: Event=None) -> None:  # pragma: no cover\n//     \"\"\"\n//     Common escape handler for use by find commands.\n\n//     Prompt for a change pattern.\n//     \"\"\"\n//     k = self.k\n//     self._sString = find_pattern = k.arg\n//     # Settings.\n//     k.getArgEscapeFlag = False\n//     self.ftm.set_find_text(find_pattern)\n//     self.update_find_list(find_pattern)\n//     self.find_text = find_pattern\n//     self.change_text = self.ftm.get_change_text()\n//     # Gui...\n//     regex = ' Regex' if self.pattern_match else ''\n//     backward = ' Backward' if self.reverse else ''\n//     prompt = f\"Replace{regex}{backward}: {find_pattern} With: \"\n//     k.setLabelBlue(prompt)\n//     self.add_change_string_to_label()\n//     k.getNextArg(self._start_search_escape2)\n\n",
    "felix.20251213133753.85": "// def _start_search_escape2(self, event: Event) -> None:  # pragma: no cover\n//     c, k, w = self.c, self.k, self.c.frame.body.wrapper\n//     # Compute settings...\n//     find_pattern = self._sString\n//     change_pattern = k.arg\n//     self.ftm.set_find_text(find_pattern)\n//     self.ftm.set_change_text(change_pattern)\n//     self.update_change_list(change_pattern)\n//     self.init_vim_search(find_pattern)\n//     self.init_in_headline()  # Required\n//     settings = self.ftm.get_settings()\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     c.widgetWantsFocusNow(w)\n//     self.do_find_next(settings)\n",
    "felix.20251213133753.86": "@cmd(\n    'summarize',\n    'Prompt for a regex and list all matches in a new top-level node.' +\n\n    'This command shows *only* m.group(0).' +\n    'Append `.*` to the pattern to see the remainder of the line.'\n)\npublic async summarize_command(): Promise<unknown> {\n\n    const pattern_s = await g.app.gui.get1Arg({\n        title: \"Summarize regex\",\n        placeHolder: \"<regex>\",\n        prompt: \"Enter a regex\",\n    });\n    const c = this.c;\n    // Get and check pattern.\n    if (!pattern_s || !pattern_s.trim()) {\n        g.es_print('no pattern');\n        return;\n    }\n    let re_pattern: RegExp;\n    try {\n        re_pattern = new RegExp(pattern_s);\n    } catch (e) {\n        g.es(`invalid regex: ${pattern_s}`);\n        return;\n    }\n    // Find all unique instances of pattern.\n    const results_set = new Set<string>();\n    for (const v of c.all_unique_nodes()) {\n        let match: RegExpExecArray | null;\n        while ((match = re_pattern.exec(v.b)) !== null) {\n            results_set.add(match[0]);\n        }\n    }\n    const results = Array.from(results_set).sort();\n    if (results.length > 0) {\n        // Create a top-level summary node.\n        const last = c.lastTopLevel();\n        const p = last.insertAfter();\n        p.h = `summarize: found ${results.length}: ${pattern_s}`;\n        const results_s = results.join('\\n');\n        p.b = `// summarize: ${pattern_s}\\n\\n${results_s}\\n`;\n        c.redraw();\n    } else {\n        // Report failure.\n        g.es(`summarize: not found: ${pattern_s}`);\n    }\n\n}\n\n",
    "felix.20251213133753.87": "@cmd('tag-node', 'Prompt for a tag for this node')\npublic interactive_tag_node(): Thenable<unknown> {\n\n    return g.app.gui.get1Arg({\n        title: \"Tag Node\",\n        placeHolder: \"<tag>\",\n        prompt: \"Enter a tag name\",\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return; // Cancelled with escape or empty string.\n            }\n            p_findString = p_findString.trim();\n            // check for special chars first\n            if (p_findString.split(/(&|\\||-|\\^)/).length > 1) {\n                void g.setStatusLabel('Cannot add tags containing any of these characters: &|^-');\n                return;\n            }\n\n            const c = this.c;\n            const tc = c.theTagController;\n            tc.add_tag(c.p, p_findString);\n        });\n\n}\n",
    "felix.20251213133753.88": "@cmd('remove-tag', 'Prompt for a tag to remove on selected node')\npublic remove_tag(): Thenable<unknown> {\n    const c = this.c;\n    const w_p = c.p;\n\n    if (w_p && w_p.u && w_p.u.__node_tags && w_p.u.__node_tags.length) {\n\n        return g.app.gui.get1Arg(\n            {\n                title: \"Remove Tag\",\n                placeHolder: \"<tag>\",\n                prompt: \"Enter a tag name\",\n            },\n            undefined,\n            w_p.u.__node_tags\n        )\n            .then((p_findString) => {\n                if (!p_findString) {\n                    return; // Cancelled with escape or empty string.\n                }\n                p_findString = p_findString.trim();\n\n                const v = w_p.v;\n                const tc = c.theTagController;\n                if (v.u && v.u['__node_tags']) {\n                    tc.remove_tag(w_p, p_findString);\n                }\n            });\n    }\n    return Promise.resolve();\n}\n\n",
    "felix.20251213133753.89": "@cmd('remove-all-tags', 'Remove all tags on selected node')\npublic remove_all_tags(): void {\n    const c = this.c;\n    const w_p = c.p;\n    if (w_p && w_p.u && w_p.u.__node_tags && w_p.u.__node_tags.length) {\n        const v = w_p.v;\n        const tc = c.theTagController;\n        if (v.u['__node_tags']) {\n            delete v.u['__node_tags'];\n            tc.initialize_taglist(); // reset tag list: some may have been removed\n            c.setChanged();\n        }\n    } else if (w_p) {\n        g.es('No tags on node: ' + w_p.h);\n    } else {\n        return;\n    }\n}\n",
    "felix.20251213133753.90": "@cmd('tag-children', 'Prompt for a tag and add it to all children of c.p.')\npublic interactive_tag_children(): Thenable<unknown> {\n    return g.app.gui.get1Arg({\n        title: \"Tag Children\",\n        placeHolder: \"<tag>\",\n        prompt: \"Enter a tag name\",\n    })\n        .then((p_findString) => {\n            if (!p_findString) {\n                return; // Cancelled with escape or empty string.\n            }\n            p_findString = p_findString.trim();\n            // check for special chars first\n            if (p_findString.split(/(&|\\||-|\\^)/).length > 1) {\n                void g.setStatusLabel('Cannot add tags containing any of these characters: &|^-');\n                return;\n            }\n            this.do_tag_children(this.c.p, p_findString);\n        });\n}\n\n//     \"\"\"tag-children: prompt for a tag and add it to all children of c.p.\"\"\"\n//     w = self.c.frame.body.wrapper\n//     if not w:\n//         return\n//     self.start_state_machine(event,\n//         prefix='Tag Children: ',\n//         handler=self.interactive_tag_children1)\n\n// def interactive_tag_children1(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     c, k, p = self.c, self.k, self.c.p\n//     # Settings...\n//     tag = k.arg\n//     # Gui...\n//     k.clearState()\n//     k.resetLabel()\n//     k.showStateAndMode()\n//     self.do_tag_children(p, tag)\n//     c.treeWantsFocus()\n",
    "felix.20251213133753.91": "/**\n * Handle the tag-children command.\n */\npublic do_tag_children(p: Position, tag: string): void {\n    const c = this.c;\n\n    const tc = c.theTagController;\n    if (!tc) {\n        if (!g.unitTesting) {\n            g.es_print('nodetags not active');\n        }\n        return;\n    }\n\n    let count = 0;\n    for (let p_p of p.children()) {\n        tc.add_tag(p_p, tag);\n        count += 1;\n    }\n    if (count && !g.unitTesting) {\n        g.es_print(`Added ${tag} tag to ${count} nodes`);\n    }\n}\n",
    "felix.20251213133753.92": "@cmd('word-search', 'Same as start-search, with whole_word setting.')\n@cmd(\n    'word-search-forward',\n    'Same as start-search, with whole_word setting.'\n)\npublic word_search_forward(): Promise<unknown> {\n    return g.app.gui.interactiveSearch(false, false, true); // TODO : Move implementation here if possible.\n}\n// @cmd('word-search')\n// @cmd('word-search-forward')\n// def word_search_forward(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     \"\"\"Same as start-search, with whole_word setting.\"\"\"\n//     # Set flag for show_find_options.\n//     self.whole_word = True\n//     self.show_find_options()\n//     # Set flag for do_find_next().\n//     self.request_whole_word = True\n//     # Go.\n//     self.start_state_machine(event,\n//         prefix='Word Search: ',\n//         handler=self.start_search1,  # See start-search\n//         escape_handler=self.start_search_escape1,  # See start-search\n//     )\n",
    "felix.20251213133753.93": "@cmd(\n    'word-search-backward',\n    'Same as start-search-backward, with whole_word setting.'\n)\npublic word_search_backward(): Promise<unknown> {\n    return g.app.gui.interactiveSearch(true, false, true); // TODO : Move implementation here if possible.\n}\n// def word_search_backward(self, event: Event) -> None:  # pragma: no cover (interactive)\n//     # Set flags for show_find_options.\n//     self.reverse = True\n//     self.whole_word = True\n//     self.show_find_options()\n//     # Set flags for do_find_next().\n//     self.request_reverse = True\n//     self.request_whole_word = True\n//     # Go\n//     self.start_state_machine(event,\n//         prefix='Word Search Backward: ',\n//         handler=self.start_search1,  # See start-search\n//         escape_handler=self.start_search_escape1,  # See start-search\n//     )\n",
    "felix.20251213133753.95": "/**\n * The common part of the clone-find commands.\n *\n * Return the number of found nodes.\n */\nprivate _cf_helper(settings: ISettings, flatten: boolean): number {\n    const c = this.c;\n    const u = this.c.undoer;\n\n    if (this.pattern_match) {\n        const ok = this.compile_pattern();\n        if (!ok) {\n            return 0;\n        }\n    }\n    let after: Position | undefined;\n    let p: Position;\n    if (this.suboutline_only) {\n        p = c.p;\n        after = p.nodeAfterTree();\n    } else {\n        p = c.rootPosition()!;\n        after = undefined;\n    }\n    let count = 0;\n    let found: Position | undefined;\n    const clones: Position[] = [];\n    const skip: VNode[] = [];\n\n    while (p && p.__bool__() && !p.__eq__(after)) {\n        const progress = p.copy();\n        if (g.inAtNosearch(p)) {\n            p.moveToNodeAfterTree();\n        } else if (skip.includes(p.v)) {\n            p.moveToThreadNext();\n        } else if (this._cfa_find_next_match(p)) {\n            count = count + 1;\n\n            if (flatten) {\n                if (!skip.includes(p.v)) {\n                    skip.push(p.v); // as a set\n                }\n                clones.push(p.copy());\n                p.moveToThreadNext();\n            } else {\n                if (\n                    // p not in clones\n                    clones.reduce((previous, current): boolean => {\n                        if (p.__eq__(current)) {\n                            return false; //is in it!\n                        }\n                        return previous;\n                    }, true)\n                ) {\n                    clones.push(p.copy()); // push if not already in.\n                }\n                // Don't look at the node or it's descendants.\n                for (let p2 of p.self_and_subtree(false)) {\n                    if (!skip.includes(p2.v)) {\n                        skip.push(p2.v); // as a set\n                    }\n                }\n                p.moveToNodeAfterTree();\n            }\n        } else {\n            p.moveToThreadNext();\n        }\n\n        g.assert(!p.__eq__(progress));\n    }\n\n    if (clones.length) {\n        const undoData = u.beforeInsertNode(c.p);\n        found = this._cfa_create_nodes(clones, false);\n        u.afterInsertNode(found, 'Clone Find All', undoData);\n        g.assert(\n            c.positionExists(found, undefined, true),\n            found.toString()\n        );\n        c.setChanged();\n        c.selectPosition(found);\n        // Put the count in found.h.\n        found.h = found.h.replace('Found:', `Found ${count}:`);\n    }\n\n    this.ftm.set_radio_button('entire-outline');\n    // suboutline-only is a one-shot for batch commands.\n    this.suboutline_only = false;\n    this.node_only = false;\n    this.root = undefined;\n    g.es(`found ${count}, matches for ${this.find_text}`);\n    return count; // Might be useful for the gui update.\n}\n",
    "felix.20251213133753.96": "/**\n * Create a \"Found\" node as the last node of the outline.\n * Clone all positions in the clones set a children of found.\n */\nprivate _cfa_create_nodes(\n    clones: Position[],\n    flattened: boolean\n): Position {\n    const c = this.c;\n    // Create the found node.\n    g.assert(\n        c.positionExists(c.lastTopLevel()),\n        c.lastTopLevel().toString()\n    );\n    const found: Position = c.lastTopLevel().insertAfter();\n    g.assert(found);\n    g.assert(c.positionExists(found), found.toString());\n    found.h = `Found:${this.find_text}`;\n    let status = this.compute_result_status(true);\n\n    status = status.trim();\n    // .lstrip('(')\n    // .rstrip(')')\n    status = status.replace(/^\\(+|\\)+$/g, '');\n    status = status.trim();\n\n    const flat = flattened ? 'flattened, ' : '';\n\n    const root = this.suboutline_only ? `\\n\\n# root: ${c.p.h}` : '';\n    found.b = `@nosearch\\n\\n# ${flat}${status}${root}\\n\\n# found ${clones.length} nodes`;\n\n    // Clone nodes as children of the found node.\n    for (let p of clones) {\n        // Create the clone directly as a child of found.\n        const p2 = p.copy();\n        const n = found.numberOfChildren();\n        p2._linkCopiedAsNthChild(found, n);\n    }\n\n    // Sort the clones in place, without undo.\n    found.v.children.sort((a, b) => {\n        // v.h.lower()\n        if (a.h.toLowerCase() < b.h.toLowerCase()) {\n            return -1;\n        }\n        if (a.h.toLowerCase() > b.h.toLowerCase()) {\n            return 1;\n        }\n        // a must be equal to b\n        return 0;\n    });\n    return found;\n}\n",
    "felix.20251213133753.97": "/**\n * Find the next batch match at p.\n */\nprivate _cfa_find_next_match(p: Position): boolean {\n    // Called only from unit tests.\n    const table = [];\n    if (this.search_headline) {\n        table.push(p.h);\n    }\n    if (this.search_body) {\n        table.push(p.b);\n    }\n    for (let s of table) {\n        this.reverse = false;\n        let pos: number;\n        let newpos: number;\n        [pos, newpos] = this.inner_search_helper(\n            s,\n            0,\n            s.length,\n            this.find_text\n        );\n        if (pos !== -1) {\n            return true;\n        }\n    }\n    return false;\n}\n",
    "felix.20251213133753.98": "/**\n * Replace selection with this.change_text.\n */\npublic change_selection(p: Position): boolean {\n    const c = this.c;\n    const u = this.c.undoer;\n    const wrapper = c.frame.body && c.frame.body.wrapper;\n    let gui_w = this.in_headline ? c.edit_widget(p) : wrapper;\n\n    if (!gui_w) {\n        this.in_headline = false;\n        gui_w = wrapper;\n    }\n    if (!gui_w) {\n        return false;\n    }\n\n    const sel: [number, number] = gui_w.getSelectionRange();\n    const oldSel: [number, number] = sel;\n    let start, end;\n    [start, end] = sel;\n    if (start > end) {\n        [start, end] = [end, start];\n    }\n    if (start === end) {\n        g.es('no text selected');\n        return false;\n    }\n\n    [start, end] = oldSel;\n    let change_text = this.change_text;\n\n    // Perform regex substitutions of \\1, \\2, ...\\9 in the change text.\n    if (this.pattern_match && this.match_obj) {\n        const groups = this.match_obj;\n        if (groups && groups.length) {\n            change_text = this.make_regex_subs(change_text, this.match_obj); // ! send m array result instead of groups !\n        }\n    }\n    change_text = this.replace_back_slashes(change_text);\n\n    // IF [start, end] EQUALS change_text -> skip change and no undo bead\n    if (gui_w.getAllText().substring(start, end) === change_text) {\n        g.es('same text as replacement');\n        return true; // Success but no actual change to body, nor undo created.\n    }\n\n    // Update both the gui widget and the work \"widget\"\n    const new_ins = this.reverse ? start : start + change_text.length;\n    const bunch = u.beforeChangeBody(p);\n\n    if (start !== end) {\n        gui_w.delete(start, end); // PERFORM REPLACE\n    }\n    gui_w.insert(start, change_text);\n    gui_w.setInsertPoint(new_ins);\n    this.work_s = gui_w.getAllText(); // #2220.\n    this.work_sel = [new_ins, new_ins, new_ins];\n\n    // Update the selection for the next match.\n    gui_w.setSelectionRange(start, start + change_text.length);\n    c.widgetWantsFocus(gui_w);\n\n    // No redraws here: they would destroy the headline selection.\n    if (this.in_headline) {\n        // #2220: Let onHeadChanged handle undo, etc.\n        c.frame.tree.onHeadChanged(p, 'Change Headline');\n\n        // gui_w will change after a redraw.\n        gui_w = c.edit_widget(p);\n        if (gui_w) {\n            // find-next and find-prev work regardless of insert point.\n            gui_w.setSelectionRange(start, start + change_text.length);\n        }\n    } else {\n        p.v.b = gui_w.getAllText();\n        u.afterChangeBody(p, 'Change Body', bunch);\n    }\n\n    if (this.mark_changes && !p.isMarked()) {\n        const undoType = 'Mark Changes';\n        const bunch = u.beforeMark(p, undoType);\n        p.setMarked();\n        p.setDirty();\n        u.afterMark(p, undoType, bunch);\n    }\n    return true;\n}\n",
    "felix.20251213133753.99": "/**\n * Check the user arguments to a command.\n */\npublic check_args(tag: string): boolean {\n    if (!this.search_headline && !this.search_body) {\n        if (!g.unitTesting) {\n            g.es_print('not searching headline or body');\n        }\n        return false;\n    }\n\n    if (!this.find_text) {\n        if (!g.unitTesting) {\n            g.es_print(`${tag}: empty find pattern`);\n        }\n        return false;\n    }\n    return true;\n}\n",
    "felix.20251213133753.100": "/**\n * Precompile the regexp pattern if necessary.\n */\npublic compile_pattern(): boolean {\n    let flags: string;\n    try {\n        // Precompile the regexp.\n\n        flags = 'mg'; // re.MULTILINE and g for global search.\n        if (this.ignore_case) {\n            flags = flags + 'i'; //|= re.IGNORECASE\n        }\n        // Escape the search text.\n        // Ignore the whole_word option.\n        const s = this.find_text;\n        // A bad idea: insert \\b automatically.\n        // b, s = '\\\\b', this.find_text\n        // if this.whole_word:\n        // if not s.startswith(b): s = b + s\n        // if not s.endswith(b): s = s + b\n        this.re_obj = new RegExp(s, flags); // re.compile(s, flags)\n        return true;\n    } catch (e) {\n        if (!g.unitTesting) {\n            g.warning('invalid regular expression:', this.find_text);\n        }\n        return false;\n    }\n}\n\n",
    "felix.20251213133753.101": "/**\n * Resume the search where it left off.\n *\n * Return (p, pos, newpos).\n */\npublic find_next_match(\n    p: Position | undefined\n): [Position | undefined, number | undefined, number | undefined] {\n    if (!this.search_headline && !this.search_body) {\n        return [undefined, undefined, undefined];\n    }\n    if (!this.find_text) {\n        return [undefined, undefined, undefined];\n    }\n    let attempts = 0;\n    const u = this.c.undoer;\n\n    let ok;\n    let pos;\n    let newpos;\n    if (this.pattern_match) {\n        ok = this.compile_pattern();\n        if (!ok) {\n            return [undefined, undefined, undefined];\n        }\n    }\n    while (p && p.__bool__()) {\n        [pos, newpos] = this._fnm_search(p);\n        if (pos !== undefined) {\n            // Success.\n            if (this.mark_finds && !p.isMarked()) {\n                const undoType = 'Mark Finds';\n                const bunch = u.beforeMark(p, undoType);\n                p.setMarked();\n                p.setDirty();\n                u.afterMark(p, undoType, bunch);\n            }\n            return [p, pos, newpos!];\n        }\n        let s: string;\n        let ins: number;\n        // Searching the pane failed: switch to another pane or node.\n        if (this._fnm_should_stay_in_node(p)) {\n            // Switching panes is possible.  Do so.\n            this.in_headline = !this.in_headline;\n            s = this.in_headline ? p.h : p.b;\n            ins = this.reverse ? s.length : 0;\n            this.work_s = s;\n            this.work_sel = [ins, ins, ins];\n        } else {\n            // Switch to the next/prev node, if possible.\n            attempts += 1;\n            p = this._fnm_next_after_fail(p);\n            if (p && p.__bool__()) {\n                // Found another node: select the proper pane.\n                this.in_headline = this._fnm_first_search_pane();\n                s = this.in_headline ? p.h : p.b;\n                ins = this.reverse ? s.length : 0;\n                this.work_s = s;\n                this.work_sel = [ins, ins, ins];\n            }\n        }\n    }\n    return [undefined, undefined, undefined];\n}\n",
    "felix.20251213133753.102": "/**\n * Return the next node after a failed search or undefined.\n */\nprivate _fnm_next_after_fail(p: Position): Position | undefined {\n    // Move to the next position.\n    p = this.reverse ? p.threadBack() : p.threadNext();\n    // Check it.\n    if (p && p.__bool__() && this._fail_outside_range(p)) {\n        return undefined;\n    }\n    if (!p || !p.__bool__()) {\n        return undefined;\n    }\n    return p;\n}\n",
    "felix.20251213133753.103": "/**\n * Return true; if the search is about to go outside its range, assuming\n * both the headline and body text of the present node have been searched.\n */\nprivate _fail_outside_range(p: Position): boolean {\n    const c = this.c;\n    if (!p || !p.__bool__()) {\n        return true;\n    }\n    if (this.node_only) {\n        return true;\n    }\n    if (this.suboutline_only || this.file_only) {\n        if (\n            this.root &&\n            !p.__eq__(this.root) &&\n            !this.root.isAncestorOf(p)\n        ) {\n            return true;\n        }\n    }\n    if (c.hoistStack && c.hoistStack.length) {\n        const bunch = c.hoistStack[c.hoistStack.length - 1];\n        if (!bunch.p.isAncestorOf(p)) {\n            g.trace('outside hoist', p.h);\n            g.warning('found match outside of hoisted outline');\n            return true;\n        }\n    }\n    return false; // Within range.\n}\n",
    "felix.20251213133753.104": "/**\n * Set return the value of this.in_headline\n * indicating which pane to search first.\n */\nprivate _fnm_first_search_pane(): boolean {\n    if (this.search_headline && this.search_body) {\n        // Fix bug 1228458: Inconsistency between Find-forward and Find-backward.\n        if (this.reverse) {\n            return false; // Search the body pane first.\n        }\n        return true; // Search the headline pane first.\n    }\n\n    if (this.search_headline || this.search_body) {\n        // Search the only enabled pane.\n        return this.search_headline;\n    }\n\n    g.trace('can not happen: no search enabled');\n    return false;\n}\n",
    "felix.20251213133753.105": "/**\n * Search this.work_s for this.find_text with present options.\n * Returns (pos, newpos) or (undefined, dundefined).\n */\nprivate _fnm_search(\n    p: Position\n): [number, number] | [undefined, undefined] {\n    let index = this.work_sel[2];\n    let s = this.work_s;\n\n    // This hack would be dangerous on MacOs: it uses '\\r' instead of '\\n' (!)\n    if (g.isWindows) {\n        // Ignore '\\r' characters, which may appear in @edit nodes.\n        // Fixes this bug: https://groups.google.com/forum/#!topic/leo-editor/yR8eL5cZpi4\n        s = s.replace(/\\r/g, '');\n    }\n    if (!s) {\n        return [undefined, undefined];\n    }\n    const stopindex = this.reverse ? 0 : s.length;\n\n    let pos;\n    let newpos;\n    [pos, newpos] = this.inner_search_helper(\n        s,\n        index,\n        stopindex,\n        this.find_text\n    );\n\n    if (this.in_headline && !this.search_headline) {\n        return [undefined, undefined];\n    }\n    if (!this.in_headline && !this.search_body) {\n        return [undefined, undefined];\n    }\n    if (pos === -1) {\n        return [undefined, undefined];\n    }\n\n    const ins = this.reverse\n        ? Math.min(pos, newpos)\n        : Math.max(pos, newpos);\n    this.work_sel = [pos, newpos, ins];\n\n    return [pos, newpos];\n}\n",
    "felix.20251213133753.106": "/**\n * Return True if the find should simply switch panes.\n */\nprivate _fnm_should_stay_in_node(p: Position): boolean {\n    // Errors here cause the find command to fail badly.\n    // Switch only if:\n    //   a) searching both panes and,\n    //   b) this is the first pane of the pair.\n    // There is * no way * this can ever change.\n    // So simple in retrospect, so difficult to see.\n    return (\n        this.search_headline &&\n        this.search_body &&\n        ((this.reverse && !this.in_headline) ||\n            (!this.reverse && this.in_headline))\n    );\n}\n",
    "felix.20251213133753.107": "/**\n * Dispatch the proper search method based on settings.\n */\npublic inner_search_helper(\n    s: string,\n    i: number,\n    j: number,\n    pattern: string\n): [number, number] {\n    const backwards = this.reverse;\n    const nocase = this.ignore_case;\n    const regexp = this.pattern_match;\n    const word = this.whole_word;\n\n    if (backwards) {\n        [i, j] = [j, i];\n    }\n    if (!s.substring(i, j) || !pattern) {\n        return [-1, -1];\n    }\n\n    let pos;\n    let newpos;\n\n    if (regexp) {\n        [pos, newpos] = this._inner_search_regex(\n            s,\n            i,\n            j,\n            pattern,\n            backwards,\n            nocase\n        );\n    } else if (backwards) {\n        [pos, newpos] = this._inner_search_backward(\n            s,\n            i,\n            j,\n            pattern,\n            nocase,\n            word\n        );\n    } else {\n        [pos, newpos] = this._inner_search_plain(\n            s,\n            i,\n            j,\n            pattern,\n            nocase,\n            word\n        );\n    }\n    return [pos, newpos];\n}\n",
    "felix.20251213133753.108": "private _rfind(\n    s: string,\n    pattern: string,\n    start: number,\n    end: number\n): number {\n    const w_s = s.substring(start, end); // will start just past i\n\n    let result = w_s.lastIndexOf(pattern);\n\n    if (result >= 0) {\n        result = result + start;\n    }\n    return result;\n}\n\n",
    "felix.20251213133753.109": "/**\n * rfind(sub [,start [,end]])\n *\n * Return the highest index in the string where substring sub is found,\n * such that sub is contained within s[start,end].\n *\n * Optional arguments start and end are interpreted as in slice notation.\n *\n * Return (-1, -1) on failure.\n */\npublic _inner_search_backward(\n    s: string,\n    i: number,\n    j: number,\n    pattern: string,\n    nocase: boolean,\n    word: boolean\n): [number, number] {\n    if (nocase) {\n        s = s.toLowerCase();\n        pattern = pattern.toLowerCase();\n    }\n    pattern = this.replace_back_slashes(pattern);\n    const n = pattern.length;\n    // Put the indices in range.  Indices can get out of range\n    // because the search code strips '\\r' characters when searching @edit nodes.\n    i = Math.max(0, i);\n    j = Math.min(s.length, j);\n    // short circuit the search: helps debugging.\n    if (s.indexOf(pattern) === -1) {\n        return [-1, -1];\n    }\n    let k: number;\n    if (word) {\n        while (1) {\n            // k = s.rfind(pattern, i, j)\n            k = this._rfind(s, pattern, i, j);\n\n            if (k === -1) {\n                break;\n            }\n            if (this._inner_search_match_word(s, k, pattern)) {\n                return [k, k + n];\n            }\n            j = Math.max(0, k - 1);\n        }\n        return [-1, -1];\n    }\n\n    // k = s.rfind(pattern, i, j)\n    k = this._rfind(s, pattern, i, j);\n\n    if (k === -1) {\n        return [-1, -1];\n    }\n    return [k, k + n];\n}\n",
    "felix.20251213133753.110": "/**\n * Do a whole-word search.\n */\nprivate _inner_search_match_word(\n    s: string,\n    i: number,\n    pattern: string\n): boolean {\n    pattern = this.replace_back_slashes(pattern);\n    return !!(s && pattern && g.match_word(s, i, pattern, this.ignore_case));\n\n    // if (!s || !pattern || !g.match(s, i, pattern)) {\n    //     return false;\n    // }\n\n    // let pat1;\n    // let pat2;\n    // [pat1, pat2] = [pattern[0], pattern[pattern.length - 1]];\n    // const n = pattern.length;\n    // const ch1 = 0 <= i - 1 && i - 1 < s.length ? s[i - 1] : '.';\n    // const ch2 = 0 <= i + n && i + n < s.length ? s[i + n] : '.';\n    // const isWordPat1 = g.isWordChar(pat1);\n    // const isWordPat2 = g.isWordChar(pat2);\n    // const isWordCh1 = g.isWordChar(ch1);\n    // const isWordCh2 = g.isWordChar(ch2);\n    // const inWord = (isWordPat1 && isWordCh1) || (isWordPat2 && isWordCh2);\n\n    // return !inWord;\n}\n",
    "felix.20251213133753.111": "/**\n * Do a plain search.\n */\npublic _inner_search_plain(\n    s: string,\n    i: number,\n    j: number,\n    pattern: string,\n    nocase: boolean,\n    word: boolean\n): [number, number] {\n    if (nocase) {\n        s = s.toLowerCase();\n        pattern = pattern.toLowerCase();\n    }\n\n    pattern = this.replace_back_slashes(pattern);\n    const n = pattern.length;\n    let k;\n\n    if (word) {\n        while (1) {\n            k = s.indexOf(pattern, i);\n            if (k === -1 || k + pattern.length > j) {\n                break;\n            }\n            if (this._inner_search_match_word(s, k, pattern)) {\n                return [k, k + n];\n            }\n            i = k + n;\n        }\n        return [-1, -1];\n    }\n    k = s.indexOf(pattern, i);\n\n    if (k === -1 || k + pattern.length > j) {\n        return [-1, -1];\n    }\n    return [k, k + n];\n}\n",
    "felix.20251213133753.112": "/**\n * Called from inner_search_helper\n */\npublic _inner_search_regex(\n    s: string,\n    i: number,\n    j: number,\n    pattern: string,\n    backwards: boolean,\n    nocase: boolean\n): [number, number] {\n    const re_obj = this.re_obj; // Use the pre-compiled object\n    if (!re_obj) {\n        if (!g.unitTesting) {\n            g.trace('can not happen: no re_obj');\n        }\n        return [-1, -1];\n    }\n\n    let last_mo = undefined;\n    let mo: RegExpExecArray | null | undefined;\n\n    if (backwards) {\n        // Scan to the last match using search here.\n        i = 0;\n        while (i < s.length) {\n            re_obj.lastIndex = i; // start up from i 'start'\n            mo = re_obj.exec(s);\n\n            if (!mo || re_obj.lastIndex > j) {\n                // no match or Busted past j 'end'\n                break;\n            }\n            i += 1;\n            last_mo = mo;\n        }\n        mo = last_mo;\n    } else {\n        // normal forward search\n        re_obj.lastIndex = i; // start up from i 'start'\n        mo = re_obj.exec(s);\n        if (re_obj.lastIndex > j) {\n            // if busted past j 'end'\n            mo = undefined;\n        }\n    }\n\n    if (mo) {\n        this.match_obj = mo;\n        return [mo.index, mo.index + mo[0].length];\n    }\n\n    this.match_obj = undefined;\n    return [-1, -1];\n}\n",
    "felix.20251213133753.113": "/**\n * Substitute group[i-1] for \\\\i strings in change_text.\n *\n * Groups is a tuple of strings, one for every matched group.\n */\npublic make_regex_subs(\n    change_text: string,\n    groups: RegExpExecArray\n): string {\n    // ! TODO : TEST THIS METHOD !\n    // ! see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#specifying_a_function_as_the_replacement\n\n    // ! for python: https://pynative.com/python-regex-capturing-groups/#:~:text=To%20capture%20all%20matches%20to%20a%20regex%20group%20we%20need,object%20and%20extract%20its%20value.\n\n    // g.printObj(list(groups), tag=f\"groups in {change_text!r}\")\n\n    /**\n     * re.sub calls this function once per group.\n     */\n    const repl = (match: string, p1: string, offset: number): string => {\n        // subgroup will be a number matched\n\n        // # 1494...\n        // group[0] is the whole match including all groups, group 1 is the first\n        const w_group = Number(p1);\n        const n = Number(p1) - 1;\n\n        if (0 <= n && n < groups.length - 1) {\n            // Executed only if the change text contains groups that match.\n            return groups[w_group]\n                .replace(/\\\\b/g, '\\\\\\\\b') // b\n                .replace(/\\\\f/g, '\\\\\\\\f') // f\n                .replace(/\\\\n/g, '\\\\\\\\n') // n\n                .replace(/\\\\r/g, '\\\\\\\\r') // r\n                .replace(/\\\\t/g, '\\\\\\\\t') // t\n                .replace(/\\\\w/g, '\\\\\\\\v'); // w\n        }\n        // No replacement.\n        return match; // in python group(0) is the whole match spanning all subgroups\n    };\n\n    const result = change_text.replace(/\\\\([0-9])/g, repl);\n\n    return result;\n}\n",
    "felix.20251213133753.114": "/**\n * Replace backslash-n with a newline and backslash-t with a tab.\n */\npublic replace_back_slashes(s: string): string {\n\n    // Replace backslash-n with a newline and backslash-t with a tab.\n    let i = 0;\n    const result: string[] = [];\n\n    while (i < s.length) {\n        const progress = i;\n        let ch = s[i];\n        i += 1;\n\n        if (ch !== '\\\\' || i >= s.length) {\n            result.push(ch);\n            continue;\n        }\n\n        ch = s[i];\n        i += 1;\n\n        if (ch === 'n') {\n            result.push('\\n');\n        } else if (ch === 't') {\n            result.push('\\t');\n        } else if (ch === 'f') {\n            result.push('\\f');\n        } else if (ch === '\\\\') {\n            // 4284\n            result.push(ch);\n            result.push(ch);\n        } else {\n            result.push('\\\\');\n            i -= 1;\n        }\n\n        g.assert(progress < i, \"Progress must advance in each iteration.\");\n    }\n\n    return result.join('');\n}\n",
    "felix.20251213133753.116": "/**\n * Select the first pane to search for incremental searches and changes.\n * This is called only at the start of each search.\n * This must not alter the current insertion point or selection range.\n */\npublic init_in_headline(): void {\n    // #1228458: Inconsistency between Find-forward and Find-backward.\n    if (this.search_headline && this.search_body) {\n        // We have no choice: we *must* search the present widget!\n        this.in_headline = this.focus_in_tree();\n    } else {\n        this.in_headline = this.search_headline;\n    }\n}\n",
    "felix.20251213133753.117": "/**\n * Return True is the focus widget w is anywhere in the tree pane.\n *\n * Note: the focus may be in the find pane.\n */\npublic focus_in_tree(): boolean {\n    const c = this.c;\n    const ftm = this.ftm;\n    const w = (ftm && ftm.entry_focus) || g.app.gui.get_focus();\n    if (ftm) {\n        ftm.entry_focus = undefined; // Only use this focus widget once!\n    }\n    const w_name = c.widget_name(w);\n    let val;\n    if (w === c.frame.body.wrapper) {\n        val = false;\n    } else if (w === c.frame.tree.treeWidget) {\n        val = true;\n    } else {\n        val = w_name.startsWith('head');\n    }\n    return val;\n}\n",
    "felix.20251213133753.118": "/**\n * Restore Leo's gui and settings from data, a g.Bunch.\n */\npublic restore(data: IFindUndoData): void {\n    const c = this.c;\n    const p = data.p;\n    // c.frame.bringToFront();  // Needed on the Mac\n\n    if (!p || !p.__bool__() || !c.positionExists(p)) {\n        // Better than selecting the root!\n        return;\n    }\n    c.selectPosition(p);\n    // Fix bug 1258373: https://bugs.launchpad.net/leo-editor/+bug/1258373\n    if (this.in_headline) {\n        c.treeWantsFocus();\n    } else {\n        // Looks good and provides clear indication of failure or termination.\n        const w = c.frame.body.wrapper;\n        w.setSelectionRange(data.start || 0, data.end || 0, data.insert);\n        w.seeInsertPoint();\n        c.widgetWantsFocus(w);\n    }\n}\n",
    "felix.20251213133753.119": "/**\n * Save everything needed to restore after a search fails.\n */\npublic save(): IFindUndoData {\n    const c = this.c;\n    let insert: number | undefined;\n    let start: number | undefined;\n    let end: number | undefined;\n\n    if (this.in_headline) {\n        // Fix bug 1258373: https://bugs.launchpad.net/leo-editor/+bug/1258373\n        // Don't try to re-edit the headline.\n        [insert, start, end] = [undefined, undefined, undefined];\n    } else {\n        const w = c.frame.body.wrapper;\n        insert = w.getInsertPoint();\n        [start, end] = w.getSelectionRange();\n    }\n    const data: IFindUndoData = {\n        end: end,\n        in_headline: this.in_headline,\n        insert: insert,\n        p: c.p.copy(),\n        start: start,\n    };\n\n    return data;\n}\n",
    "felix.20251213133753.120": "/**\n * Display the result of a successful find operation.\n */\npublic show_success(\n    p: Position,\n    pos: number,\n    newpos: number,\n    showState = true\n): any {\n    const c = this.c;\n    // Set state vars.\n    // Ensure progress in backwards searches.\n    const insert = this.reverse\n        ? Math.min(pos, newpos)\n        : Math.max(pos, newpos);\n    if (c.sparse_find) {\n        c.expandOnlyAncestorsOfNode(p);\n    }\n    let w: StringTextWrapper;\n\n    // TODO : Check if needed\n    if (this.in_headline) {\n        c.endEditing();\n        c.redraw(p);\n        c.frame.tree.editLabel(p); // <-- THIS SHOULD CREATE IT !\n        w = c.edit_widget(p) as StringTextWrapper; // #2220\n        if (w) {\n            w.setSelectionRange(pos, newpos, insert); // #2220\n        }\n    } else {\n        // Tricky code.  Do not change without careful thought.\n        w = c.frame.body.wrapper;\n        // *Always* do the full selection logic.\n        // This ensures that the body text is inited and recolored.\n        c.selectPosition(p);\n        c.bodyWantsFocus();\n        if (showState && c.k && c.k.showStateAndMode) {\n            c.k.showStateAndMode(w); // TODO : ? NEEDED ?\n        }\n        c.bodyWantsFocusNow();\n        w.setSelectionRange(pos, newpos, insert);\n        const k = g.see_more_lines(w.getAllText(), insert, 4);\n        w.see(k); // #78: find-next match not always scrolled into view.\n        c.outerUpdate(); // Set the focus immediately.\n        // if (c.vim_mode && c.vimCommands) {\n        //     c.vimCommands.update_selection_after_search();\n        // }\n    }\n\n    // // Support for the console gui.\n    g.app.gui.show_find_success(c, this.in_headline, insert, p);\n\n    // c.frame.bringToFront();\n    return w; // Support for isearch.\n}\n",
    "felix.20251213133753.122": "// ! USE CLIENT UI DIALOGS INSTEAD OF ORIGINAL LEO'S STATE_MACHINE\n// /**\n//  * Add an unprotected change string to the minibuffer label.\n//  */\n// public add_change_string_to_label(): void {\n//     const c = this.c;\n//     let s: string = this.ftm.get_change_text();\n//     // c.minibufferWantsFocus(); // No use in LeoJS\n//     while (s.endsWith('\\n') || s.endsWith('\\r')) {\n//         s = s.substring(0, s.length - 1);\n//     }\n//     // c.k.extendLabel(s, true, false);\n// }\n",
    "felix.20251213133753.123": "// ! USE CLIENT UI DIALOGS INSTEAD OF ORIGINAL LEO'S STATE_MACHINE\n// public add_find_string_to_label(protect = true): void {\n//     const c = this.c;\n//     // const k = this.c.k;\n//     const ftm = c.findCommands.ftm;\n//     let s = ftm.get_find_text();\n//     // c.minibufferWantsFocus(); // No use in LeoJS\n//     while (s.endsWith('\\n') || s.endsWith('\\r')) {\n//         s = s.substring(0, s.length - 1);\n//     }\n//     // k.extendLabel(s, true, protect);\n// }\n",
    "felix.20251213133753.124": "/**\n * Return the status to be shown in the status line after a find command completes.\n */\npublic compute_result_status(find_all_flag = false): string {\n    // Too similar to another method...\n    const status = [];\n    const table: [keyof LeoFind, string][] = [\n        ['whole_word', 'Word'],\n        ['ignore_case', 'Ignore Case'],\n        ['pattern_match', 'Regex'],\n        ['suboutline_only', '[Outline Only]'],\n        ['node_only', '[Node Only]'],\n        ['search_headline', 'Head'],\n        ['search_body', 'Body'],\n    ];\n\n    for (let [ivar, val] of table) {\n        if (this[ivar]) {\n            status.push(val);\n        }\n    }\n    return status.length ? ` (${status.join(', ')})` : '';\n}\n",
    "felix.20251213133753.125": "/**\n * Called from Find panel.  Redirect.\n */\npublic help_for_find_commands(): void {\n    console.log('TODO : help_for_find_commands');\n    // this.c.helpCommands.help_for_find_commands();\n}\n",
    "felix.20251213133753.126": "/**\n * Initialize searches in vim mode.\n */\npublic init_vim_search(pattern: string): void {\n    const c = this.c;\n    // if (c.vim_mode && c.vimCommands) {\n    //     c.vimCommands.update_dot_before_search(pattern, undefined); // A flag.\n    // }\n}\n",
    "felix.20251213133753.127": "/**\n * Preload the find pattern from the selected text of widget w.\n */\npublic preload_find_pattern(w: StringTextWrapper): void {\n    const c = this.c;\n    const ftm = this.ftm;\n    if (!c.config.getBool('preload-find-pattern', false)) {\n        // Make *sure* we don't preload the find pattern if it is not wanted.\n        return;\n    }\n    if (!w) {\n        return;\n    }\n    //\n    // #1436: Don't create a selection if there isn't one.\n    //        Leave the search pattern alone!\n    //\n    // if not w.hasSelection():\n    //     c.editCommands.extendToWord(event=None, select=True, w=w)\n    //\n    // #177:  Use selected text as the find string.\n    // #1436: Make make sure there is a significant search pattern.\n    const s = w.getSelectedText();\n    if (s.trim()) {\n        ftm.set_find_text(s);\n        ftm.init_focus();\n    }\n}\n",
    "felix.20251213133753.128": "/**\n * Show the find status the Find dialog, if present, and the status line.\n */\npublic show_status(found: boolean): void {\n    const c = this.c;\n    const status = found ? 'found' : 'not found';\n    const options = this.compute_result_status();\n    const s = `${status}:${options} ${this.find_text}`;\n    // Set colors.\n    const found_bg = c.config.getColor('find-found-bg') || 'blue';\n    const not_found_bg = c.config.getColor('find-not-found-bg') || 'red';\n    const found_fg = c.config.getColor('find-found-fg') || 'white';\n    const not_found_fg = c.config.getColor('find-not-found-fg') || 'white';\n    const bg = found ? found_bg : not_found_bg;\n    const fg = found ? found_fg : not_found_fg;\n    if (c.config.getBool('show-find-result-in-status') !== false) {\n        c.frame.putStatusLine(s, bg, fg);\n    }\n}\n",
    "felix.20251213133753.129": "/**\n * Show find options in the status area.\n */\npublic show_find_options_in_status_area(): void {\n    const c = this.c;\n    const s = this.compute_find_options_in_status_area();\n    c.frame.putStatusLine(s);\n}\n",
    "felix.20251213133753.130": "public compute_find_options_in_status_area(): string {\n    // TODO : REDO WITH APPROPRIATE GETTERS FROM VSCODE/LEOJS\n    const c = this.c;\n    const ftm = c.findCommands.ftm;\n    const table: [string, StringCheckBox][] = [\n        ['Word', ftm.check_box_whole_word],\n        ['Ig-case', ftm.check_box_ignore_case],\n        ['regeXp', ftm.check_box_regexp],\n        ['Body', ftm.check_box_search_body],\n        ['Head', ftm.check_box_search_headline],\n        // ['wrap-Around', ftm.check_box_wrap_around],\n        ['mark-Changes', ftm.check_box_mark_changes],\n        ['mark-Finds', ftm.check_box_mark_finds],\n    ];\n\n    // const result = [option for option, ivar in table if ivar.isChecked()]\n    const result = table\n        .filter((p_entry) => {\n            return p_entry[1].isChecked();\n        })\n        .map((p_entry) => {\n            return p_entry[0];\n        });\n\n    const table2: [string, StringRadioButton][] = [\n        ['Suboutline', ftm.radio_button_suboutline_only],\n        ['Node', ftm.radio_button_node_only],\n        ['File', ftm.radio_button_file_only],\n    ];\n    for (let [option, ivar] of table2) {\n        if (ivar.isChecked()) {\n            result.push(`[${option}]`);\n            break;\n        }\n    }\n    return `Find: ${result.join(' ')}`;\n}\n",
    "felix.20251213133753.131": "// ! USE CLIENT UI DIALOGS INSTEAD OF ORIGINAL LEO'S STATE_MACHINE\n\n// public start_state_machine(\n//     event: Event,\n//     prefix: str,\n//     handler: Callable,\n//     escape_handler: Callable = None,\n// ): void\n// \"\"\"\n//     Initialize and start the state machine used to get user arguments.\n// \"\"\"\n//     c, k = this.c, this.k\n// w = c.frame.body.wrapper\n// if not w:\n// return\n//     # Gui...\n// k.setLabelBlue(prefix)\n//     # New in Leo 5.2: minibuffer modes shows options in status area.\n// if this.minibuffer_mode:\n// this.show_find_options_in_status_area()\n//     elif c.config.getBool('use-find-dialog', default=True):\n// g.app.gui.openFindDialog(c)\n//     else:\n// c.frame.log.selectTab('Find')\n// this.add_find_string_to_label(protect = False)\n// k.getArgEscapes = ['\\t'] if escape_handler else[]\n// this.handler = handler\n// this.escape_handler = escape_handler\n//     # Start the state matching!\n// k.get1Arg(event, handler = this.state0, tabList = this.findTextList, completion = True)\n\n// public state0(, event: Event): void\n// \"\"\"Dispatch the next handler.\"\"\"\n// k = this.k\n// if k.getArgEscapeFlag:\n// k.getArgEscapeFlag = False\n// this.escape_handler(event)\n//     else:\n// this.handler(event)\n",
    "felix.20251213133753.132": "public update_change_list(s: string): void {\n    if (!this.changeTextList.includes(s)) {\n        this.changeTextList.push(s);\n    }\n}\n\npublic update_find_list(s: string): void {\n    if (!this.findTextList.includes(s)) {\n        this.findTextList.push(s);\n    }\n}\n",
    "felix.20251213133753.133": "/**\n * Frame for typescript client support\n */\n<< imports >>\n@others\n@language typescript\n@tabwidth -4\n",
    "felix.20251213133753.134": "import * as g from './leoGlobals';\nimport { LeoGui } from './leoGui';\nimport { Commands } from './leoCommands';\nimport { Position, VNode } from './leoNodes';\nimport { Chapter } from './leoChapters';\nimport { StringFindTabManager } from './findTabManager';\nimport { RClick, ScriptingController, build_rclick_tree } from './mod_scripting';\n\n",
    "felix.20251213133753.135": "export class LeoFrame {\n    public c: Commands;\n    public title: string;\n    public gui: LeoGui;\n    public iconBar: NullIconBarClass;\n    public initComplete = false;\n    public isNullFrame = false;\n    public toggle_unl_view = false;\n\n    public ftm!: StringFindTabManager; // added in finishCreate\n\n    public saved: boolean;\n    public startupWindow: boolean;\n    public log: any; // ! UNUSED !\n    public tree: NullTree;\n    public body: NullBody;\n    public tab_width: number = 0;\n\n    public w: number = 800;\n    public h: number = 500;\n    public x: number = 50;\n    public y: number = 50;\n    public ratio: number = 0.5;\n    public secondary_ratio: number = 0.5;\n\n    @others\n}\n",
    "felix.20251213133753.136": "constructor(c: Commands, title: string, gui: LeoGui) {\n    this.c = c;\n    this.title = title;\n    this.gui = gui;\n    this.saved = false;\n    this.startupWindow = false;\n    this.iconBar = new NullIconBarClass(c, undefined);\n    this.initComplete = true;\n    this.isNullFrame = true;\n\n    this.tree = new NullTree(this);\n    this.body = new NullBody(this);\n}\n",
    "felix.20251213133753.137": "public createFirstTreeNode(): void {\n    const c = this.c;\n    c.hiddenRootNode.children = [];\n\n    // #1817: Clear the gnxDict.\n    c.fileCommands.gnxDict = {};\n    //\n    //  Create the first node.\n    let v = new VNode(c);\n    let p = new Position(v);\n    v.initHeadString('NewHeadline');\n    //\n    //  New in Leo 4.5: p.moveToRoot would be wrong:\n    //                  the node hasn't been linked yet.\n    p._linkAsRoot();\n}\n\n",
    "felix.20251213133753.138": "public destroySelf(): void {\n    // console.log('TODO: FRAME DestroySelf');\n    // TODO : Check if needed (are subsriptions disposed?)\n}\n",
    "felix.20251213133753.139": "public finishCreate() {\n    const c = this.c;\n    if (!this.gui.isNullGui) {\n        g.app.windowList.push(this);\n    } else {\n        // console.log(\"Finished Creating Null Gui's frame\");\n    }\n    const ftm = new StringFindTabManager(c);\n    c.findCommands.ftm = ftm;\n    this.ftm = ftm;\n    // this.createFindTab(); // unused in leojs\n    this.createFirstTreeNode();\n}\n",
    "felix.20251213133753.140": "public getTitle(): string {\n    return this.title;\n}\npublic setTitle(title: string): void {\n    this.title = title;\n}\n",
    "felix.20251213133753.141": "/**\n * Return the geometry of the top window.\n */\npublic get_window_info(): [number, number, number, number] {\n    return [\n        this.w,\n        this.h,\n        this.x,\n        this.y\n    ];\n}\n\n",
    "felix.20251213133753.142": "/**\n * Set the tab width in effect for this frame.\n */\npublic setTabWidth(w: number): void {\n    // Subclasses may override this to affect drawing.\n    this.tab_width = w;\n}\n",
    "felix.20251213133753.143": "public setTopGeometry(w: number, h: number, x: number, y: number): void {\n\n    // Kept as-is in LeoJS.\n    if (isNaN(w)) {\n        console.log(\"ERROR setTopGeometry!!\");\n    }\n\n    this.w = w;\n    this.h = h;\n    this.x = x;\n    this.y = y;\n}\n",
    "felix.20251213133753.144": "/**\n * Resize splitter1 and splitter2 using the given ratios.\n */\npublic resizePanesToRatio(ratio: number, ratio2: number): void {\n    // Kept as-is in LeoJS.\n    this.ratio = ratio;\n    this.secondary_ratio = ratio2;\n}\n",
    "felix.20251213133753.145": "/**\n * Prompt the user to save changes.\n * Return True if the user vetoes the quit or save operation.\n */\npublic async promptForSave(): Promise<boolean> {\n    const c = this.c;\n    const theType = g.app.quitting ? 'quitting?' : 'closing?';\n    // See if we are in quick edit/save mode.\n    let root = c.rootPosition()!;\n    const quick_save =\n        !c.mFileName && !root.next().__bool__() && root.isAtEditNode();\n\n    let name: string;\n    if (quick_save) {\n        name = g.shortFileName(root.atEditNodeName());\n    } else {\n        name = c.mFileName ? c.mFileName : this.title;\n    }\n    const answer = await g.app.gui.runAskYesNoCancelDialog(\n        c,\n        'Confirm',\n        `Save changes to ${g.splitLongFileName(name)} before ${theType}`\n    );\n\n    if (answer === 'cancel') {\n        return true; // Veto.\n    }\n    if (answer === 'no') {\n        return false; // Don't save and don't veto.\n    }\n    if (!c.mFileName) {\n        const root = c.rootPosition()!;\n        if (!root.next().__bool__() && root.isAtEditNode()) {\n            // There is only a single @edit node in the outline.\n            // A hack to allow \"quick edit\" of non-Leo files.\n            // See https://bugs.launchpad.net/leo-editor/+bug/381527\n            // Write the @edit node if needed.\n            if (root.isDirty()) {\n                await c.atFileCommands.writeOneAtEditNode(root);\n            }\n            return false; // Don't save and don't veto.\n        }\n        c.mFileName = await g.app.gui.runSaveFileDialog(\n            c,\n            'Save',\n            [['Leo files', '*.leojs *.leo *.db']],\n        );\n\n        c.bringToFront();\n    }\n    if (c.mFileName) {\n        const ok = await c.fileCommands.save(c.mFileName);\n        return !ok; // Veto if the save did not succeed.\n    }\n    return true; // Veto.\n}\n",
    "felix.20251213133753.146": "/**\n * Return the tab width in effect at p.\n */\npublic scanForTabWidth(p: Position): void {\n    const c = this.c;\n    const tab_width = c.getTabWidth(p);\n    c.frame.setTabWidth(tab_width || 0);\n}\n",
    "felix.20251213133753.147": "public putStatusLine(s: string, bg?: string, fg?: string): void {\n    // TODO !\n    // console.log('TODO ? putStatusLine', s);\n}\n",
    "felix.20251213133753.148": "/**\n * Compute the UNL part of the status line.\n */\npublic computeStatusUnl(p: Position): string {\n    const c = this.c;\n    const kind = c.config.getString('unl-status-kind') || '';\n    const legacy = kind.toLowerCase() === 'legacy';\n    let method;\n    if (this.toggle_unl_view) {\n        // Show the UNL the opposite as indicated by settings.\n        method = legacy ? p.get_UNL.bind(p) : p.get_legacy_UNL.bind(p);\n    } else {\n        // Show the UNL per the settings.\n        method = legacy ? p.get_legacy_UNL.bind(p) : p.get_UNL.bind(p);\n    }\n    const s = method();\n    return s;\n}\n",
    "felix.20251213133753.149": "/**\n * Toggle view of UNLs.\n */\npublic toggleUnlView(): void {\n    const c = this.c;\n    // Toggle the switch.\n    this.toggle_unl_view = !this.toggle_unl_view;\n\n    // Redraw\n    // ! LEOJS WILL REDRAW !    \n    // const s = this.computeStatusUnl(c.p);\n    // this.put(s);\n    // this.update();\n\n}\n",
    "felix.20251213133753.150": "/**\n * A do-nothing body class.\n */\nexport class NullBody {\n    public c: Commands;\n    public frame: LeoFrame;\n    public insertPoint = 0;\n    public selection = [0, 0];\n    public s = ''; // The body text\n    public widget: any;\n    public wrapper: StringTextWrapper;\n    public use_chapters: boolean;\n    public editorWrappers: { [key: string]: any } = {};\n    // this.colorizer: Any = NullColorizer(this.c)  // A Union.\n\n    @others\n}\n\n",
    "felix.20251213133753.151": "constructor(frame: LeoFrame) {\n    this.c = frame.c;\n    frame.body = this;\n    this.frame = frame;\n    this.use_chapters = false;\n    this.widget = { _name: 'body' };\n    this.wrapper = new StringTextWrapper(this.c, 'body');\n    this.editorWrappers['1'] = this.wrapper;\n    // this.colorizer: Any = NullColorizer(this.c)  # A Union.\n}\n\n",
    "felix.20251213133753.152": "// # Birth, death...\n\n// def createControl(self, parentFrame: Widget, p: Position) -> Wrapper:\n//     pass\n// # Editors...\n\n// def addEditor(self, event: Event=None) -> None:\n//     pass\n\n// def assignPositionToEditor(self, p: Position) -> None:\n//     pass\n\n// def createEditorFrame(self, w: Widget) -> Widget:\n//     return None\n\n// def cycleEditorFocus(self, event: Event=None) -> None:\n//     pass\n\n// def deleteEditor(self, event: Event=None) -> None:\n//     pass\n\n// def selectEditor(self, w: Widget) -> None:\n//     pass\n\n// def selectLabel(self, w: Widget) -> None:\n//     pass\n\n// def setEditorColors(self, bg: str, fg: str) -> None:\n//     pass\n\n// def unselectLabel(self, w: Widget) -> None:\n//     pass\n\n// def updateEditors() -> None:\n//     pass\n// # Events...\n\n// def forceFullRecolor() -> None:\n//     pass\n\n// def scheduleIdleTimeRoutine(self, function: str, *args: str, **keys: str) -> None:\n//     pass\n// # Low-level gui...\n\n// def setFocus() -> None:\n//     pass\n",
    "felix.20251213133753.154": "public computeLabel(w: StringTextWrapper): string {\n    let s = w.leo_label_s;\n    if (w.leo_chapter !== undefined) {\n        s = `${w.leo_chapter.name}: ${s}`;\n    }\n    return s || '';\n}\n",
    "felix.20251213133753.155": "public createChapterIvar(w: StringTextWrapper): void {\n    const c = this.c;\n    const cc = c.chapterController;\n    if (!w.leo_chapter) {\n        if (cc && this.use_chapters) {\n            w.leo_chapter = cc.getSelectedChapter();\n        } else {\n            w.leo_chapter = undefined;\n        }\n    }\n}\n",
    "felix.20251213133753.156": "/**\n * Return True if w.leo_p exists or can be reconstituted.\n */\npublic ensurePositionExists(w: StringTextWrapper): boolean {\n    const c = this.c;\n    if (w.leo_p && c.positionExists(w.leo_p)) {\n        return true;\n    }\n    g.trace('***** does not exist', w.leo_name);\n    for (let p2 of c.all_unique_positions()) {\n        if (p2.v && p2.v === w.leo_v) {\n            w.leo_p = p2.copy();\n            return true;\n        }\n    }\n    // This *can* happen when selecting a deleted node.\n    w.leo_p = c.p;\n    return false;\n}\n",
    "felix.20251213133753.157": "/**\n * select w.leo_chapter.\n */\npublic switchToChapter(w: StringTextWrapper): void {\n    const c = this.c;\n    const cc = c.chapterController;\n    if (w.leo_chapter !== undefined) {\n        const chapter = w.leo_chapter;\n        const name = chapter && chapter.name;\n        const oldChapter = cc.getSelectedChapter();\n        if (chapter !== oldChapter) {\n            cc.selectChapterByName(name);\n            c.bodyWantsFocus();\n        }\n    }\n}\n",
    "felix.20251213133753.158": "// Called from addEditor and assignPositionToEditor.\n\n/**\n * Inject updated ivars in w, a gui widget.\n */\npublic updateInjectedIvars(w: StringTextWrapper, p: Position): void {\n    if (!w) {\n        return;\n    }\n    const c = this.c;\n    const cc = c.chapterController;\n    // Was in ctor.\n    const use_chapters = c.config.getBool('use-chapters');\n    if (cc && use_chapters) {\n        w.leo_chapter = cc.getSelectedChapter();\n    } else {\n        w.leo_chapter = undefined;\n    }\n    w.leo_p = p.copy();\n    w.leo_v = w.leo_p.v;\n    w.leo_label_s = p.h;\n}\n",
    "felix.20251213133753.160": "/**\n * Return before, after where:\n * \n * before is all the lines before the line containing the insert point.\n * sel is the line containing the insert point.\n * after is all the lines after the line containing the insert point.\n * \n * All lines end in a newline, except possibly the last line.\n */\npublic getInsertLines(): [string, string, string] {\n    const body = this;\n    const w = body.wrapper;\n    const s = w.getAllText();\n    const insert = w.getInsertPoint();\n    const [i, j] = g.getLine(s, insert);\n    let before = s.substring(0, i);\n    let ins = s.substring(i, j);\n    let after = s.substring(j);\n    before = g.checkUnicode(before);\n    ins = g.checkUnicode(ins);\n    after = g.checkUnicode(after);\n    return [before, ins, after];\n}\n",
    "felix.20251213133753.161": "/**\n * Return before, sel, after where:\n * \n * before is the text before the selected text\n * (or the text before the insert point if no selection)\n * sel is the selected text (or \"\" if no selection)\n * after is the text after the selected text\n * (or the text after the insert point if no selection)\n */\npublic getSelectionAreas(): [string, string, string] {\n    const body = this;\n    const w = body.wrapper;\n    const s = w.getAllText();\n    let [i, j] = w.getSelectionRange();\n    if (i === j) {\n        j = i + 1;\n    }\n    let before = s.substring(0, i);\n    let sel = s.substring(i, j);\n    let after = s.substring(j);\n    before = g.checkUnicode(before);\n    sel = g.checkUnicode(sel);\n    after = g.checkUnicode(after);\n    return [before, sel, after];\n}\n",
    "felix.20251213133753.162": "/**\n *         Return before,sel,after where:\n *\n * before is the all lines before the selected text\n * (or the text before the insert point if no selection)\n * sel is the selected text (or \"\" if no selection)\n * after is all lines after the selected text\n * (or the text after the insert point if no selection)\n */\npublic getSelectionLines(): [string, string, string] {\n    if (g.app.batchMode) {\n        return ['', '', ''];\n    }\n    // At present, called only by c.getBodyLines.\n    const body = this;\n    const w = body.wrapper;\n    const s = w.getAllText();\n    let i, j, junk;\n    [i, j] = w.getSelectionRange();\n    if (i === j) {\n        [i, j] = g.getLine(s, i);\n    } else {\n        // #1742: Move j back if it is at the start of a line.\n        if (j > i && j > 0 && s[j - 1] === '\\n') {\n            j -= 1;\n        }\n        [i, junk] = g.getLine(s, i);\n        [junk, j] = g.getLine(s, j);\n    }\n    const before = g.checkUnicode(s.substring(0, i));\n    const sel = g.checkUnicode(s.substring(i, j));\n    const after = g.checkUnicode(s.substring(j, s.length));\n    return [before, sel, after]; // 3 strings.\n}\n",
    "felix.20251213133753.163": "export class nullButtonWidget {\n    public c: Commands;\n    public command: any;\n    public name: string;\n    public text: string;\n    public rclicks: RClick[] | undefined;\n    constructor(c: Commands, command: any, name: string, text: string) {\n        this.c = c;\n        this.command = command;\n        this.name = name;\n        this.text = text;\n    }\n    toString(): string {\n        return this.name;\n    }\n    valueOf(): string {\n        return this.name;\n    }\n\n}\n",
    "felix.20251213133753.164": "/**\n * A class representing the singleton Icon bar.\n */\nexport class NullIconBarClass {\n    c: Commands;\n    iconFrame: any | null;\n    parentFrame: any;\n    w: any;\n\n    @others\n\n}\n",
    "felix.20251213133753.165": "/**\n * Ctor for NullIconBarClass.\n */\nconstructor(c: Commands, parentFrame: any) {\n    this.c = c;\n    this.iconFrame = null;\n    this.parentFrame = parentFrame;\n    this.w = new g.NullObject();\n}\n",
    "felix.20251213133753.166": "public addRow(height?: string): void {\n    // No operation\n}\n\npublic addRowIfNeeded(): void {\n    // No operation\n}\n\npublic addWidget(w: any): void {\n    // No operation\n}\n\npublic createChaptersIcon(): void {\n    // No operation\n}\n\npublic deleteButton(w: any): void {\n    // No operation\n}\n\npublic getNewFrame(): any {\n    return undefined;\n}\n\npublic hide(): void {\n    // No operation\n}\n\npublic show(): void {\n    // No operation\n}\n",
    "felix.20251213133753.167": "/**\n * Add a (virtual) button to the (virtual) icon bar.\n */\npublic add(text: string, command?: (...args: any[]) => any, kind?: string,): nullButtonWidget {\n    try {\n        g.app.iconWidgetCount += 1;\n    } catch (e) {\n        g.app.iconWidgetCount = 1;\n    }\n    let n = g.app.iconWidgetCount;\n    let w_name = `nullButtonWidget ${n}`;\n    if (!command) {\n        const commandCallback = (p_name: string = w_name) => {\n            g.pr(`command for ${p_name}`);\n        };\n        command = commandCallback;\n    }\n    const b = new nullButtonWidget(this.c, command, w_name, text);\n    return b;\n}\n\n",
    "felix.20251213133753.168": "public clear(): void {\n    g.app.iconWidgetCount = 0;\n    g.app.iconImageRefs = [];\n}\n",
    "felix.20251213133753.169": "public setCommandForButton(\n    button: nullButtonWidget,\n    command: () => any,\n    command_p: Position,\n    controller: ScriptingController,\n    gnx: string,\n    script?: string\n): void {\n    button.command = command;\n    try {\n        const rclicks = build_rclick_tree(command_p, undefined, true);\n        button.rclicks = rclicks;\n    } catch (e) {\n        // No operation\n    }\n}\n",
    "felix.20251213133753.170": "/**\n * A do-almost-nothing tree class.\n */\nexport class NullTree {\n    public frame: LeoFrame;\n    public canvas = { name: 'tree' };\n    // New in 3.12: keys vnodes, values are edit_widgets.\n    // New in 4.2: keys are vnodes, values are pairs (p,edit widgets).\n    public edit_text_dict: { [key: string]: [Position, any] };\n    // \"public\" ivars: correspond to setters & getters.\n    public drag_p: Position | undefined;\n    public generation: number; // low-level vnode methods increment public count.\n    public redrawCount: number; // For traces\n    public updateCount: number;\n    public use_chapters: boolean; // May be overridden in subclasses.\n\n    public c: Commands;\n    public editWidgetsDict: { [key: string]: StringTextWrapper }; // Keys are vnodes, values are StringTextWidgets.\n    // public font = undefined;\n    // public fontName = undefined;\n    public treeWidget: g.NullObject | any;\n\n    @others\n}\n",
    "felix.20251213133753.171": "constructor(frame: LeoFrame) {\n    this.frame = frame;\n\n    // New in 3.12: keys vnodes, values are edit_widgets.\n    // New in 4.2: keys are vnodes, values are pairs (p,edit widgets).\n    this.edit_text_dict = {};\n    // \"public\" ivars: correspond to setters & getters.\n    this.drag_p = undefined;\n    this.generation = 0; // low-level vnode methods increment this count.\n    this.redrawCount = 0; // For traces\n    this.use_chapters = false; // May be overridden in subclasses.\n\n    this.c = frame.c;\n    this.editWidgetsDict = {}; // Keys are vnodes, values are StringTextWidgets.\n    // this.font = undefined;\n    // this.fontName = undefined;\n    // this.canvas = undefined;\n    this.treeWidget = { _name: 'tree' }; // new g.NullObject();\n    this.redrawCount = 0;\n    this.updateCount = 0;\n}\n",
    "felix.20251213133753.172": "/**\n * End editing of a headline and update p.h.\n */\npublic endEditLabel(): void {\n    // Important: this will redraw if necessary.\n    this.onHeadChanged(this.c.p);\n    // ! LEOJS: Mimic qt_tree\n    const d = this.editWidgetsDict;\n    if (d[this.c.p.v.gnx]) {\n        delete d[this.c.p.v.gnx];\n    }\n}\n",
    "felix.20251213133753.173": "\n/**\n * Officially change a headline.\n * Set the old undo text to the previous revert point.\n */\npublic onHeadChanged(p: Position, undoType = 'Typing'): void {\n    const c = this.c;\n    const u = this.c.undoer;\n    const w = this.edit_widget(p);\n    if (!w) {\n        // g.trace('no w');\n        return;\n    }\n    const ch = '\\n'; // We only report the final keystroke.\n    let s = w.getAllText();\n    << truncate s if it has multiple lines >>\n\n    // Make the change official, but undo to the *old* revert point.\n    const changed = s !== p.h;\n    if (!changed) {\n        return; // Leo 6.4: only call the hooks if the headline has actually changed.\n    }\n    if (g.doHook(\"headkey1\", { c: c, p: p, ch: ch, changed: changed })) {\n        return;  // The hook claims to have handled the event.\n    }\n    // Handle undo.\n    const undoData = u.beforeChangeHeadline(p);\n    p.initHeadString(s); // change p.h *after* calling undoer's before method.\n    if (!c.changed) {\n        c.setChanged();\n    }\n    // New in Leo 4.4.5: we must recolor the body because\n    // the headline may contain directives.\n    c.frame.scanForTabWidth(p);\n    // c.recolor(p); // ? Not Needed with leojs/vscode ?\n    p.setDirty();\n    u.afterChangeHeadline(p, undoType, undoData);\n    // Fix bug 1280689: don't call the non-existent c.treeEditFocusHelper\n    c.redraw_after_head_changed();\n    g.doHook(\"headkey2\", { c: c, p: p, ch: ch, changed: changed });\n}\n",
    "felix.20251213133753.174": "// Remove trailing newlines before warning of truncation.\nwhile (s && s[s.length - 1] === '\\n') {\n    s = s.substring(0, s.length - 1);\n}\n// Warn if there are multiple lines.\nconst i = s.indexOf('\\n');\nif (i > -1) {\n    g.warning('truncating headline to one line');\n    s = s.substring(0, i);\n}\nconst limit = 1000;\nif (s.length > limit) {\n    g.warning('truncating headline to ' + limit + ' characters');\n    s = s.substring(0, limit);\n}\ns = g.checkUnicode(s || '');\n\n",
    "felix.20251213133753.175": "/**\n * Select a node.\n * Never redraws outline, but may change coloring of individual headlines.\n * The scroll argument is used by the gui to suppress scrolling while dragging.\n */\npublic select(p: Position): void {\n    //\n    // c.nodeHistory.update(p); // ! FROM select_new_node of tree wrapper 'select'\n\n    const trace = g.app.debug.includes('select') && !g.unitTesting;\n    const tag = 'LeoTree.select';\n    const c = this.c;\n    if (g.app.killed) {\n        return;\n    }\n    if (trace) {\n        console.log(`----- ${tag}: ${p.h}`);\n        // print(f\"{tag:>30}: {c.frame.body.wrapper} {p.h}\")\n        // Format matches traces in leoflexx.py\n        // print(f\"{tag:30}: {len(p.b):4} {p.gnx} {p.h}\")\n    }\n\n    try {\n        // this.tree_select_lockout = true;\n        // this.prev_v = c.p.v\n        this.selectHelper(p);\n    } finally {\n        // this.tree_select_lockout = False\n        if (c.enableRedrawFlag) {\n            p = c.p;\n            // Don't redraw during unit testing: an important speedup.\n            if (c.expandAllAncestors(p) && !g.unitTesting) {\n                // This can happen when doing goto-next-clone.\n                c.redraw_later(); // This *does* happen sometimes.\n            } else {\n                c.outerUpdate(); // Bring the tree up to date.\n                // ! NOT USED IN LEOJS\n                // if (this.setItemForCurrentPosition){\n                //     // pylint: disable=no-member\n                //     this.setItemForCurrentPosition();\n                // }\n            }\n        } else {\n            c.requestLaterRedraw = true;\n        }\n    }\n}\n\n",
    "felix.20251213133753.176": "/**\n *  A helper function for leoTree.select.\n * Do **not** \"optimize\" this by returning if p==c.p!\n */\npublic selectHelper(p: Position): void {\n    if (!p || !p.__bool__()) {\n        // This is not an error! We may be changing roots.\n        // Do *not* test c.positionExists(p) here!\n        return;\n    }\n    const c = this.c;\n    if (!c.frame.body.wrapper) {\n        return; // Defensive.\n    }\n    if (p.v.context !== c) {\n        // Selecting a foreign position will not be pretty.\n        g.trace(`Wrong context: ${p.v.context} != ${c}`);\n        return;\n    }\n    const old_p = c.p;\n    const call_event_handlers = !p.__eq__(old_p);\n    // Order is important...\n    // 1. Call c.endEditLabel.\n    this.unselect_helper(old_p, p);\n\n    // 2. Call set_body_text_after_select.\n    this.select_new_node(old_p, p);\n\n    // 3. Call c.undoer.onSelect.\n    this.change_current_position(old_p, p);\n\n    // 4. Set cursor in body.\n    this.scroll_cursor(p);\n\n    // 5. Last tweaks.\n    // TODO : NEEDED ? PERFORMANCE  ?\n    // this.set_status_line(p);\n\n    if (call_event_handlers) {\n        g.doHook('select2', {\n            c: c,\n            new_p: p,\n            old_p: old_p,\n            new_v: p,\n            old_v: old_p,\n        });\n        g.doHook('select3', {\n            c: c,\n            new_p: p,\n            old_p: old_p,\n            new_v: p,\n            old_v: old_p,\n        });\n    }\n}\n",
    "felix.20251213133753.177": "/**\n * Unselect the old node, calling the unselect hooks.\n */\npublic unselect_helper(old_p: Position, p: Position): void {\n    const c = this.c;\n    const call_event_handlers = !p.__eq__(old_p);\n    let unselect: boolean;\n    if (call_event_handlers) {\n        unselect = !g.doHook('unselect1', {\n            c: c,\n            new_p: p,\n            old_p: old_p,\n            new_v: p,\n            old_v: old_p,\n        });\n    } else {\n        unselect = true;\n    }\n\n    // Actually unselect the old node.\n    if (unselect && old_p && old_p.__bool__() && !old_p.__eq__(p)) {\n        this.endEditLabel();\n        // #1168: Ctrl-minus selects multiple nodes.\n        // if(this[\"unselectItem\"]){\n        //     this[\"unselectItem\"](old_p);\n        // }\n        // if hasattr(this, 'unselectItem')\n        //     // pylint: disable=no-member\n        //     this.unselectItem(old_p)\n    }\n    if (call_event_handlers) {\n        g.doHook('unselect2', {\n            c: c,\n            new_p: p,\n            old_p: old_p,\n            new_v: p,\n            old_v: old_p,\n        });\n    }\n}\n\n",
    "felix.20251213133753.178": "/**\n * Select the new node, part 1.\n */\npublic select_new_node(old_p: Position, p: Position): void {\n    const c = this.c;\n    const call_event_handlers = !p.__eq__(old_p);\n\n    if (\n        call_event_handlers &&\n        g.doHook('select1', {\n            c: c,\n            new_p: p,\n            old_p: old_p,\n            new_v: p,\n            old_v: old_p,\n        })\n    ) {\n        if (g.app.debug.includes('select')) {\n            g.trace('select1 override');\n        }\n        return;\n    }\n\n    // c.frame.setWrap(p);  // Not that expensive  // THIS SETS BODY WRAP STATE, NOT USED IN LEOJS \n    this.set_body_text_after_select(p, old_p);\n    c.nodeHistory.update(p);\n}\n\n",
    "felix.20251213133753.179": "/**\n * Set the text after selecting a node.\n */\npublic set_body_text_after_select(p: Position, old_p: Position): void {\n    const c = this.c;\n    const w = c.frame.body.wrapper;\n    const s = p.v.b; // Guaranteed to be unicode.\n    // Part 1: get the old text.\n    const old_s = w.getAllText();\n    if (p && p.__bool__() && p.__eq__(old_p) && s === old_s) {\n        return;\n    }\n    // Part 2: set the new text. This forces a recolor.\n    // Important: do this *before* setting text,\n    // so that the colorizer will have the proper c.p.\n    c.setCurrentPosition(p);\n    w.setAllText(s);\n    // This is now done after c.p has been changed.\n    // p.restoreCursorAndScroll()\n}\n\n",
    "felix.20251213133753.180": "/**\n * Select the new node, part 2.\n */\npublic change_current_position(old_p: Position, p: Position): void {\n    const c = this.c;\n\n    // c.setCurrentPosition(p)\n    // This is now done in set_body_text_after_select.\n\n    // GS I believe this should also get into the select1 hook\n    c.frame.scanForTabWidth(p);\n    const use_chapters = c.config.getBool('use-chapters');\n    if (use_chapters) {\n        const cc = c.chapterController;\n        const theChapter = cc && cc.getSelectedChapter();\n        if (theChapter) {\n            theChapter.p = p.copy();\n        }\n    }\n\n    // Do not call treeFocusHelper here!\n    // c.treeFocusHelper()\n    c.undoer.onSelect(old_p, p);\n}\n\n",
    "felix.20251213133753.181": "/**\n * Scroll the cursor.\n */\npublic scroll_cursor(p: Position): void {\n    p.restoreCursorAndScroll(); // Was in setBodyTextAfterSelect\n}\n\n",
    "felix.20251213133753.182": "/**\n * Update the status line.\n * deprecated in LeoJS\n */\npublic set_status_line(p: Position): void {\n    const c = this.c;\n    // \n    // ! LEOJS ! STATUS LINE IS UNL ONLY SET ON SELECTION BY leoUI.ts.\n    //\n    // c.frame.body.assignPositionToEditor(p); // NOT USED IN LEOJS\n    // c.frame.updateStatusLine();  // NOT USED IN LEOJS\n    // c.frame.clearStatusLine(); // NOT USED IN LEOJS\n    // if (p && p.__bool__() && p.v) {\n    //     const kind = c.config.getString('unl-status-kind') || '';\n    //     const method = kind.toLowerCase() === 'legacy' ? p.get_legacy_UNL : p.get_UNL;\n    //     c.frame.putStatusLine(method());\n    // }\n}\n\n",
    "felix.20251213133753.183": "public edit_widget(p: Position): StringTextWrapper | undefined {\n    const d = this.editWidgetsDict;\n    if (!p || !p.v) {\n        return undefined;\n    }\n    let w = d[p.v.gnx];\n    // ! LEOJS : Mimic from qt_tree\n    // ! Dont return if not already in dict as an active headline editor\n    // if (!w) {\n    //     w = new StringTextWrapper(\n    //         this.c,\n    //         `head-${1 + Object.keys(d).length}`\n    //     );\n    //     d[p.v.gnx] = w;\n    //     w.setAllText(p.h);\n    // }\n    return w;\n}\n",
    "felix.20251213133753.184": "/**\n * Start editing p's headline.\n */\npublic editLabel(\n    p: Position,\n    selectAll = false,\n    selection?: any\n): [undefined, StringTextWrapper | undefined] {\n    this.endEditLabel();\n    if (p && p.__bool__()) {\n        // ! LEOJS : Mimic from qt_tree\n\n        const d = this.editWidgetsDict;\n\n        let wrapper = d[p.v.gnx];\n\n        if (!wrapper) {\n            wrapper = new StringTextWrapper(this.c, 'head-wrapper');\n            d[p.v.gnx] = wrapper;\n            wrapper.setAllText(p.h);\n        }\n\n        // const wrapper = new StringTextWrapper(this.c, 'head-wrapper');\n        const e = undefined;\n        return [e, wrapper];\n    }\n    return [undefined, undefined];\n}\n",
    "felix.20251213133753.185": "public printWidgets(): void {\n    const d = this.editWidgetsDict;\n    for (let key in d) {\n        // keys are vnodes, values are StringTextWidgets.\n        const w = d[key];\n        g.pr('w', w, 'gnx', key);\n    }\n}\n",
    "felix.20251213133753.186": "public redraw(p?: Position): void {\n    this.redrawCount += 1;\n}\npublic redraw_now(p?: Position): void {\n    this.redraw();\n}\npublic redraw_after_contract(p: Position): void {\n    this.redraw();\n}\npublic redraw_after_expand(p: Position): void {\n    this.redraw();\n}\npublic redraw_after_head_changed(): void {\n    this.redraw();\n}\npublic redraw_after_select(p?: Position): void {\n    this.redraw();\n}\npublic scrollTo(p: Position): void {\n    // pass\n}\n\n",
    "felix.20251213133753.187": "/**\n * Set the actual text of the headline widget.\n *\n * This is called from the undo/redo logic to change the text before redrawing.\n */\npublic setHeadline(p: Position, s: string): void {\n    const w = this.edit_widget(p);\n    if (w) {\n        w.delete(0, w.getLastIndex());\n        if (s.endsWith('\\n') || s.endsWith('\\r')) {\n            s = s.substring(0, s.length - 1);\n        }\n        w.insert(0, s);\n    } else {\n        // * LEOJS : Not currently editing the headline\n        // g.trace('-------------------- oops');\n    }\n}\n\n",
    "felix.20251213133753.188": "/**\n * A class that represents text as a Python string.\n */\nexport class StringTextWrapper {\n    public c: Commands;\n    public name: string;\n    public ins: number;\n    public sel: [number, number];\n    public s: string;\n    public supportsHighLevelInterface: boolean;\n    public virtualInsertPoint: number;\n    public widget: undefined;\n    public leo_chapter: Chapter | undefined;\n    public leo_p: Position | undefined;\n    public leo_v: VNode | undefined;\n    public leo_label_s: string | undefined;\n    public leo_name: string | undefined;\n    public leo_label: string | undefined;\n\n    @others\n}\n\n",
    "felix.20251213133753.189": "constructor(c: Commands, name: string) {\n    this.c = c;\n    this.name = name;\n    this.ins = 0;\n    this.sel = [0, 0];\n    this.s = '';\n    this.supportsHighLevelInterface = true;\n    this.virtualInsertPoint = 0;\n    this.widget = undefined; // This ivar must exist, and be None.\n}\n\npublic toString(): string {\n    return `<StringTextWrapper: ${this.name}>`;\n}\n\n/**\n * StringTextWrapper\n */\npublic getName(): string {\n    return this.name; // Essential.\n}\n\n",
    "felix.20251213133753.190": "public clipboard_clear(): Thenable<string> {\n    return g.app.gui.replaceClipboardWith('');\n}\npublic async clipboard_append(s: string): Promise<string> {\n    const s1 = await g.app.gui.getTextFromClipboard();\n    return g.app.gui.replaceClipboardWith(s1 + s);\n}\n\n",
    "felix.20251213133753.191": "// For StringTextWrapper.\n\npublic disable(): void {\n    // pass\n}\npublic enable(enabled = true): void {\n    // pass\n}\npublic flashCharacter(\n    i: number,\n    bg = 'white',\n    fg = 'red',\n    flashes = 3,\n    delay = 75\n): void {\n    // pass\n}\npublic getXScrollPosition(): number {\n    return 0;\n}\npublic getYScrollPosition(): number {\n    return 0;\n}\npublic see(i: number): void {\n    // pass\n}\npublic seeInsertPoint(): void {\n    // pass\n}\npublic setFocus(): void {\n    // pass\n}\npublic setStyleClass(name: string): void {\n    // pass\n}\npublic setXScrollPosition(i: number): void {\n    // pass\n}\npublic setYScrollPosition(i: number): void {\n    // pass\n}\n\n",
    "felix.20251213133753.193": "/**\n * StringTextWrapper\n */\npublic appendText(s: string): void {\n    this.s = this.s + g.toUnicode(s); // defensive\n    this.ins = this.s.length;\n    this.sel = [this.ins, this.ins];\n}\n",
    "felix.20251213133753.194": "/**\n * StringTextWrapper.\n */\npublic delete(i: number, j?: number): void {\n    if (j === undefined) {\n        j = i + 1;\n    }\n    // This allows subclasses to use this base class method.\n    if (i > j) {\n        [i, j] = [j, i];\n    }\n    const s = this.getAllText();\n    this.setAllText(s.substring(0, i) + s.substring(j));\n    // Bug fix: 2011/11/13: Significant in external tests.\n    this.setSelectionRange(i, i, i);\n}\n",
    "felix.20251213133753.195": "/**\n * StringTextWrapper.\n */\npublic deleteTextSelection(): void {\n    let i;\n    let j;\n    [i, j] = this.getSelectionRange();\n    this.delete(i, j);\n}\n",
    "felix.20251213133753.196": "/**\n * StringTextWrapper.\n */\npublic get(i: number, j?: number): string {\n    if (j === undefined) {\n        j = i + 1;\n    }\n    const s = this.s.substring(i, j);\n    return g.toUnicode(s);\n}\n",
    "felix.20251213133753.197": "/**\n * StringTextWrapper.\n */\npublic getAllText(): string {\n    const s = this.s;\n    return g.checkUnicode(s);\n}\n",
    "felix.20251213133753.198": "/**\n * StringTextWrapper.\n */\npublic getInsertPoint(): number {\n    let i = this.ins;\n    if (i === undefined) {\n        if (this.virtualInsertPoint === undefined) {\n            i = 0;\n        } else {\n            i = this.virtualInsertPoint;\n        }\n    }\n    this.virtualInsertPoint = i;\n    return i;\n}\n",
    "felix.20251213133753.199": "/**\n * Return the length of the self.s\n */\npublic getLastIndex(): number {\n    return this.s.length;\n}\n",
    "felix.20251213133753.200": "/**\n * StringTextWrapper.\n */\npublic getSelectedText(): string {\n    let i;\n    let j;\n    [i, j] = this.sel;\n    const s = this.s.substring(i, j);\n    return g.checkUnicode(s);\n}\n",
    "felix.20251213133753.201": "/**\n * Return the selected range of the widget.\n */\npublic getSelectionRange(sort = true): [number, number] {\n    let sel = this.sel;\n    let i;\n    let j;\n    if (sel.length === 2 && sel[0] >= 0 && sel[1] >= 0) {\n        [i, j] = sel;\n        if (sort && i > j) {\n            sel = [j, i]; // Bug fix: 10/5/07\n        }\n        return sel;\n    }\n    i = this.ins;\n    return [i, i];\n}\n",
    "felix.20251213133753.202": "/**\n * StringTextWrapper.\n */\npublic hasSelection(): boolean {\n    let i;\n    let j;\n    [i, j] = this.getSelectionRange();\n    return i !== j;\n}\n",
    "felix.20251213133753.203": "/**\n * StringTextWrapper.\n */\npublic insert(i: number, s: string): void {\n    this.s = this.s.substring(0, i) + s + this.s.substring(i);\n    i += s.length;\n    this.ins = i;\n    this.sel = [i, i];\n}\n",
    "felix.20251213133753.204": "/**\n * StringTextWrapper.\n */\npublic selectAllText(insert?: number): void {\n    this.setSelectionRange(0, this.s.length, insert);\n}\n",
    "felix.20251213133753.205": "/**\n * StringTextWrapper.\n */\npublic setAllText(s: string): void {\n    this.s = s;\n    const i = this.s.length;\n    this.ins = i;\n    this.sel = [i, i];\n}\n",
    "felix.20251213133753.206": "/**\n * StringTextWrapper.\n */\npublic setInsertPoint(i: number, s?: string): void {\n    this.virtualInsertPoint = i;\n    this.ins = i;\n    this.sel = [i, i];\n}\n",
    "felix.20251213133753.207": "/**\n * StringTextWrapper.\n */\npublic setSelectionRange(i: number, j: number, insert?: number): void {\n    this.sel = [i, j];\n    this.ins = insert == null ? j : insert;\n}\n",
    "felix.20251213133753.208": "/**\n * StringTextWrapper.\n */\npublic toPythonIndexRowCol(index: number): [number, number] {\n    const s = this.getAllText();\n    let row;\n    let col;\n    [row, col] = g.convertPythonIndexToRowCol(s, index);\n    return [row, col];\n}\n"
  },
  "uas": {
    "felix.20251102225128.1": {
      "_mod_time": 1761268281.73
    },
    "felix.20251103000914.1": {
      "_mod_time": 1765243368.942
    },
    "felix.20251103000934.1": {
      "_mod_time": 1765418111.861
    },
    "felix.20251103001111.1": {
      "_mod_time": 1765428511.573
    },
    "felix.20251210234420.1": {
      "_mod_time": 1765429233.062
    },
    "felix.20251210234451.1": {
      "_mod_time": 1765428602.58
    },
    "felix.20251211000427.1": {
      "_mod_time": 1765515349.78
    },
    "felix.20251211000618.1": {
      "_mod_time": 1765515070.464
    }
  }
}